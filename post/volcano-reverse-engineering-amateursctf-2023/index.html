<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>Volcano - lavafroth</title>
<meta name=description content="This reversing challenge is very mathematical, focusing mainly on modulo congruences. Like all challenges, there is some scary looking obfuscation for the fun which I&rsquo;ll try my best to explain. The challenge description says that it was inspired by recent &ldquo;traumatic&rdquo; events but I&rsquo;m oblivious to what that reference meant.
Decompilation We start off with downloading the binary and opening it in Ghidra.
In the list of functions under the Symbol Tree, we can navigate to the entry function which looks like:"><meta name=author content><link rel="preload stylesheet" as=style href=https://lavafroth.is-a.dev/app.min.css><link rel=preload as=font href=https://lavafroth.is-a.dev/LeagueGothic.ttf><link rel=preload as=image href=https://lavafroth.is-a.dev/github.svg><link rel=preload as=image href=https://lavafroth.is-a.dev/about.svg><link rel=preload as=image href=https://lavafroth.is-a.dev/art.svg><link rel=icon href=https://lavafroth.is-a.dev/favicon.png><link rel=blog-icon href=https://lavafroth.is-a.dev/icon.png></head><body class=not-ready data-menu=true><header class=header><div class=lava><div class=logo><h1><a class=site-name href=https://lavafroth.is-a.dev/>lavafroth</a></h1><svg class="btn-dark" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 60 60" preserveAspectRatio="xMinYMin meet"><path class="circle" d="M30 16c7.73.0 14 6.27 14 14 0 3.81-1.53 7.27-4 9.8-2.54 2.59-6.08 4.2-10 4.2-7.73.0-14-6.27-14-14 0-7.73 6.27-14 14-14z"/><g class="rays" data-svg-origin="30 30"><line class="line" x1="30" y1="11" x2="30" y2="7"/><line class="line" x1="43.44" y1="16.57" x2="46.26" y2="13.74"/><line class="line" x1="49" y1="30" x2="53" y2="30"/><line class="line" x1="43.43" y1="43.44" x2="46.26" y2="46.26"/><line class="line" x1="30" y1="49" x2="30" y2="53"/><line class="line" x1="16.56" y1="43.43" x2="13.74" y2="46.26"/><line class="line" x1="11" y1="30" x2="7" y2="30"/><line class="line" x1="16.57" y1="16.56" x2="13.74" y2="13.74"/></g></svg><nav class=social><a class=github style=--url:url(./github.svg) href=https://github.com/lavafroth target=_blank></a><a href=../../about/ title style=--url:url(./about.svg)></a><a href=../../art/ title style=--url:url(./art.svg)></a></nav><script>const bodyClx=document.body.classList,btnDark=document.querySelector(".btn-dark"),sysDark=window.matchMedia("(prefers-color-scheme: dark)"),darkVal=localStorage.getItem("dark"),setDark=e=>(bodyClx.toggle("dark",e),localStorage.setItem("dark",e));setDark(darkVal?darkVal==="true":sysDark.matches),requestAnimationFrame(()=>bodyClx.remove("not-ready")),btnDark.addEventListener("click",()=>setDark(!bodyClx.contains("dark"))),sysDark.addEventListener("change",({matches:e})=>setDark(e))</script></div><div class=bubbles><div class=bubble style=--size:3.1573520635288297rem;--distance:9.777460616790547rem;--position:79.82351594640258%;--time:2.119561966408366s;--delay:-2.511069904370182s></div><div class=bubble style=--size:5.464382923434847rem;--distance:8.202204257500235rem;--position:73.05291394812365%;--time:2.8163650791714443s;--delay:-2.10834069552337s></div><div class=bubble style=--size:5.54171635032949rem;--distance:7.21628154079756rem;--position:3.5185273501097587%;--time:3.315974703485457s;--delay:-3.990557496815194s></div><div class=bubble style=--size:5.0780408722783115rem;--distance:7.9062882665654115rem;--position:96.75584737203708%;--time:2.9935278687454545s;--delay:-3.4097998510686813s></div><div class=bubble style=--size:2.451790257749897rem;--distance:9.375064105953562rem;--position:28.633085440410255%;--time:2.692548467667867s;--delay:-2.555074529650302s></div><div class=bubble style=--size:5.585816850593148rem;--distance:6.9600422960042865rem;--position:72.51244146669855%;--time:3.483246137208243s;--delay:-3.326136738066893s></div><div class=bubble style=--size:2.7392297893119135rem;--distance:8.030468953788962rem;--position:8.86445777813215%;--time:2.889575913936971s;--delay:-2.146827283616331s></div><div class=bubble style=--size:4.171962693508177rem;--distance:7.211002745280388rem;--position:58.2711084896879%;--time:2.716958408694885s;--delay:-3.296786648250234s></div><div class=bubble style=--size:4.532330684666543rem;--distance:8.578254049517938rem;--position:0.565927638475408%;--time:2.2846750146942254s;--delay:-3.4959322437591482s></div><div class=bubble style=--size:4.556463823827298rem;--distance:7.094090631014913rem;--position:70.39822723543791%;--time:3.624537503862896s;--delay:-2.857420933636443s></div><div class=bubble style=--size:5.07603378328206rem;--distance:6.645037412951618rem;--position:8.652005686621889%;--time:2.698244199090787s;--delay:-2.527616744094707s></div><div class=bubble style=--size:3.118201429900723rem;--distance:8.143294120584633rem;--position:64.35281134429346%;--time:2.2798669446425186s;--delay:-2.1420127307963344s></div><div class=bubble style=--size:3.418153008888427rem;--distance:9.064629817008509rem;--position:52.44283935234534%;--time:3.5827037199475575s;--delay:-2.995911643153717s></div><div class=bubble style=--size:2.191671240434883rem;--distance:8.944809822901478rem;--position:49.096851163552614%;--time:2.6651233627364372s;--delay:-3.300002230918009s></div><div class=bubble style=--size:3.369853326930267rem;--distance:6.331290194753575rem;--position:104.21704424457798%;--time:3.8955228568460027s;--delay:-3.4855417485078464s></div><div class=bubble style=--size:5.5113557063736245rem;--distance:8.568147573044554rem;--position:98.2498321096982%;--time:3.278666488584876s;--delay:-2.3468950982430616s></div><div class=bubble style=--size:5.672304818021649rem;--distance:9.782337765105405rem;--position:32.67241762023444%;--time:2.2703169650802293s;--delay:-3.9645713700523983s></div><div class=bubble style=--size:3.9388421289276483rem;--distance:7.218402286241155rem;--position:25.252599878511358%;--time:3.061152350442821s;--delay:-2.0708403071805406s></div><div class=bubble style=--size:2.206141240805235rem;--distance:7.760669925358866rem;--position:1.4597033545946854%;--time:3.969581249858505s;--delay:-2.2487091839080553s></div><div class=bubble style=--size:2.589806449494878rem;--distance:6.079178451528124rem;--position:56.42959891728088%;--time:2.9194662555481306s;--delay:-2.515893631902179s></div><div class=bubble style=--size:4.916044498049767rem;--distance:6.8458708795549095rem;--position:52.90949158878315%;--time:2.5752577719013083s;--delay:-3.6656718499279526s></div><div class=bubble style=--size:4.710265252521078rem;--distance:9.065982215990093rem;--position:62.232586785691396%;--time:3.63261593199919s;--delay:-2.0799296560779794s></div><div class=bubble style=--size:4.80868502150219rem;--distance:9.31843825728931rem;--position:52.33077257309814%;--time:3.1052043107141287s;--delay:-2.1829374129358485s></div><div class=bubble style=--size:4.60673963425293rem;--distance:8.84329033694339rem;--position:4.61870339863248%;--time:3.5258904404870326s;--delay:-3.7259085270061183s></div><div class=bubble style=--size:2.30776598310732rem;--distance:9.34563069282983rem;--position:86.81246243436092%;--time:3.3785018210778133s;--delay:-3.8884245347339097s></div><div class=bubble style=--size:3.771325201902952rem;--distance:7.537743036639792rem;--position:99.83782131571066%;--time:2.9795293630719635s;--delay:-2.0440255508279725s></div><div class=bubble style=--size:3.515905905101607rem;--distance:9.123800105025058rem;--position:52.27887455419%;--time:2.4743305426931745s;--delay:-2.1668790994717293s></div><div class=bubble style=--size:3.349975346700309rem;--distance:6.099525580933591rem;--position:86.19226178189942%;--time:3.73351241604457s;--delay:-3.7277466742109526s></div><div class=bubble style=--size:2.594203315627623rem;--distance:9.481507372000836rem;--position:48.478568433922725%;--time:2.001355560993734s;--delay:-2.873348731141025s></div><div class=bubble style=--size:4.208475535168454rem;--distance:7.949479398044607rem;--position:15.12817215146464%;--time:2.8775747141619057s;--delay:-2.44697699668547s></div><div class=bubble style=--size:4.808679093865685rem;--distance:8.35512071159537rem;--position:20.77592767701002%;--time:2.2941807591177183s;--delay:-2.0117738543581565s></div><div class=bubble style=--size:2.9094100558844787rem;--distance:8.658895286915223rem;--position:75.01431085194308%;--time:3.337416107927284s;--delay:-2.329229409935038s></div><div class=bubble style=--size:4.916550270723802rem;--distance:8.991371244178316rem;--position:88.16428124678242%;--time:3.543887527881868s;--delay:-3.117597716172686s></div><div class=bubble style=--size:4.183719518254308rem;--distance:6.036664021374489rem;--position:5.242327215616964%;--time:3.680410804784464s;--delay:-2.1979710698033066s></div><div class=bubble style=--size:2.195201281915745rem;--distance:7.54167483656756rem;--position:100.82583136288696%;--time:2.136409883934854s;--delay:-3.989942097610389s></div><div class=bubble style=--size:2.372472748316257rem;--distance:8.971269770130899rem;--position:35.22138774545767%;--time:3.504781994206962s;--delay:-3.569878419825069s></div><div class=bubble style=--size:4.1960151286835945rem;--distance:6.1215578387345095rem;--position:46.31269673675248%;--time:3.4151434354130674s;--delay:-2.387604702108186s></div><div class=bubble style=--size:2.196732774678229rem;--distance:8.804848936451702rem;--position:45.39987050964828%;--time:3.316683633487673s;--delay:-3.1981971902884685s></div><div class=bubble style=--size:2.0529976835521486rem;--distance:8.600957982798818rem;--position:41.37759553673493%;--time:3.2740925387984974s;--delay:-3.905976112047844s></div><div class=bubble style=--size:5.376914279513754rem;--distance:7.407085630853494rem;--position:63.24201611997715%;--time:2.1264285640291862s;--delay:-3.051025398511498s></div><div class=bubble style=--size:3.7450799812351994rem;--distance:9.27365599692357rem;--position:59.16835173165882%;--time:2.219333023219039s;--delay:-3.316382525233861s></div><div class=bubble style=--size:4.786605846571324rem;--distance:7.578229664193804rem;--position:60.6427424182681%;--time:2.8273438402809394s;--delay:-3.455732177447113s></div><div class=bubble style=--size:2.938278644808678rem;--distance:9.938293208055786rem;--position:76.67119791168354%;--time:2.103244616802722s;--delay:-3.9704952976762997s></div><div class=bubble style=--size:5.012613389182628rem;--distance:9.810547260738733rem;--position:19.822190366974635%;--time:2.0906950847679164s;--delay:-3.778541998909121s></div><div class=bubble style=--size:2.352723596034365rem;--distance:8.397253238309649rem;--position:-2.3316241256657855%;--time:3.518616763158588s;--delay:-2.7090310143181644s></div><div class=bubble style=--size:2.560757032134992rem;--distance:7.465288707793678rem;--position:59.52289816263949%;--time:2.3372893042504406s;--delay:-2.6207518451312732s></div><div class=bubble style=--size:5.764928617835869rem;--distance:7.038862224644299rem;--position:16.721242071278617%;--time:2.141182276317782s;--delay:-2.8786872186742465s></div><div class=bubble style=--size:5.822991651957761rem;--distance:8.095925336593208rem;--position:43.22787179511871%;--time:2.8490098963477255s;--delay:-2.7222347863832947s></div><div class=bubble style=--size:4.690866285770111rem;--distance:9.582968751042802rem;--position:9.034439977199735%;--time:3.1395412275822516s;--delay:-2.746787293711964s></div><div class=bubble style=--size:3.40545539505801rem;--distance:8.669729554506162rem;--position:-3.321193044421753%;--time:3.24881749500489s;--delay:-2.174245724907715s></div><div class=bubble style=--size:2.172294383071536rem;--distance:7.627910355839513rem;--position:92.16608231592369%;--time:2.047980200652401s;--delay:-3.862421045452209s></div><div class=bubble style=--size:2.425515628392274rem;--distance:7.609422479470836rem;--position:97.54851972848475%;--time:2.5336071978279824s;--delay:-2.9319860615603712s></div><div class=bubble style=--size:4.777143245059128rem;--distance:6.443914820662836rem;--position:90.52922244564954%;--time:3.3213063283891793s;--delay:-3.8505805988603834s></div><div class=bubble style=--size:3.072189810464895rem;--distance:7.263219342754864rem;--position:8.283420371048717%;--time:3.699352106176918s;--delay:-2.9613689746478737s></div><div class=bubble style=--size:4.228476129628428rem;--distance:6.36981004892698rem;--position:36.436296361102784%;--time:3.327948300393536s;--delay:-2.7019225510747096s></div><div class=bubble style=--size:4.745380579657766rem;--distance:6.655268131779713rem;--position:46.237833943953405%;--time:3.4810790747966522s;--delay:-3.440845596373659s></div><div class=bubble style=--size:2.492986251507652rem;--distance:8.850291761655484rem;--position:38.54527449053424%;--time:3.9459534084061887s;--delay:-3.2609494301905166s></div><div class=bubble style=--size:5.852520791787054rem;--distance:8.611646147069422rem;--position:-2.112337659082899%;--time:2.323082097601607s;--delay:-3.4305342668413266s></div><div class=bubble style=--size:4.712295628789016rem;--distance:7.608690016853551rem;--position:-0.70572452280945%;--time:2.5965373845022657s;--delay:-3.7992221451492902s></div><div class=bubble style=--size:2.9051516428147313rem;--distance:7.402827513210772rem;--position:23.977327965505314%;--time:3.9382729257289633s;--delay:-2.9478878399723887s></div><div class=bubble style=--size:5.37854688142705rem;--distance:8.550119881249136rem;--position:54.19156364567646%;--time:3.7770680873747033s;--delay:-3.5196870939784084s></div><div class=bubble style=--size:3.527712941562201rem;--distance:6.062329591706292rem;--position:-2.89796421492563%;--time:2.238022589528245s;--delay:-3.147375710595563s></div><div class=bubble style=--size:3.200640083274175rem;--distance:7.859513120786255rem;--position:13.747596391489125%;--time:3.387430173535349s;--delay:-2.508616413150541s></div><div class=bubble style=--size:2.163960447441803rem;--distance:8.778841962547915rem;--position:95.94500362059767%;--time:2.660417809838789s;--delay:-3.6130288690993306s></div><div class=bubble style=--size:3.156951339828767rem;--distance:9.956599461412498rem;--position:48.71783219463389%;--time:2.0794702862063223s;--delay:-3.998680242326202s></div><div class=bubble style=--size:3.7964213024842985rem;--distance:8.396204509710422rem;--position:72.59901296142988%;--time:2.7736924428434513s;--delay:-3.4193337878555097s></div><div class=bubble style=--size:5.15366941586544rem;--distance:7.442379170996494rem;--position:100.42443025305154%;--time:3.9160173799259588s;--delay:-2.5350633304517403s></div><div class=bubble style=--size:2.379578429213379rem;--distance:6.75740977433995rem;--position:6.071825202433391%;--time:2.7409259000987523s;--delay:-3.061518371851812s></div><div class=bubble style=--size:2.7161326200879365rem;--distance:7.443012696347425rem;--position:94.54154664489576%;--time:2.252009059953056s;--delay:-2.850428025421688s></div><div class=bubble style=--size:5.338213729194962rem;--distance:7.8296097748068245rem;--position:104.31815394727944%;--time:2.5181076015598363s;--delay:-2.792889558963517s></div><div class=bubble style=--size:4.677613519962753rem;--distance:7.547053659581501rem;--position:62.79503545575673%;--time:3.9798958335619075s;--delay:-2.642889547046062s></div><div class=bubble style=--size:4.600841539587519rem;--distance:7.111264085633966rem;--position:32.93333286860395%;--time:2.0995891279538843s;--delay:-2.82337099091355s></div><div class=bubble style=--size:4.937156614156352rem;--distance:8.141423872810948rem;--position:64.76377512989443%;--time:3.878011907641161s;--delay:-2.0776515861838476s></div><div class=bubble style=--size:5.464209147082656rem;--distance:6.16168015844219rem;--position:81.9093862477641%;--time:2.36096642742533s;--delay:-3.201129315223698s></div><div class=bubble style=--size:3.0638718374292786rem;--distance:8.339518681300468rem;--position:40.561492517815786%;--time:3.971239093589107s;--delay:-3.3289101684961806s></div><div class=bubble style=--size:3.7095814852639535rem;--distance:8.669471468140257rem;--position:34.09311265803539%;--time:2.430594868258288s;--delay:-3.287405916659933s></div><div class=bubble style=--size:2.9258659641866rem;--distance:8.87926442884251rem;--position:50.58373940219579%;--time:3.4807962221846354s;--delay:-3.59856198756007s></div><div class=bubble style=--size:2.066940049404841rem;--distance:8.748804284675305rem;--position:96.8971395843717%;--time:2.7453570642388048s;--delay:-3.0433424038921815s></div><div class=bubble style=--size:5.327630546150689rem;--distance:7.3836875147364625rem;--position:65.80986112208456%;--time:2.164964416386732s;--delay:-3.136378080242951s></div><div class=bubble style=--size:3.9306688638454874rem;--distance:9.944216015487171rem;--position:16.696802138049012%;--time:3.2471910283896617s;--delay:-2.798464726573834s></div><div class=bubble style=--size:2.0191221100891443rem;--distance:7.599369051527898rem;--position:68.0759833194086%;--time:3.78513125348422s;--delay:-2.731704015074298s></div><div class=bubble style=--size:4.709476032752907rem;--distance:8.592300096819226rem;--position:101.56836072747207%;--time:3.357821688195889s;--delay:-3.464741213898109s></div><div class=bubble style=--size:3.3015552870719986rem;--distance:8.186281390229443rem;--position:76.91449568684521%;--time:2.239942114775954s;--delay:-3.8058407969687678s></div><div class=bubble style=--size:2.3303913710914212rem;--distance:7.798936130721566rem;--position:17.863987177199412%;--time:2.569608702313029s;--delay:-2.6784270210611973s></div><div class=bubble style=--size:5.554787154774565rem;--distance:8.592136414160255rem;--position:89.18111414761651%;--time:2.8800003662802327s;--delay:-2.2567149506099313s></div><div class=bubble style=--size:2.874849035422754rem;--distance:9.102583798938209rem;--position:87.9256543749225%;--time:2.2168054627967226s;--delay:-3.805079017356886s></div><div class=bubble style=--size:4.472091382328382rem;--distance:9.004045355075995rem;--position:4.854675674342824%;--time:3.8531075079215604s;--delay:-2.79800835062909s></div><div class=bubble style=--size:3.5726260835226924rem;--distance:8.477994255893933rem;--position:72.46149584193786%;--time:3.979622326518513s;--delay:-2.061230017760451s></div><div class=bubble style=--size:4.163706989554627rem;--distance:9.47489849437773rem;--position:13.871782420024594%;--time:2.3515400527428927s;--delay:-2.0995962728471347s></div><div class=bubble style=--size:5.548356420073219rem;--distance:8.892675084107134rem;--position:46.11933460856142%;--time:3.545334586973909s;--delay:-3.3801543745894644s></div><div class=bubble style=--size:4.39219185055803rem;--distance:7.933095131117099rem;--position:47.221752007803346%;--time:2.366338056378407s;--delay:-2.4633871132846257s></div><div class=bubble style=--size:4.869873825638225rem;--distance:6.602238972606432rem;--position:8.008413506612953%;--time:2.2417693494331896s;--delay:-2.653305108946213s></div><div class=bubble style=--size:2.609803871778203rem;--distance:6.465015130775617rem;--position:98.45267853838197%;--time:3.2582634203691807s;--delay:-2.5469765884864146s></div><div class=bubble style=--size:3.692170879348117rem;--distance:6.148846216102932rem;--position:42.598683207916814%;--time:3.590027493217046s;--delay:-2.458627372938123s></div><div class=bubble style=--size:3.13371931340167rem;--distance:8.629774977369975rem;--position:8.26584091101138%;--time:3.4632516036299292s;--delay:-2.4428047213945976s></div><div class=bubble style=--size:5.3337351507338rem;--distance:9.514150167012112rem;--position:82.45272269713838%;--time:2.3798811696416964s;--delay:-2.7840053134258858s></div><div class=bubble style=--size:4.9046296721854405rem;--distance:8.604974499035588rem;--position:59.283370927934484%;--time:2.8248091589138493s;--delay:-3.5693285957321708s></div><div class=bubble style=--size:2.6672752126499217rem;--distance:8.387208213353594rem;--position:13.267155378078542%;--time:3.7363103446115558s;--delay:-2.910351872656129s></div><div class=bubble style=--size:2.2051971696247907rem;--distance:7.2819438794174625rem;--position:27.976116944859648%;--time:3.350821422712959s;--delay:-3.547854220935776s></div><div class=bubble style=--size:5.428924414714262rem;--distance:6.583819493754497rem;--position:99.8398036887203%;--time:2.4936663895530957s;--delay:-2.1438767599437383s></div><div class=bubble style=--size:2.0230413305356647rem;--distance:9.43453826170662rem;--position:12.213961398059165%;--time:3.0772160237064186s;--delay:-3.0795424392120987s></div><div class=bubble style=--size:2.063930526108078rem;--distance:9.558462346937564rem;--position:68.07796995584836%;--time:3.56929838791893s;--delay:-3.824027429996162s></div><div class=bubble style=--size:3.257099363627222rem;--distance:6.621327219169994rem;--position:92.33362842888727%;--time:2.0517956650841005s;--delay:-3.4422427087546907s></div><div class=bubble style=--size:2.1171301477954065rem;--distance:9.719096813129642rem;--position:70.08436689879504%;--time:3.7384308858183797s;--delay:-3.0706710752075197s></div><div class=bubble style=--size:5.112779410037207rem;--distance:7.695429389814016rem;--position:-2.14966602682227%;--time:3.57642299707581s;--delay:-2.4034192878360265s></div><div class=bubble style=--size:5.162675470130112rem;--distance:9.212118723148667rem;--position:3.0984197952934505%;--time:3.2589513048824457s;--delay:-2.5093381281915423s></div><div class=bubble style=--size:2.7246674568463787rem;--distance:9.12745268544741rem;--position:49.120294680111435%;--time:3.1762564511300977s;--delay:-3.832886220770901s></div><div class=bubble style=--size:5.349026043476247rem;--distance:8.790374067372515rem;--position:54.54843430655645%;--time:2.0700772264716036s;--delay:-3.975720761844946s></div><div class=bubble style=--size:5.127729051171082rem;--distance:6.142194386232878rem;--position:71.97016585088087%;--time:2.312705653014668s;--delay:-2.350598744844194s></div><div class=bubble style=--size:2.0201015578317145rem;--distance:9.75675051990936rem;--position:8.020062789238711%;--time:3.0732904442207842s;--delay:-3.4598954151773706s></div><div class=bubble style=--size:2.9164605310296974rem;--distance:8.41873984544106rem;--position:51.612260976605086%;--time:2.142616282498704s;--delay:-2.3847920007587478s></div><div class=bubble style=--size:3.5032717049186415rem;--distance:6.582979418765931rem;--position:-3.076434382195019%;--time:3.874670459658509s;--delay:-2.515671411117263s></div><div class=bubble style=--size:2.141933748277137rem;--distance:8.59581371621693rem;--position:33.93429226358781%;--time:3.6454031897063164s;--delay:-2.7940742798554132s></div><div class=bubble style=--size:3.345442714426433rem;--distance:9.044260951535312rem;--position:-4.650294346217494%;--time:2.0736419664755537s;--delay:-2.778792241654439s></div><div class=bubble style=--size:2.1263129168062553rem;--distance:7.3913517942503875rem;--position:31.45504027436062%;--time:2.4466944233932817s;--delay:-3.7532376177265623s></div><div class=bubble style=--size:5.241379779224864rem;--distance:6.259437679330544rem;--position:102.1413894444833%;--time:3.8907656928301555s;--delay:-3.3447980056450124s></div><div class=bubble style=--size:2.331998964957984rem;--distance:9.094390629027135rem;--position:-2.6908383211867837%;--time:2.8453745091133786s;--delay:-3.198027357641816s></div><div class=bubble style=--size:3.8204190766849466rem;--distance:6.442443820718948rem;--position:12.413067933385648%;--time:2.7830902741696306s;--delay:-3.1672753932191284s></div><div class=bubble style=--size:4.529982717229779rem;--distance:9.37007755632819rem;--position:100.37896472152282%;--time:2.569522003146849s;--delay:-2.2551840817951367s></div><div class=bubble style=--size:5.92838696231237rem;--distance:6.7301106256864545rem;--position:32.34812216630464%;--time:3.9023927560222624s;--delay:-2.255056982682299s></div><div class=bubble style=--size:4.699351072125338rem;--distance:6.766442174868489rem;--position:16.470785618032696%;--time:2.9972294563183746s;--delay:-2.3732040837342128s></div><div class=bubble style=--size:4.249420105641767rem;--distance:9.041961853600057rem;--position:38.606346517159736%;--time:2.373142369175816s;--delay:-2.6151599921478534s></div><div class=bubble style=--size:2.344663842468246rem;--distance:7.759965494391591rem;--position:65.474437910675%;--time:3.971142330142072s;--delay:-3.229227249606911s></div><div class=bubble style=--size:2.422280062220338rem;--distance:7.543330618328514rem;--position:81.87537876523214%;--time:2.3733202285494865s;--delay:-2.924996274989179s></div><div class=bubble style=--size:2.0125967736893333rem;--distance:9.770773664089738rem;--position:64.36956820131321%;--time:2.210066626569258s;--delay:-2.2942771000992472s></div><div class=bubble style=--size:4.566565802402101rem;--distance:6.704230153890237rem;--position:62.113076351236%;--time:2.5804502921480745s;--delay:-3.529413243520293s></div><div class=bubble style=--size:2.910533286234803rem;--distance:8.80350651389128rem;--position:59.47561542831464%;--time:3.433471577337245s;--delay:-3.491075664457081s></div><div class=bubble style=--size:2.5176134863940742rem;--distance:9.543890232600983rem;--position:2.633638418719375%;--time:3.9236323881961654s;--delay:-2.8545051911876764s></div><div class=lavasource></div></div><svg><defs><filter id="blob"><feGaussianBlur in="SourceGraphic" stdDeviation="10" result="blur"/><feColorMatrix in="blur" mode="matrix" values="1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 19 -9" result="blob"/></filter></defs></svg></div></header><main class=main><article class=post-single><header class=post-title><p><time>Jul 21, 2023 | 12 minutes read</time></p><h1 data-pagefind-meta=title>Volcano</h1></header><section class=post-content data-pagefind-body><p>This reversing challenge is very mathematical, focusing mainly on modulo congruences.
Like all challenges, there is some scary looking obfuscation for the fun which I&rsquo;ll try my best to
explain. The challenge description says that it was <em>inspired by recent &ldquo;traumatic&rdquo; events</em> but I&rsquo;m oblivious to what that
reference meant.</p><h2 id=decompilation>Decompilation</h2><p>We start off with downloading the binary and opening it in Ghidra.</p><p>In the list of functions under the Symbol Tree, we can navigate to the <code>entry</code> function which looks like:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C data-lang=C><span style=display:flex><span><span style=color:#66d9ef>void</span> processEntry <span style=color:#a6e22e>entry</span>(undefined8 param_1,undefined8 param_2)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  undefined auStack_8 [<span style=color:#ae81ff>8</span>];
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>__libc_start_main</span>(FUN_001014a7,param_2,<span style=color:#f92672>&amp;</span>stack0x00000008,FUN_00101760,FUN_001017d0,param_1,auStack_8);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>do</span> {
</span></span><span style=display:flex><span>  <span style=color:#75715e>/* WARNING: Do nothing block with infinite loop */</span>
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>while</span>( true );
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Notice the call to <code>__libc_start_main</code>, the first argument supplied is a function pointer which points to the main function.</p><p>I have a habit of renaming variables in Ghidra so that they make some sense. I will rename this function to <code>main</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C data-lang=C><span style=display:flex><span><span style=color:#a6e22e>__libc_start_main</span>(main,param_2,<span style=color:#f92672>&amp;</span>stack0x00000008,FUN_00101760,FUN_001017d0,param_1,auStack_8);
</span></span></code></pre></div><h3 id=main><code>main</code></h3><p>If we double click on the newly renamed <code>main</code> function, we will see a function that has a massive cyclomatic complexity in the decompiler view.
I will try to make this more sensible by selecting the generated identifiers, then renaming (pressing <code>L</code>) and retyping (<code>Ctrl</code> <code>L</code>).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C data-lang=C><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>(<span style=color:#66d9ef>void</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>bool</span> ok;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>bool</span> _ok;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>int</span> ret;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>long</span> n_volcano;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>long</span> n_bear;
</span></span><span style=display:flex><span>  ulong m_v;
</span></span><span style=display:flex><span>  ulong m_b;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>long</span> fs_register;
</span></span><span style=display:flex><span>  ulong bear;
</span></span><span style=display:flex><span>  ulong volcano;
</span></span><span style=display:flex><span>  ulong proof;
</span></span><span style=display:flex><span>  ulong leet;
</span></span><span style=display:flex><span>  FILE <span style=color:#f92672>*</span>flag;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>char</span> buf [<span style=color:#ae81ff>136</span>];
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>long</span> canary;
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  canary <span style=color:#f92672>=</span> <span style=color:#f92672>*</span>(<span style=color:#66d9ef>long</span> <span style=color:#f92672>*</span>)(fs_register <span style=color:#f92672>+</span> <span style=color:#ae81ff>0x28</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>setbuf</span>(stdin,(<span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span>)<span style=color:#ae81ff>0x0</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>setbuf</span>(stdout,(<span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span>)<span style=color:#ae81ff>0x0</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>setbuf</span>(stderr,(<span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span>)<span style=color:#ae81ff>0x0</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;Give me a bear: &#34;</span>);
</span></span><span style=display:flex><span>  bear <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>scanf</span>(<span style=color:#e6db74>&#34;%llu&#34;</span>,<span style=color:#f92672>&amp;</span>bear);
</span></span><span style=display:flex><span>  ok <span style=color:#f92672>=</span> <span style=color:#a6e22e>process_bear</span>(bear);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (ok) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;Give me a volcano: &#34;</span>);
</span></span><span style=display:flex><span>    volcano <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>scanf</span>(<span style=color:#e6db74>&#34;%llu&#34;</span>,<span style=color:#f92672>&amp;</span>volcano);
</span></span><span style=display:flex><span>    _ok <span style=color:#f92672>=</span> <span style=color:#a6e22e>process_volcano</span>(volcano);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (_ok) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;Prove to me they are the same: &#34;</span>);
</span></span><span style=display:flex><span>      proof <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>      leet <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x1337</span>;
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>scanf</span>(<span style=color:#e6db74>&#34;%llu&#34;</span>,<span style=color:#f92672>&amp;</span>proof);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (((proof <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>) <span style=color:#f92672>||</span> (proof <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>)) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>puts</span>(<span style=color:#e6db74>&#34;That</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>s not a valid proof!&#34;</span>);
</span></span><span style=display:flex><span>        ret <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>        n_volcano <span style=color:#f92672>=</span> <span style=color:#a6e22e>n_digits</span>(volcano);
</span></span><span style=display:flex><span>        n_bear <span style=color:#f92672>=</span> <span style=color:#a6e22e>n_digits</span>(bear);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (n_volcano <span style=color:#f92672>==</span> n_bear) {
</span></span><span style=display:flex><span>          n_volcano <span style=color:#f92672>=</span> <span style=color:#a6e22e>sum_of_digits</span>(volcano);
</span></span><span style=display:flex><span>          n_bear <span style=color:#f92672>=</span> <span style=color:#a6e22e>sum_of_digits</span>(bear);
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>if</span> (n_volcano <span style=color:#f92672>==</span> n_bear) {
</span></span><span style=display:flex><span>            m_v <span style=color:#f92672>=</span> <span style=color:#a6e22e>check_proof</span>(leet,volcano,proof);
</span></span><span style=display:flex><span>            m_b <span style=color:#f92672>=</span> <span style=color:#a6e22e>check_proof</span>(leet,bear,proof);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (m_v <span style=color:#f92672>==</span> m_b) {
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>puts</span>(<span style=color:#e6db74>&#34;That looks right to me!&#34;</span>);
</span></span><span style=display:flex><span>              flag <span style=color:#f92672>=</span> <span style=color:#a6e22e>fopen</span>(<span style=color:#e6db74>&#34;flag.txt&#34;</span>,<span style=color:#e6db74>&#34;r&#34;</span>);
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>fgets</span>(buf,<span style=color:#ae81ff>0x80</span>,flag);
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>puts</span>(buf);
</span></span><span style=display:flex><span>              ret <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>goto</span> LAB_00101740;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>puts</span>(<span style=color:#e6db74>&#34;Nope that</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>s not right!&#34;</span>);
</span></span><span style=display:flex><span>        ret <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>puts</span>(<span style=color:#e6db74>&#34;That doesn</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>t look like a volcano!&#34;</span>);
</span></span><span style=display:flex><span>      ret <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>puts</span>(<span style=color:#e6db74>&#34;That doesn</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>t look like a bear!&#34;</span>);
</span></span><span style=display:flex><span>    ret <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>LAB_00101740:
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (canary <span style=color:#f92672>!=</span> <span style=color:#f92672>*</span>(<span style=color:#66d9ef>long</span> <span style=color:#f92672>*</span>)(fs_register <span style=color:#f92672>+</span> <span style=color:#ae81ff>0x28</span>)) {
</span></span><span style=display:flex><span>                    <span style=color:#75715e>/* WARNING: Subroutine does not return */</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>__stack_chk_fail</span>();
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> ret;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>The program asks for an unsigned long integer as a bear. It calls a subroutine to process the integer
and stores the result in the <code>ok</code> variable.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C data-lang=C><span style=display:flex><span><span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;Give me a bear: &#34;</span>);
</span></span><span style=display:flex><span>bear <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>scanf</span>(<span style=color:#e6db74>&#34;%llu&#34;</span>,<span style=color:#f92672>&amp;</span>bear);
</span></span><span style=display:flex><span>ok <span style=color:#f92672>=</span> <span style=color:#a6e22e>process_bear</span>(bear);
</span></span></code></pre></div><p>The next block only executes when <code>ok</code> is true.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C data-lang=C><span style=display:flex><span><span style=color:#66d9ef>if</span> (ok) {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// ...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span></code></pre></div><p>Inside this block, the program for another unsigned long integer as before but calls it a volcano, running
a check specific to this input.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C data-lang=C><span style=display:flex><span><span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;Give me a volcano: &#34;</span>);
</span></span><span style=display:flex><span>volcano <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>scanf</span>(<span style=color:#e6db74>&#34;%llu&#34;</span>,<span style=color:#f92672>&amp;</span>volcano);
</span></span><span style=display:flex><span>_ok <span style=color:#f92672>=</span> <span style=color:#a6e22e>process_volcano</span>(volcano);
</span></span></code></pre></div><p>The next conditional block executes when this <code>process_volcano</code> subroutine return true.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C data-lang=C><span style=display:flex><span><span style=color:#66d9ef>if</span> (_ok) {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// ...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span></code></pre></div><p>The program then asks for another unsigned long integer as a proof for the <em>&ldquo;volcano&rdquo;</em> and the <em>&ldquo;bear&rdquo;</em> being the same.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C data-lang=C><span style=display:flex><span><span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;Prove to me they are the same: &#34;</span>);
</span></span><span style=display:flex><span>proof <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>leet <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x1337</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>scanf</span>(<span style=color:#e6db74>&#34;%llu&#34;</span>,<span style=color:#f92672>&amp;</span>proof);
</span></span></code></pre></div><p>If the proof value&rsquo;s last bit (<code>proof & 1</code>) is 0, meaning if the proof is even or it is 1, we get the bad ending
that says, &ldquo;That&rsquo;s not a valid proof!&rdquo;</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C data-lang=C><span style=display:flex><span><span style=color:#66d9ef>if</span> (((proof <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>) <span style=color:#f92672>||</span> (proof <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>)) {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>puts</span>(<span style=color:#e6db74>&#34;That</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>s not a valid proof!&#34;</span>);
</span></span><span style=display:flex><span>  ret <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>For the good ending, we check what&rsquo;s in the <code>else</code> block.</p><p>Here, I have renamed two functions to <code>n_digits</code> and <code>sum_of_digits</code> because that is exactly what they do.
There&rsquo;s nothing worth explaining about them in particular but you may check them if you are following along.</p><p>First we need the number of digits in the volcano and bear digits to be equal.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C data-lang=C><span style=display:flex><span>n_volcano <span style=color:#f92672>=</span> <span style=color:#a6e22e>n_digits</span>(volcano);
</span></span><span style=display:flex><span>n_bear <span style=color:#f92672>=</span> <span style=color:#a6e22e>n_digits</span>(bear);
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> (n_volcano <span style=color:#f92672>==</span> n_bear) {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// ...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> }
</span></span></code></pre></div><p>Our second constraint is that the sum of the digits must equal for the volcano and the bear.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C data-lang=C><span style=display:flex><span>n_volcano <span style=color:#f92672>=</span> <span style=color:#a6e22e>sum_of_digits</span>(volcano);
</span></span><span style=display:flex><span>n_bear <span style=color:#f92672>=</span> <span style=color:#a6e22e>sum_of_digits</span>(bear);
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> (n_volcano <span style=color:#f92672>==</span> n_bear) {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// ...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span></code></pre></div><p>Finally the happy ending happens when the result of a proof checking function is the same for both the numbers.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C data-lang=C><span style=display:flex><span>m_v <span style=color:#f92672>=</span> <span style=color:#a6e22e>check_proof</span>(leet,volcano,proof);
</span></span><span style=display:flex><span>m_b <span style=color:#f92672>=</span> <span style=color:#a6e22e>check_proof</span>(leet,bear,proof);
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> (m_v <span style=color:#f92672>==</span> m_b) {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>puts</span>(<span style=color:#e6db74>&#34;That looks right to me!&#34;</span>);
</span></span><span style=display:flex><span>  flag <span style=color:#f92672>=</span> <span style=color:#a6e22e>fopen</span>(<span style=color:#e6db74>&#34;flag.txt&#34;</span>,<span style=color:#e6db74>&#34;r&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fgets</span>(buf,<span style=color:#ae81ff>0x80</span>,flag);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>puts</span>(buf);
</span></span><span style=display:flex><span>  ret <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>goto</span> LAB_00101740;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Now, I will visit the functions that I had glossed over earlier.</p><h3 id=process_bear><code>process_bear</code></h3><p>The decompilation looks like the following after some renaming and cleanup.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C data-lang=C><span style=display:flex><span><span style=color:#66d9ef>bool</span> <span style=color:#a6e22e>process_bear</span>(ulong b) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> ((b <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (b <span style=color:#f92672>%</span> <span style=color:#ae81ff>3</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>2</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (b <span style=color:#f92672>%</span> <span style=color:#ae81ff>5</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (b <span style=color:#f92672>+</span> ((b <span style=color:#f92672>-</span> b <span style=color:#f92672>/</span> <span style=color:#ae81ff>7</span> <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>+</span> b <span style=color:#f92672>/</span> <span style=color:#ae81ff>7</span> <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>*</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>7</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>3</span>) {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>if</span> (b <span style=color:#f92672>%</span> <span style=color:#ae81ff>0x6d</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0x37</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> true;
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> false;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>This function gives us the constraints for the unsigned long integer represented by &ldquo;bear&rdquo;.
The function only returns true when all of the following conditions are met by the number:</p><ul><li>The last bit is zero (<code>b & 1 == 0</code>), meaning, it is even.</li><li>When divided by 3, yields the remainder of 2.</li><li>When divided by 5, yields the remainder of 1.</li><li>When divided by 0x6d, yields the remainder of 0x37.</li><li>The madness that is <code>b + ((b - b / 7 >> 1) + b / 7 >> 2) * -7 == 3</code></li></ul><p>Okay, calm down, the last part is not very hard to decipher. Let&rsquo;s work it out piece by piece.</p><p>The right shift operation (<code>>></code>) implies division by 2 to the power of something. So the innermost parenthetic expression
<code>b - b / 7 >> 1</code> means to divide <code>b - b / 7</code> by 2 to the power of 1.</p><p>When considered as a purely mathematical expression, we can perform the following simplification.</p><div class=math><svg style="vertical-align:-1.629ex" xmlns="http://www.w3.org/2000/svg" width="28.138ex" height="4.728ex" role="img" focusable="false" viewBox="0 -1370 12436.9 2089.9" class="foo"><g stroke="currentcolor" fill="currentcolor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D44F" d="M73 647q0 10 4 23t12 13q1 0 72 5t73 6q12 0 12-9T212 542q-8-34-17-70t-15-54l-4-19q0-3 6 3 49 40 101 40 62 0 1e2-46t39-116q0-111-79-201T173-11q-50 0-91 38T40 150v9q0 21 8 58T97 414q50 197 50 209t-38 14q-5 0-8 0H96q-10 0-13 0t-7 3-3 7zM336 325v6q0 74-61 74-17 0-35-8t-33-21-26-24-18-22l-6-8-21-86q-22-86-22-122 0-48 24-72 16-16 40-16 33 0 67 32 25 23 40 56t33 105 18 106z"/></g><g data-mml-node="mo" transform="translate(651.2,0)"><path data-c="2212" d="M84 237t0 13 14 20H679q15-8 15-20t-15-20H98q-14 7-14 20z"/></g><g data-mml-node="mn" transform="translate(1651.4,0)"><path data-c="37" d="M55 458q1 2 17 109L88 674q0 2 20 2h20v-4q0-10 15-17t52-9 169-2H485V605l-68-93q-9-12-30-40t-27-37-21-32-20-36-14-37-13-46-8-54-6-68-3-82q0-14 0-28t-1-24V19q-4-17-19-29T221-22q-11 0-21 3T179 0 168 40q0 158 97 328 20 32 84 121l46 63H302q-174 0-183-6-6-3-11-24T98 479l-3-21v-3H55v3z"/></g><g data-mml-node="mo" transform="translate(2373.7,0)"><path data-c="D7" d="M630 29q0-20-21-20-5 0-22 16t-94 93L389 222 284 117Q178 13 175 11q-4-2-7-2-8 0-14 6t-7 14q0 7 14 22t94 95L359 250 255 354q-81 81-94 95t-14 22q0 9 6 14t15 5q5 0 7-1 3-2 109-106L389 278 493 382q77 77 94 93t22 16q21 0 21-20 0-7-10-18t-98-98L418 250 522 145q84-84 96-97t12-19z"/></g><g data-mml-node="mfrac" transform="translate(3373.9,0)"><g data-mml-node="mn" transform="translate(438.3,676)"><path data-c="31" d="M213 578l-13-5q-14-5-40-10t-58-7H83v46h19q47 2 87 15t56 24 28 22q2 3 12 3 9 0 17-6V361l1-3e2q7-7 12-9t24-4 62-2h26V0H416Q395 3 257 3 121 3 1e2.0H88V46h26q22 0 38 0t25 1 16 3 8 2 6 5 6 4V578z"/></g><g data-mml-node="msup" transform="translate(220,-719.9)"><g data-mml-node="mn"><path data-c="32" d="M109 429q-27 0-43 18T50 491q0 71 53 123t132 52q91 0 152-56t62-145q0-43-20-82t-48-68-80-74q-36-31-1e2-92L142 93l76-1q157 0 167 5 7 2 24 89v3h40v-3q-1-3-13-91T421 3V0H50V19 31q0 7 6 15T86 81q29 32 50 56 9 10 34 37t34 37 29 33 28 34 23 30 21 32 15 29 13 32 7 30 3 33q0 63-34 109t-97 46q-33 0-58-17t-35-33-10-19q0-1 5-1 18 0 37-14t19-46q0-25-16-42t-45-18z"/></g><g data-mml-node="mn" transform="translate(533,289) scale(0.707)"><path data-c="32" d="M109 429q-27 0-43 18T50 491q0 71 53 123t132 52q91 0 152-56t62-145q0-43-20-82t-48-68-80-74q-36-31-1e2-92L142 93l76-1q157 0 167 5 7 2 24 89v3h40v-3q-1-3-13-91T421 3V0H50V19 31q0 7 6 15T86 81q29 32 50 56 9 10 34 37t34 37 29 33 28 34 23 30 21 32 15 29 13 32 7 30 3 33q0 63-34 109t-97 46q-33 0-58-17t-35-33-10-19q0-1 5-1 18 0 37-14t19-46q0-25-16-42t-45-18z"/></g></g><rect width="1136.6" height="60" x="120" y="220"/></g><g data-mml-node="mo" transform="translate(4750.4,0)"><path data-c="28" d="M94 250q0 69 10 131t23 107 37 88 38 67 42 52 33 34 25 21h13 4q14 0 14-9 0-3-17-21t-41-53-49-86-42-138-17-193T184 58 225-81t49-86 42-53 17-21q0-9-15-9h-3-13l-28 24Q180-141 137-14T94 250z"/></g><g data-mml-node="mfrac" transform="translate(5139.4,0)"><g data-mml-node="mn" transform="translate(438.3,676)"><path data-c="31" d="M213 578l-13-5q-14-5-40-10t-58-7H83v46h19q47 2 87 15t56 24 28 22q2 3 12 3 9 0 17-6V361l1-3e2q7-7 12-9t24-4 62-2h26V0H416Q395 3 257 3 121 3 1e2.0H88V46h26q22 0 38 0t25 1 16 3 8 2 6 5 6 4V578z"/></g><g data-mml-node="msup" transform="translate(220,-719.9)"><g data-mml-node="mn"><path data-c="32" d="M109 429q-27 0-43 18T50 491q0 71 53 123t132 52q91 0 152-56t62-145q0-43-20-82t-48-68-80-74q-36-31-1e2-92L142 93l76-1q157 0 167 5 7 2 24 89v3h40v-3q-1-3-13-91T421 3V0H50V19 31q0 7 6 15T86 81q29 32 50 56 9 10 34 37t34 37 29 33 28 34 23 30 21 32 15 29 13 32 7 30 3 33q0 63-34 109t-97 46q-33 0-58-17t-35-33-10-19q0-1 5-1 18 0 37-14t19-46q0-25-16-42t-45-18z"/></g><g data-mml-node="mn" transform="translate(533,289) scale(0.707)"><path data-c="31" d="M213 578l-13-5q-14-5-40-10t-58-7H83v46h19q47 2 87 15t56 24 28 22q2 3 12 3 9 0 17-6V361l1-3e2q7-7 12-9t24-4 62-2h26V0H416Q395 3 257 3 121 3 1e2.0H88V46h26q22 0 38 0t25 1 16 3 8 2 6 5 6 4V578z"/></g></g><rect width="1136.6" height="60" x="120" y="220"/></g><g data-mml-node="mo" transform="translate(6516,0)"><path data-c="28" d="M94 250q0 69 10 131t23 107 37 88 38 67 42 52 33 34 25 21h13 4q14 0 14-9 0-3-17-21t-41-53-49-86-42-138-17-193T184 58 225-81t49-86 42-53 17-21q0-9-15-9h-3-13l-28 24Q180-141 137-14T94 250z"/></g><g data-mml-node="mi" transform="translate(6905,0)"><path data-c="1D44F" d="M73 647q0 10 4 23t12 13q1 0 72 5t73 6q12 0 12-9T212 542q-8-34-17-70t-15-54l-4-19q0-3 6 3 49 40 101 40 62 0 1e2-46t39-116q0-111-79-201T173-11q-50 0-91 38T40 150v9q0 21 8 58T97 414q50 197 50 209t-38 14q-5 0-8 0H96q-10 0-13 0t-7 3-3 7zM336 325v6q0 74-61 74-17 0-35-8t-33-21-26-24-18-22l-6-8-21-86q-22-86-22-122 0-48 24-72 16-16 40-16 33 0 67 32 25 23 40 56t33 105 18 106z"/></g><g data-mml-node="mo" transform="translate(7556.2,0)"><path data-c="2212" d="M84 237t0 13 14 20H679q15-8 15-20t-15-20H98q-14 7-14 20z"/></g><g data-mml-node="mfrac" transform="translate(8556.4,0)"><g data-mml-node="mi" transform="translate(255.5,676)"><path data-c="1D44F" d="M73 647q0 10 4 23t12 13q1 0 72 5t73 6q12 0 12-9T212 542q-8-34-17-70t-15-54l-4-19q0-3 6 3 49 40 101 40 62 0 1e2-46t39-116q0-111-79-201T173-11q-50 0-91 38T40 150v9q0 21 8 58T97 414q50 197 50 209t-38 14q-5 0-8 0H96q-10 0-13 0t-7 3-3 7zM336 325v6q0 74-61 74-17 0-35-8t-33-21-26-24-18-22l-6-8-21-86q-22-86-22-122 0-48 24-72 16-16 40-16 33 0 67 32 25 23 40 56t33 105 18 106z"/></g><g data-mml-node="mn" transform="translate(220,-686)"><path data-c="37" d="M55 458q1 2 17 109L88 674q0 2 20 2h20v-4q0-10 15-17t52-9 169-2H485V605l-68-93q-9-12-30-40t-27-37-21-32-20-36-14-37-13-46-8-54-6-68-3-82q0-14 0-28t-1-24V19q-4-17-19-29T221-22q-11 0-21 3T179 0 168 40q0 158 97 328 20 32 84 121l46 63H302q-174 0-183-6-6-3-11-24T98 479l-3-21v-3H55v3z"/></g><rect width="700" height="60" x="120" y="220"/></g><g data-mml-node="mo" transform="translate(9496.4,0)"><path data-c="29" d="M60 749l4 1q5 0 10 0H86l28-24q94-85 137-212t43-264q0-68-10-131T261 12 224-76t-38-67-41-51-32-33-23-19q-3-3-4-4H74q-8 0-11 0t-5 3-3 9q1 1 11 13Q221-64 221 250T66 725q-10 12-11 13 0 8 5 11z"/></g><g data-mml-node="mo" transform="translate(10107.7,0)"><path data-c="2B" d="M56 237t0 13 14 20H369V420l1 150q10 13 19 13 13 0 20-15V270H707q15-8 15-20t-15-20H409V-68q-8-14-18-14h-2-2q-12 0-18 14V230H70q-14 7-14 20z"/></g><g data-mml-node="mfrac" transform="translate(11107.9,0)"><g data-mml-node="mi" transform="translate(255.5,676)"><path data-c="1D44F" d="M73 647q0 10 4 23t12 13q1 0 72 5t73 6q12 0 12-9T212 542q-8-34-17-70t-15-54l-4-19q0-3 6 3 49 40 101 40 62 0 1e2-46t39-116q0-111-79-201T173-11q-50 0-91 38T40 150v9q0 21 8 58T97 414q50 197 50 209t-38 14q-5 0-8 0H96q-10 0-13 0t-7 3-3 7zM336 325v6q0 74-61 74-17 0-35-8t-33-21-26-24-18-22l-6-8-21-86q-22-86-22-122 0-48 24-72 16-16 40-16 33 0 67 32 25 23 40 56t33 105 18 106z"/></g><g data-mml-node="mn" transform="translate(220,-686)"><path data-c="37" d="M55 458q1 2 17 109L88 674q0 2 20 2h20v-4q0-10 15-17t52-9 169-2H485V605l-68-93q-9-12-30-40t-27-37-21-32-20-36-14-37-13-46-8-54-6-68-3-82q0-14 0-28t-1-24V19q-4-17-19-29T221-22q-11 0-21 3T179 0 168 40q0 158 97 328 20 32 84 121l46 63H302q-174 0-183-6-6-3-11-24T98 479l-3-21v-3H55v3z"/></g><rect width="700" height="60" x="120" y="220"/></g><g data-mml-node="mo" transform="translate(12047.9,0)"><path data-c="29" d="M60 749l4 1q5 0 10 0H86l28-24q94-85 137-212t43-264q0-68-10-131T261 12 224-76t-38-67-41-51-32-33-23-19q-3-3-4-4H74q-8 0-11 0t-5 3-3 9q1 1 11 13Q221-64 221 250T66 725q-10 12-11 13 0 8 5 11z"/></g></g></g></svg></div><div class=math><svg style="vertical-align:-1.629ex" xmlns="http://www.w3.org/2000/svg" width="27.635ex" height="4.728ex" role="img" focusable="false" viewBox="0 -1370 12214.7 2089.9"><g stroke="currentcolor" fill="currentcolor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="3D" d="M56 347q0 13 14 20H707q15-8 15-20 0-11-14-19l-318-1H72q-16 5-16 20zm0-194q0 15 16 20H708q14-10 14-20 0-13-15-20H70q-14 7-14 20z"/></g><g data-mml-node="mi" transform="translate(1055.8,0)"><path data-c="1D44F" d="M73 647q0 10 4 23t12 13q1 0 72 5t73 6q12 0 12-9T212 542q-8-34-17-70t-15-54l-4-19q0-3 6 3 49 40 101 40 62 0 1e2-46t39-116q0-111-79-201T173-11q-50 0-91 38T40 150v9q0 21 8 58T97 414q50 197 50 209t-38 14q-5 0-8 0H96q-10 0-13 0t-7 3-3 7zM336 325v6q0 74-61 74-17 0-35-8t-33-21-26-24-18-22l-6-8-21-86q-22-86-22-122 0-48 24-72 16-16 40-16 33 0 67 32 25 23 40 56t33 105 18 106z"/></g><g data-mml-node="mo" transform="translate(1707,0)"><path data-c="2212" d="M84 237t0 13 14 20H679q15-8 15-20t-15-20H98q-14 7-14 20z"/></g><g data-mml-node="mn" transform="translate(2707.2,0)"><path data-c="37" d="M55 458q1 2 17 109L88 674q0 2 20 2h20v-4q0-10 15-17t52-9 169-2H485V605l-68-93q-9-12-30-40t-27-37-21-32-20-36-14-37-13-46-8-54-6-68-3-82q0-14 0-28t-1-24V19q-4-17-19-29T221-22q-11 0-21 3T179 0 168 40q0 158 97 328 20 32 84 121l46 63H302q-174 0-183-6-6-3-11-24T98 479l-3-21v-3H55v3z"/></g><g data-mml-node="mo" transform="translate(3429.4,0)"><path data-c="D7" d="M630 29q0-20-21-20-5 0-22 16t-94 93L389 222 284 117Q178 13 175 11q-4-2-7-2-8 0-14 6t-7 14q0 7 14 22t94 95L359 250 255 354q-81 81-94 95t-14 22q0 9 6 14t15 5q5 0 7-1 3-2 109-106L389 278 493 382q77 77 94 93t22 16q21 0 21-20 0-7-10-18t-98-98L418 250 522 145q84-84 96-97t12-19z"/></g><g data-mml-node="mfrac" transform="translate(4429.7,0)"><g data-mml-node="mn" transform="translate(438.3,676)"><path data-c="31" d="M213 578l-13-5q-14-5-40-10t-58-7H83v46h19q47 2 87 15t56 24 28 22q2 3 12 3 9 0 17-6V361l1-3e2q7-7 12-9t24-4 62-2h26V0H416Q395 3 257 3 121 3 1e2.0H88V46h26q22 0 38 0t25 1 16 3 8 2 6 5 6 4V578z"/></g><g data-mml-node="msup" transform="translate(220,-719.9)"><g data-mml-node="mn"><path data-c="32" d="M109 429q-27 0-43 18T50 491q0 71 53 123t132 52q91 0 152-56t62-145q0-43-20-82t-48-68-80-74q-36-31-1e2-92L142 93l76-1q157 0 167 5 7 2 24 89v3h40v-3q-1-3-13-91T421 3V0H50V19 31q0 7 6 15T86 81q29 32 50 56 9 10 34 37t34 37 29 33 28 34 23 30 21 32 15 29 13 32 7 30 3 33q0 63-34 109t-97 46q-33 0-58-17t-35-33-10-19q0-1 5-1 18 0 37-14t19-46q0-25-16-42t-45-18z"/></g><g data-mml-node="mn" transform="translate(533,289) scale(0.707)"><path data-c="32" d="M109 429q-27 0-43 18T50 491q0 71 53 123t132 52q91 0 152-56t62-145q0-43-20-82t-48-68-80-74q-36-31-1e2-92L142 93l76-1q157 0 167 5 7 2 24 89v3h40v-3q-1-3-13-91T421 3V0H50V19 31q0 7 6 15T86 81q29 32 50 56 9 10 34 37t34 37 29 33 28 34 23 30 21 32 15 29 13 32 7 30 3 33q0 63-34 109t-97 46q-33 0-58-17t-35-33-10-19q0-1 5-1 18 0 37-14t19-46q0-25-16-42t-45-18z"/></g></g><rect width="1136.6" height="60" x="120" y="220"/></g><g data-mml-node="mo" transform="translate(5806.2,0)"><path data-c="28" d="M94 250q0 69 10 131t23 107 37 88 38 67 42 52 33 34 25 21h13 4q14 0 14-9 0-3-17-21t-41-53-49-86-42-138-17-193T184 58 225-81t49-86 42-53 17-21q0-9-15-9h-3-13l-28 24Q180-141 137-14T94 250z"/></g><g data-mml-node="mfrac" transform="translate(6195.2,0)"><g data-mml-node="mn" transform="translate(438.3,676)"><path data-c="31" d="M213 578l-13-5q-14-5-40-10t-58-7H83v46h19q47 2 87 15t56 24 28 22q2 3 12 3 9 0 17-6V361l1-3e2q7-7 12-9t24-4 62-2h26V0H416Q395 3 257 3 121 3 1e2.0H88V46h26q22 0 38 0t25 1 16 3 8 2 6 5 6 4V578z"/></g><g data-mml-node="msup" transform="translate(220,-719.9)"><g data-mml-node="mn"><path data-c="32" d="M109 429q-27 0-43 18T50 491q0 71 53 123t132 52q91 0 152-56t62-145q0-43-20-82t-48-68-80-74q-36-31-1e2-92L142 93l76-1q157 0 167 5 7 2 24 89v3h40v-3q-1-3-13-91T421 3V0H50V19 31q0 7 6 15T86 81q29 32 50 56 9 10 34 37t34 37 29 33 28 34 23 30 21 32 15 29 13 32 7 30 3 33q0 63-34 109t-97 46q-33 0-58-17t-35-33-10-19q0-1 5-1 18 0 37-14t19-46q0-25-16-42t-45-18z"/></g><g data-mml-node="mn" transform="translate(533,289) scale(0.707)"><path data-c="31" d="M213 578l-13-5q-14-5-40-10t-58-7H83v46h19q47 2 87 15t56 24 28 22q2 3 12 3 9 0 17-6V361l1-3e2q7-7 12-9t24-4 62-2h26V0H416Q395 3 257 3 121 3 1e2.0H88V46h26q22 0 38 0t25 1 16 3 8 2 6 5 6 4V578z"/></g></g><rect width="1136.6" height="60" x="120" y="220"/></g><g data-mml-node="mo" transform="translate(7794,0)"><path data-c="22C5" d="M78 250q0 24 17 42t43 18q24 0 42-16t19-43q0-25-17-43t-43-18-43 17-18 43z"/></g><g data-mml-node="mfrac" transform="translate(8294.2,0)"><g data-mml-node="mrow" transform="translate(220,676)"><g data-mml-node="mn"><path data-c="36" d="M42 313q0 163 81 258t180 95q69 0 99-36t30-80q0-25-14-40t-39-15q-23 0-38 14t-15 39q0 44 47 53-22 22-62 25-71 0-117-60-47-66-47-202l1-4q5 6 8 13 41 60 107 60h4q46 0 81-19 24-14 48-40t39-57q21-49 21-107V192q0-23-5-43-11-59-64-115T253-22q-28 0-54 8T143 16 92 75 56 172 42 313zm215 84q-30 0-52-17t-34-45-17-57-6-62q0-83 12-119t38-58q24-18 53-18 51 0 78 38 13 18 18 45t5 105q0 80-5 107t-18 45q-27 36-72 36z"/></g><g data-mml-node="mi" transform="translate(500,0)"><path data-c="1D44F" d="M73 647q0 10 4 23t12 13q1 0 72 5t73 6q12 0 12-9T212 542q-8-34-17-70t-15-54l-4-19q0-3 6 3 49 40 101 40 62 0 1e2-46t39-116q0-111-79-201T173-11q-50 0-91 38T40 150v9q0 21 8 58T97 414q50 197 50 209t-38 14q-5 0-8 0H96q-10 0-13 0t-7 3-3 7zM336 325v6q0 74-61 74-17 0-35-8t-33-21-26-24-18-22l-6-8-21-86q-22-86-22-122 0-48 24-72 16-16 40-16 33 0 67 32 25 23 40 56t33 105 18 106z"/></g></g><g data-mml-node="mn" transform="translate(434.5,-686)"><path data-c="37" d="M55 458q1 2 17 109L88 674q0 2 20 2h20v-4q0-10 15-17t52-9 169-2H485V605l-68-93q-9-12-30-40t-27-37-21-32-20-36-14-37-13-46-8-54-6-68-3-82q0-14 0-28t-1-24V19q-4-17-19-29T221-22q-11 0-21 3T179 0 168 40q0 158 97 328 20 32 84 121l46 63H302q-174 0-183-6-6-3-11-24T98 479l-3-21v-3H55v3z"/></g><rect width="1129" height="60" x="120" y="220"/></g><g data-mml-node="mo" transform="translate(9885.4,0)"><path data-c="2B" d="M56 237t0 13 14 20H369V420l1 150q10 13 19 13 13 0 20-15V270H707q15-8 15-20t-15-20H409V-68q-8-14-18-14h-2-2q-12 0-18 14V230H70q-14 7-14 20z"/></g><g data-mml-node="mfrac" transform="translate(10885.7,0)"><g data-mml-node="mi" transform="translate(255.5,676)"><path data-c="1D44F" d="M73 647q0 10 4 23t12 13q1 0 72 5t73 6q12 0 12-9T212 542q-8-34-17-70t-15-54l-4-19q0-3 6 3 49 40 101 40 62 0 1e2-46t39-116q0-111-79-201T173-11q-50 0-91 38T40 150v9q0 21 8 58T97 414q50 197 50 209t-38 14q-5 0-8 0H96q-10 0-13 0t-7 3-3 7zM336 325v6q0 74-61 74-17 0-35-8t-33-21-26-24-18-22l-6-8-21-86q-22-86-22-122 0-48 24-72 16-16 40-16 33 0 67 32 25 23 40 56t33 105 18 106z"/></g><g data-mml-node="mn" transform="translate(220,-686)"><path data-c="37" d="M55 458q1 2 17 109L88 674q0 2 20 2h20v-4q0-10 15-17t52-9 169-2H485V605l-68-93q-9-12-30-40t-27-37-21-32-20-36-14-37-13-46-8-54-6-68-3-82q0-14 0-28t-1-24V19q-4-17-19-29T221-22q-11 0-21 3T179 0 168 40q0 158 97 328 20 32 84 121l46 63H302q-174 0-183-6-6-3-11-24T98 479l-3-21v-3H55v3z"/></g><rect width="700" height="60" x="120" y="220"/></g><g data-mml-node="mo" transform="translate(11825.7,0)"><path data-c="29" d="M60 749l4 1q5 0 10 0H86l28-24q94-85 137-212t43-264q0-68-10-131T261 12 224-76t-38-67-41-51-32-33-23-19q-3-3-4-4H74q-8 0-11 0t-5 3-3 9q1 1 11 13Q221-64 221 250T66 725q-10 12-11 13 0 8 5 11z"/></g></g></g></svg></div><div class=math><svg style="vertical-align:-1.629ex" xmlns="http://www.w3.org/2000/svg" width="28.138ex" height="4.728ex" role="img" focusable="false" viewBox="0 -1370 12436.9 2089.9" class="foo"><g stroke="currentcolor" fill="currentcolor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D44F" d="M73 647q0 10 4 23t12 13q1 0 72 5t73 6q12 0 12-9T212 542q-8-34-17-70t-15-54l-4-19q0-3 6 3 49 40 101 40 62 0 1e2-46t39-116q0-111-79-201T173-11q-50 0-91 38T40 150v9q0 21 8 58T97 414q50 197 50 209t-38 14q-5 0-8 0H96q-10 0-13 0t-7 3-3 7zM336 325v6q0 74-61 74-17 0-35-8t-33-21-26-24-18-22l-6-8-21-86q-22-86-22-122 0-48 24-72 16-16 40-16 33 0 67 32 25 23 40 56t33 105 18 106z"/></g><g data-mml-node="mo" transform="translate(651.2,0)"><path data-c="2212" d="M84 237t0 13 14 20H679q15-8 15-20t-15-20H98q-14 7-14 20z"/></g><g data-mml-node="mn" transform="translate(1651.4,0)"><path data-c="37" d="M55 458q1 2 17 109L88 674q0 2 20 2h20v-4q0-10 15-17t52-9 169-2H485V605l-68-93q-9-12-30-40t-27-37-21-32-20-36-14-37-13-46-8-54-6-68-3-82q0-14 0-28t-1-24V19q-4-17-19-29T221-22q-11 0-21 3T179 0 168 40q0 158 97 328 20 32 84 121l46 63H302q-174 0-183-6-6-3-11-24T98 479l-3-21v-3H55v3z"/></g><g data-mml-node="mo" transform="translate(2373.7,0)"><path data-c="D7" d="M630 29q0-20-21-20-5 0-22 16t-94 93L389 222 284 117Q178 13 175 11q-4-2-7-2-8 0-14 6t-7 14q0 7 14 22t94 95L359 250 255 354q-81 81-94 95t-14 22q0 9 6 14t15 5q5 0 7-1 3-2 109-106L389 278 493 382q77 77 94 93t22 16q21 0 21-20 0-7-10-18t-98-98L418 250 522 145q84-84 96-97t12-19z"/></g><g data-mml-node="mfrac" transform="translate(3373.9,0)"><g data-mml-node="mn" transform="translate(438.3,676)"><path data-c="31" d="M213 578l-13-5q-14-5-40-10t-58-7H83v46h19q47 2 87 15t56 24 28 22q2 3 12 3 9 0 17-6V361l1-3e2q7-7 12-9t24-4 62-2h26V0H416Q395 3 257 3 121 3 1e2.0H88V46h26q22 0 38 0t25 1 16 3 8 2 6 5 6 4V578z"/></g><g data-mml-node="msup" transform="translate(220,-719.9)"><g data-mml-node="mn"><path data-c="32" d="M109 429q-27 0-43 18T50 491q0 71 53 123t132 52q91 0 152-56t62-145q0-43-20-82t-48-68-80-74q-36-31-1e2-92L142 93l76-1q157 0 167 5 7 2 24 89v3h40v-3q-1-3-13-91T421 3V0H50V19 31q0 7 6 15T86 81q29 32 50 56 9 10 34 37t34 37 29 33 28 34 23 30 21 32 15 29 13 32 7 30 3 33q0 63-34 109t-97 46q-33 0-58-17t-35-33-10-19q0-1 5-1 18 0 37-14t19-46q0-25-16-42t-45-18z"/></g><g data-mml-node="mn" transform="translate(533,289) scale(0.707)"><path data-c="32" d="M109 429q-27 0-43 18T50 491q0 71 53 123t132 52q91 0 152-56t62-145q0-43-20-82t-48-68-80-74q-36-31-1e2-92L142 93l76-1q157 0 167 5 7 2 24 89v3h40v-3q-1-3-13-91T421 3V0H50V19 31q0 7 6 15T86 81q29 32 50 56 9 10 34 37t34 37 29 33 28 34 23 30 21 32 15 29 13 32 7 30 3 33q0 63-34 109t-97 46q-33 0-58-17t-35-33-10-19q0-1 5-1 18 0 37-14t19-46q0-25-16-42t-45-18z"/></g></g><rect width="1136.6" height="60" x="120" y="220"/></g><g data-mml-node="mo" transform="translate(4750.4,0)"><path data-c="28" d="M94 250q0 69 10 131t23 107 37 88 38 67 42 52 33 34 25 21h13 4q14 0 14-9 0-3-17-21t-41-53-49-86-42-138-17-193T184 58 225-81t49-86 42-53 17-21q0-9-15-9h-3-13l-28 24Q180-141 137-14T94 250z"/></g><g data-mml-node="mfrac" transform="translate(5139.4,0)"><g data-mml-node="mn" transform="translate(438.3,676)"><path data-c="31" d="M213 578l-13-5q-14-5-40-10t-58-7H83v46h19q47 2 87 15t56 24 28 22q2 3 12 3 9 0 17-6V361l1-3e2q7-7 12-9t24-4 62-2h26V0H416Q395 3 257 3 121 3 1e2.0H88V46h26q22 0 38 0t25 1 16 3 8 2 6 5 6 4V578z"/></g><g data-mml-node="msup" transform="translate(220,-719.9)"><g data-mml-node="mn"><path data-c="32" d="M109 429q-27 0-43 18T50 491q0 71 53 123t132 52q91 0 152-56t62-145q0-43-20-82t-48-68-80-74q-36-31-1e2-92L142 93l76-1q157 0 167 5 7 2 24 89v3h40v-3q-1-3-13-91T421 3V0H50V19 31q0 7 6 15T86 81q29 32 50 56 9 10 34 37t34 37 29 33 28 34 23 30 21 32 15 29 13 32 7 30 3 33q0 63-34 109t-97 46q-33 0-58-17t-35-33-10-19q0-1 5-1 18 0 37-14t19-46q0-25-16-42t-45-18z"/></g><g data-mml-node="mn" transform="translate(533,289) scale(0.707)"><path data-c="31" d="M213 578l-13-5q-14-5-40-10t-58-7H83v46h19q47 2 87 15t56 24 28 22q2 3 12 3 9 0 17-6V361l1-3e2q7-7 12-9t24-4 62-2h26V0H416Q395 3 257 3 121 3 1e2.0H88V46h26q22 0 38 0t25 1 16 3 8 2 6 5 6 4V578z"/></g></g><rect width="1136.6" height="60" x="120" y="220"/></g><g data-mml-node="mo" transform="translate(6516,0)"><path data-c="28" d="M94 250q0 69 10 131t23 107 37 88 38 67 42 52 33 34 25 21h13 4q14 0 14-9 0-3-17-21t-41-53-49-86-42-138-17-193T184 58 225-81t49-86 42-53 17-21q0-9-15-9h-3-13l-28 24Q180-141 137-14T94 250z"/></g><g data-mml-node="mi" transform="translate(6905,0)"><path data-c="1D44F" d="M73 647q0 10 4 23t12 13q1 0 72 5t73 6q12 0 12-9T212 542q-8-34-17-70t-15-54l-4-19q0-3 6 3 49 40 101 40 62 0 1e2-46t39-116q0-111-79-201T173-11q-50 0-91 38T40 150v9q0 21 8 58T97 414q50 197 50 209t-38 14q-5 0-8 0H96q-10 0-13 0t-7 3-3 7zM336 325v6q0 74-61 74-17 0-35-8t-33-21-26-24-18-22l-6-8-21-86q-22-86-22-122 0-48 24-72 16-16 40-16 33 0 67 32 25 23 40 56t33 105 18 106z"/></g><g data-mml-node="mo" transform="translate(7556.2,0)"><path data-c="2212" d="M84 237t0 13 14 20H679q15-8 15-20t-15-20H98q-14 7-14 20z"/></g><g data-mml-node="mfrac" transform="translate(8556.4,0)"><g data-mml-node="mi" transform="translate(255.5,676)"><path data-c="1D44F" d="M73 647q0 10 4 23t12 13q1 0 72 5t73 6q12 0 12-9T212 542q-8-34-17-70t-15-54l-4-19q0-3 6 3 49 40 101 40 62 0 1e2-46t39-116q0-111-79-201T173-11q-50 0-91 38T40 150v9q0 21 8 58T97 414q50 197 50 209t-38 14q-5 0-8 0H96q-10 0-13 0t-7 3-3 7zM336 325v6q0 74-61 74-17 0-35-8t-33-21-26-24-18-22l-6-8-21-86q-22-86-22-122 0-48 24-72 16-16 40-16 33 0 67 32 25 23 40 56t33 105 18 106z"/></g><g data-mml-node="mn" transform="translate(220,-686)"><path data-c="37" d="M55 458q1 2 17 109L88 674q0 2 20 2h20v-4q0-10 15-17t52-9 169-2H485V605l-68-93q-9-12-30-40t-27-37-21-32-20-36-14-37-13-46-8-54-6-68-3-82q0-14 0-28t-1-24V19q-4-17-19-29T221-22q-11 0-21 3T179 0 168 40q0 158 97 328 20 32 84 121l46 63H302q-174 0-183-6-6-3-11-24T98 479l-3-21v-3H55v3z"/></g><rect width="700" height="60" x="120" y="220"/></g><g data-mml-node="mo" transform="translate(9496.4,0)"><path data-c="29" d="M60 749l4 1q5 0 10 0H86l28-24q94-85 137-212t43-264q0-68-10-131T261 12 224-76t-38-67-41-51-32-33-23-19q-3-3-4-4H74q-8 0-11 0t-5 3-3 9q1 1 11 13Q221-64 221 250T66 725q-10 12-11 13 0 8 5 11z"/></g><g data-mml-node="mo" transform="translate(10107.7,0)"><path data-c="2B" d="M56 237t0 13 14 20H369V420l1 150q10 13 19 13 13 0 20-15V270H707q15-8 15-20t-15-20H409V-68q-8-14-18-14h-2-2q-12 0-18 14V230H70q-14 7-14 20z"/></g><g data-mml-node="mfrac" transform="translate(11107.9,0)"><g data-mml-node="mi" transform="translate(255.5,676)"><path data-c="1D44F" d="M73 647q0 10 4 23t12 13q1 0 72 5t73 6q12 0 12-9T212 542q-8-34-17-70t-15-54l-4-19q0-3 6 3 49 40 101 40 62 0 1e2-46t39-116q0-111-79-201T173-11q-50 0-91 38T40 150v9q0 21 8 58T97 414q50 197 50 209t-38 14q-5 0-8 0H96q-10 0-13 0t-7 3-3 7zM336 325v6q0 74-61 74-17 0-35-8t-33-21-26-24-18-22l-6-8-21-86q-22-86-22-122 0-48 24-72 16-16 40-16 33 0 67 32 25 23 40 56t33 105 18 106z"/></g><g data-mml-node="mn" transform="translate(220,-686)"><path data-c="37" d="M55 458q1 2 17 109L88 674q0 2 20 2h20v-4q0-10 15-17t52-9 169-2H485V605l-68-93q-9-12-30-40t-27-37-21-32-20-36-14-37-13-46-8-54-6-68-3-82q0-14 0-28t-1-24V19q-4-17-19-29T221-22q-11 0-21 3T179 0 168 40q0 158 97 328 20 32 84 121l46 63H302q-174 0-183-6-6-3-11-24T98 479l-3-21v-3H55v3z"/></g><rect width="700" height="60" x="120" y="220"/></g><g data-mml-node="mo" transform="translate(12047.9,0)"><path data-c="29" d="M60 749l4 1q5 0 10 0H86l28-24q94-85 137-212t43-264q0-68-10-131T261 12 224-76t-38-67-41-51-32-33-23-19q-3-3-4-4H74q-8 0-11 0t-5 3-3 9q1 1 11 13Q221-64 221 250T66 725q-10 12-11 13 0 8 5 11z"/></g></g></g></svg></div><div class=math><svg style="vertical-align:-1.629ex" xmlns="http://www.w3.org/2000/svg" width="27.635ex" height="4.728ex" role="img" focusable="false" viewBox="0 -1370 12214.7 2089.9"><g stroke="currentcolor" fill="currentcolor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="3D" d="M56 347q0 13 14 20H707q15-8 15-20 0-11-14-19l-318-1H72q-16 5-16 20zm0-194q0 15 16 20H708q14-10 14-20 0-13-15-20H70q-14 7-14 20z"/></g><g data-mml-node="mi" transform="translate(1055.8,0)"><path data-c="1D44F" d="M73 647q0 10 4 23t12 13q1 0 72 5t73 6q12 0 12-9T212 542q-8-34-17-70t-15-54l-4-19q0-3 6 3 49 40 101 40 62 0 1e2-46t39-116q0-111-79-201T173-11q-50 0-91 38T40 150v9q0 21 8 58T97 414q50 197 50 209t-38 14q-5 0-8 0H96q-10 0-13 0t-7 3-3 7zM336 325v6q0 74-61 74-17 0-35-8t-33-21-26-24-18-22l-6-8-21-86q-22-86-22-122 0-48 24-72 16-16 40-16 33 0 67 32 25 23 40 56t33 105 18 106z"/></g><g data-mml-node="mo" transform="translate(1707,0)"><path data-c="2212" d="M84 237t0 13 14 20H679q15-8 15-20t-15-20H98q-14 7-14 20z"/></g><g data-mml-node="mn" transform="translate(2707.2,0)"><path data-c="37" d="M55 458q1 2 17 109L88 674q0 2 20 2h20v-4q0-10 15-17t52-9 169-2H485V605l-68-93q-9-12-30-40t-27-37-21-32-20-36-14-37-13-46-8-54-6-68-3-82q0-14 0-28t-1-24V19q-4-17-19-29T221-22q-11 0-21 3T179 0 168 40q0 158 97 328 20 32 84 121l46 63H302q-174 0-183-6-6-3-11-24T98 479l-3-21v-3H55v3z"/></g><g data-mml-node="mo" transform="translate(3429.4,0)"><path data-c="D7" d="M630 29q0-20-21-20-5 0-22 16t-94 93L389 222 284 117Q178 13 175 11q-4-2-7-2-8 0-14 6t-7 14q0 7 14 22t94 95L359 250 255 354q-81 81-94 95t-14 22q0 9 6 14t15 5q5 0 7-1 3-2 109-106L389 278 493 382q77 77 94 93t22 16q21 0 21-20 0-7-10-18t-98-98L418 250 522 145q84-84 96-97t12-19z"/></g><g data-mml-node="mfrac" transform="translate(4429.7,0)"><g data-mml-node="mn" transform="translate(438.3,676)"><path data-c="31" d="M213 578l-13-5q-14-5-40-10t-58-7H83v46h19q47 2 87 15t56 24 28 22q2 3 12 3 9 0 17-6V361l1-3e2q7-7 12-9t24-4 62-2h26V0H416Q395 3 257 3 121 3 1e2.0H88V46h26q22 0 38 0t25 1 16 3 8 2 6 5 6 4V578z"/></g><g data-mml-node="msup" transform="translate(220,-719.9)"><g data-mml-node="mn"><path data-c="32" d="M109 429q-27 0-43 18T50 491q0 71 53 123t132 52q91 0 152-56t62-145q0-43-20-82t-48-68-80-74q-36-31-1e2-92L142 93l76-1q157 0 167 5 7 2 24 89v3h40v-3q-1-3-13-91T421 3V0H50V19 31q0 7 6 15T86 81q29 32 50 56 9 10 34 37t34 37 29 33 28 34 23 30 21 32 15 29 13 32 7 30 3 33q0 63-34 109t-97 46q-33 0-58-17t-35-33-10-19q0-1 5-1 18 0 37-14t19-46q0-25-16-42t-45-18z"/></g><g data-mml-node="mn" transform="translate(533,289) scale(0.707)"><path data-c="32" d="M109 429q-27 0-43 18T50 491q0 71 53 123t132 52q91 0 152-56t62-145q0-43-20-82t-48-68-80-74q-36-31-1e2-92L142 93l76-1q157 0 167 5 7 2 24 89v3h40v-3q-1-3-13-91T421 3V0H50V19 31q0 7 6 15T86 81q29 32 50 56 9 10 34 37t34 37 29 33 28 34 23 30 21 32 15 29 13 32 7 30 3 33q0 63-34 109t-97 46q-33 0-58-17t-35-33-10-19q0-1 5-1 18 0 37-14t19-46q0-25-16-42t-45-18z"/></g></g><rect width="1136.6" height="60" x="120" y="220"/></g><g data-mml-node="mo" transform="translate(5806.2,0)"><path data-c="28" d="M94 250q0 69 10 131t23 107 37 88 38 67 42 52 33 34 25 21h13 4q14 0 14-9 0-3-17-21t-41-53-49-86-42-138-17-193T184 58 225-81t49-86 42-53 17-21q0-9-15-9h-3-13l-28 24Q180-141 137-14T94 250z"/></g><g data-mml-node="mfrac" transform="translate(6195.2,0)"><g data-mml-node="mn" transform="translate(438.3,676)"><path data-c="31" d="M213 578l-13-5q-14-5-40-10t-58-7H83v46h19q47 2 87 15t56 24 28 22q2 3 12 3 9 0 17-6V361l1-3e2q7-7 12-9t24-4 62-2h26V0H416Q395 3 257 3 121 3 1e2.0H88V46h26q22 0 38 0t25 1 16 3 8 2 6 5 6 4V578z"/></g><g data-mml-node="msup" transform="translate(220,-719.9)"><g data-mml-node="mn"><path data-c="32" d="M109 429q-27 0-43 18T50 491q0 71 53 123t132 52q91 0 152-56t62-145q0-43-20-82t-48-68-80-74q-36-31-1e2-92L142 93l76-1q157 0 167 5 7 2 24 89v3h40v-3q-1-3-13-91T421 3V0H50V19 31q0 7 6 15T86 81q29 32 50 56 9 10 34 37t34 37 29 33 28 34 23 30 21 32 15 29 13 32 7 30 3 33q0 63-34 109t-97 46q-33 0-58-17t-35-33-10-19q0-1 5-1 18 0 37-14t19-46q0-25-16-42t-45-18z"/></g><g data-mml-node="mn" transform="translate(533,289) scale(0.707)"><path data-c="31" d="M213 578l-13-5q-14-5-40-10t-58-7H83v46h19q47 2 87 15t56 24 28 22q2 3 12 3 9 0 17-6V361l1-3e2q7-7 12-9t24-4 62-2h26V0H416Q395 3 257 3 121 3 1e2.0H88V46h26q22 0 38 0t25 1 16 3 8 2 6 5 6 4V578z"/></g></g><rect width="1136.6" height="60" x="120" y="220"/></g><g data-mml-node="mo" transform="translate(7794,0)"><path data-c="22C5" d="M78 250q0 24 17 42t43 18q24 0 42-16t19-43q0-25-17-43t-43-18-43 17-18 43z"/></g><g data-mml-node="mfrac" transform="translate(8294.2,0)"><g data-mml-node="mrow" transform="translate(220,676)"><g data-mml-node="mn"><path data-c="36" d="M42 313q0 163 81 258t180 95q69 0 99-36t30-80q0-25-14-40t-39-15q-23 0-38 14t-15 39q0 44 47 53-22 22-62 25-71 0-117-60-47-66-47-202l1-4q5 6 8 13 41 60 107 60h4q46 0 81-19 24-14 48-40t39-57q21-49 21-107V192q0-23-5-43-11-59-64-115T253-22q-28 0-54 8T143 16 92 75 56 172 42 313zm215 84q-30 0-52-17t-34-45-17-57-6-62q0-83 12-119t38-58q24-18 53-18 51 0 78 38 13 18 18 45t5 105q0 80-5 107t-18 45q-27 36-72 36z"/></g><g data-mml-node="mi" transform="translate(500,0)"><path data-c="1D44F" d="M73 647q0 10 4 23t12 13q1 0 72 5t73 6q12 0 12-9T212 542q-8-34-17-70t-15-54l-4-19q0-3 6 3 49 40 101 40 62 0 1e2-46t39-116q0-111-79-201T173-11q-50 0-91 38T40 150v9q0 21 8 58T97 414q50 197 50 209t-38 14q-5 0-8 0H96q-10 0-13 0t-7 3-3 7zM336 325v6q0 74-61 74-17 0-35-8t-33-21-26-24-18-22l-6-8-21-86q-22-86-22-122 0-48 24-72 16-16 40-16 33 0 67 32 25 23 40 56t33 105 18 106z"/></g></g><g data-mml-node="mn" transform="translate(434.5,-686)"><path data-c="37" d="M55 458q1 2 17 109L88 674q0 2 20 2h20v-4q0-10 15-17t52-9 169-2H485V605l-68-93q-9-12-30-40t-27-37-21-32-20-36-14-37-13-46-8-54-6-68-3-82q0-14 0-28t-1-24V19q-4-17-19-29T221-22q-11 0-21 3T179 0 168 40q0 158 97 328 20 32 84 121l46 63H302q-174 0-183-6-6-3-11-24T98 479l-3-21v-3H55v3z"/></g><rect width="1129" height="60" x="120" y="220"/></g><g data-mml-node="mo" transform="translate(9885.4,0)"><path data-c="2B" d="M56 237t0 13 14 20H369V420l1 150q10 13 19 13 13 0 20-15V270H707q15-8 15-20t-15-20H409V-68q-8-14-18-14h-2-2q-12 0-18 14V230H70q-14 7-14 20z"/></g><g data-mml-node="mfrac" transform="translate(10885.7,0)"><g data-mml-node="mi" transform="translate(255.5,676)"><path data-c="1D44F" d="M73 647q0 10 4 23t12 13q1 0 72 5t73 6q12 0 12-9T212 542q-8-34-17-70t-15-54l-4-19q0-3 6 3 49 40 101 40 62 0 1e2-46t39-116q0-111-79-201T173-11q-50 0-91 38T40 150v9q0 21 8 58T97 414q50 197 50 209t-38 14q-5 0-8 0H96q-10 0-13 0t-7 3-3 7zM336 325v6q0 74-61 74-17 0-35-8t-33-21-26-24-18-22l-6-8-21-86q-22-86-22-122 0-48 24-72 16-16 40-16 33 0 67 32 25 23 40 56t33 105 18 106z"/></g><g data-mml-node="mn" transform="translate(220,-686)"><path data-c="37" d="M55 458q1 2 17 109L88 674q0 2 20 2h20v-4q0-10 15-17t52-9 169-2H485V605l-68-93q-9-12-30-40t-27-37-21-32-20-36-14-37-13-46-8-54-6-68-3-82q0-14 0-28t-1-24V19q-4-17-19-29T221-22q-11 0-21 3T179 0 168 40q0 158 97 328 20 32 84 121l46 63H302q-174 0-183-6-6-3-11-24T98 479l-3-21v-3H55v3z"/></g><rect width="700" height="60" x="120" y="220"/></g><g data-mml-node="mo" transform="translate(11825.7,0)"><path data-c="29" d="M60 749l4 1q5 0 10 0H86l28-24q94-85 137-212t43-264q0-68-10-131T261 12 224-76t-38-67-41-51-32-33-23-19q-3-3-4-4H74q-8 0-11 0t-5 3-3 9q1 1 11 13Q221-64 221 250T66 725q-10 12-11 13 0 8 5 11z"/></g></g></g></svg></div><div class=math><svg style="vertical-align:-1.602ex" xmlns="http://www.w3.org/2000/svg" width="25.66ex" height="4.701ex" role="img" focusable="false" viewBox="0 -1370 11341.6 2078"><g stroke="currentcolor" fill="currentcolor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="3D" d="M56 347q0 13 14 20H707q15-8 15-20 0-11-14-19l-318-1H72q-16 5-16 20zm0-194q0 15 16 20H708q14-10 14-20 0-13-15-20H70q-14 7-14 20z"/></g><g data-mml-node="mi" transform="translate(1055.8,0)"><path data-c="1D44F" d="M73 647q0 10 4 23t12 13q1 0 72 5t73 6q12 0 12-9T212 542q-8-34-17-70t-15-54l-4-19q0-3 6 3 49 40 101 40 62 0 1e2-46t39-116q0-111-79-201T173-11q-50 0-91 38T40 150v9q0 21 8 58T97 414q50 197 50 209t-38 14q-5 0-8 0H96q-10 0-13 0t-7 3-3 7zM336 325v6q0 74-61 74-17 0-35-8t-33-21-26-24-18-22l-6-8-21-86q-22-86-22-122 0-48 24-72 16-16 40-16 33 0 67 32 25 23 40 56t33 105 18 106z"/></g><g data-mml-node="mo" transform="translate(1707,0)"><path data-c="2212" d="M84 237t0 13 14 20H679q15-8 15-20t-15-20H98q-14 7-14 20z"/></g><g data-mml-node="mn" transform="translate(2707.2,0)"><path data-c="37" d="M55 458q1 2 17 109L88 674q0 2 20 2h20v-4q0-10 15-17t52-9 169-2H485V605l-68-93q-9-12-30-40t-27-37-21-32-20-36-14-37-13-46-8-54-6-68-3-82q0-14 0-28t-1-24V19q-4-17-19-29T221-22q-11 0-21 3T179 0 168 40q0 158 97 328 20 32 84 121l46 63H302q-174 0-183-6-6-3-11-24T98 479l-3-21v-3H55v3z"/></g><g data-mml-node="mo" transform="translate(3429.4,0)"><path data-c="D7" d="M630 29q0-20-21-20-5 0-22 16t-94 93L389 222 284 117Q178 13 175 11q-4-2-7-2-8 0-14 6t-7 14q0 7 14 22t94 95L359 250 255 354q-81 81-94 95t-14 22q0 9 6 14t15 5q5 0 7-1 3-2 109-106L389 278 493 382q77 77 94 93t22 16q21 0 21-20 0-7-10-18t-98-98L418 250 522 145q84-84 96-97t12-19z"/></g><g data-mml-node="mfrac" transform="translate(4429.7,0)"><g data-mml-node="mn" transform="translate(220,676)"><path data-c="31" d="M213 578l-13-5q-14-5-40-10t-58-7H83v46h19q47 2 87 15t56 24 28 22q2 3 12 3 9 0 17-6V361l1-3e2q7-7 12-9t24-4 62-2h26V0H416Q395 3 257 3 121 3 1e2.0H88V46h26q22 0 38 0t25 1 16 3 8 2 6 5 6 4V578z"/></g><g data-mml-node="mn" transform="translate(220,-686)"><path data-c="34" d="M462 0Q444 3 333 3 217 3 199 0h-9V46h31q20 0 27 0t17 2 14 5 7 8q1 2 1 54v50H28v46L179 442Q332 674 334 675q2 2 21 2h18l6-6V211h92V165H379V114q0-41 0-48t6-12q8-7 57-8h29V0h-9zM293 211V545L74 212l109-1H293z"/></g><rect width="700" height="60" x="120" y="220"/></g><g data-mml-node="mo" transform="translate(5369.7,0)"><path data-c="28" d="M94 250q0 69 10 131t23 107 37 88 38 67 42 52 33 34 25 21h13 4q14 0 14-9 0-3-17-21t-41-53-49-86-42-138-17-193T184 58 225-81t49-86 42-53 17-21q0-9-15-9h-3-13l-28 24Q180-141 137-14T94 250z"/></g><g data-mml-node="mfrac" transform="translate(5758.7,0)"><g data-mml-node="mn" transform="translate(220,676)"><path data-c="31" d="M213 578l-13-5q-14-5-40-10t-58-7H83v46h19q47 2 87 15t56 24 28 22q2 3 12 3 9 0 17-6V361l1-3e2q7-7 12-9t24-4 62-2h26V0H416Q395 3 257 3 121 3 1e2.0H88V46h26q22 0 38 0t25 1 16 3 8 2 6 5 6 4V578z"/></g><g data-mml-node="mn" transform="translate(220,-686)"><path data-c="32" d="M109 429q-27 0-43 18T50 491q0 71 53 123t132 52q91 0 152-56t62-145q0-43-20-82t-48-68-80-74q-36-31-1e2-92L142 93l76-1q157 0 167 5 7 2 24 89v3h40v-3q-1-3-13-91T421 3V0H50V19 31q0 7 6 15T86 81q29 32 50 56 9 10 34 37t34 37 29 33 28 34 23 30 21 32 15 29 13 32 7 30 3 33q0 63-34 109t-97 46q-33 0-58-17t-35-33-10-19q0-1 5-1 18 0 37-14t19-46q0-25-16-42t-45-18z"/></g><rect width="700" height="60" x="120" y="220"/></g><g data-mml-node="mo" transform="translate(6920.9,0)"><path data-c="22C5" d="M78 250q0 24 17 42t43 18q24 0 42-16t19-43q0-25-17-43t-43-18-43 17-18 43z"/></g><g data-mml-node="mfrac" transform="translate(7421.1,0)"><g data-mml-node="mrow" transform="translate(220,676)"><g data-mml-node="mn"><path data-c="36" d="M42 313q0 163 81 258t180 95q69 0 99-36t30-80q0-25-14-40t-39-15q-23 0-38 14t-15 39q0 44 47 53-22 22-62 25-71 0-117-60-47-66-47-202l1-4q5 6 8 13 41 60 107 60h4q46 0 81-19 24-14 48-40t39-57q21-49 21-107V192q0-23-5-43-11-59-64-115T253-22q-28 0-54 8T143 16 92 75 56 172 42 313zm215 84q-30 0-52-17t-34-45-17-57-6-62q0-83 12-119t38-58q24-18 53-18 51 0 78 38 13 18 18 45t5 105q0 80-5 107t-18 45q-27 36-72 36z"/></g><g data-mml-node="mi" transform="translate(500,0)"><path data-c="1D44F" d="M73 647q0 10 4 23t12 13q1 0 72 5t73 6q12 0 12-9T212 542q-8-34-17-70t-15-54l-4-19q0-3 6 3 49 40 101 40 62 0 1e2-46t39-116q0-111-79-201T173-11q-50 0-91 38T40 150v9q0 21 8 58T97 414q50 197 50 209t-38 14q-5 0-8 0H96q-10 0-13 0t-7 3-3 7zM336 325v6q0 74-61 74-17 0-35-8t-33-21-26-24-18-22l-6-8-21-86q-22-86-22-122 0-48 24-72 16-16 40-16 33 0 67 32 25 23 40 56t33 105 18 106z"/></g></g><g data-mml-node="mn" transform="translate(434.5,-686)"><path data-c="37" d="M55 458q1 2 17 109L88 674q0 2 20 2h20v-4q0-10 15-17t52-9 169-2H485V605l-68-93q-9-12-30-40t-27-37-21-32-20-36-14-37-13-46-8-54-6-68-3-82q0-14 0-28t-1-24V19q-4-17-19-29T221-22q-11 0-21 3T179 0 168 40q0 158 97 328 20 32 84 121l46 63H302q-174 0-183-6-6-3-11-24T98 479l-3-21v-3H55v3z"/></g><rect width="1129" height="60" x="120" y="220"/></g><g data-mml-node="mo" transform="translate(9012.3,0)"><path data-c="2B" d="M56 237t0 13 14 20H369V420l1 150q10 13 19 13 13 0 20-15V270H707q15-8 15-20t-15-20H409V-68q-8-14-18-14h-2-2q-12 0-18 14V230H70q-14 7-14 20z"/></g><g data-mml-node="mfrac" transform="translate(10012.6,0)"><g data-mml-node="mi" transform="translate(255.5,676)"><path data-c="1D44F" d="M73 647q0 10 4 23t12 13q1 0 72 5t73 6q12 0 12-9T212 542q-8-34-17-70t-15-54l-4-19q0-3 6 3 49 40 101 40 62 0 1e2-46t39-116q0-111-79-201T173-11q-50 0-91 38T40 150v9q0 21 8 58T97 414q50 197 50 209t-38 14q-5 0-8 0H96q-10 0-13 0t-7 3-3 7zM336 325v6q0 74-61 74-17 0-35-8t-33-21-26-24-18-22l-6-8-21-86q-22-86-22-122 0-48 24-72 16-16 40-16 33 0 67 32 25 23 40 56t33 105 18 106z"/></g><g data-mml-node="mn" transform="translate(220,-686)"><path data-c="37" d="M55 458q1 2 17 109L88 674q0 2 20 2h20v-4q0-10 15-17t52-9 169-2H485V605l-68-93q-9-12-30-40t-27-37-21-32-20-36-14-37-13-46-8-54-6-68-3-82q0-14 0-28t-1-24V19q-4-17-19-29T221-22q-11 0-21 3T179 0 168 40q0 158 97 328 20 32 84 121l46 63H302q-174 0-183-6-6-3-11-24T98 479l-3-21v-3H55v3z"/></g><rect width="700" height="60" x="120" y="220"/></g><g data-mml-node="mo" transform="translate(10952.6,0)"><path data-c="29" d="M60 749l4 1q5 0 10 0H86l28-24q94-85 137-212t43-264q0-68-10-131T261 12 224-76t-38-67-41-51-32-33-23-19q-3-3-4-4H74q-8 0-11 0t-5 3-3 9q1 1 11 13Q221-64 221 250T66 725q-10 12-11 13 0 8 5 11z"/></g></g></g></svg></div><div class=math><svg style="vertical-align:-1.602ex" xmlns="http://www.w3.org/2000/svg" width="21.898ex" height="4.701ex" role="img" focusable="false" viewBox="0 -1370 9679.1 2078"><g stroke="currentcolor" fill="currentcolor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="3D" d="M56 347q0 13 14 20H707q15-8 15-20 0-11-14-19l-318-1H72q-16 5-16 20zm0-194q0 15 16 20H708q14-10 14-20 0-13-15-20H70q-14 7-14 20z"/></g><g data-mml-node="mi" transform="translate(1055.8,0)"><path data-c="1D44F" d="M73 647q0 10 4 23t12 13q1 0 72 5t73 6q12 0 12-9T212 542q-8-34-17-70t-15-54l-4-19q0-3 6 3 49 40 101 40 62 0 1e2-46t39-116q0-111-79-201T173-11q-50 0-91 38T40 150v9q0 21 8 58T97 414q50 197 50 209t-38 14q-5 0-8 0H96q-10 0-13 0t-7 3-3 7zM336 325v6q0 74-61 74-17 0-35-8t-33-21-26-24-18-22l-6-8-21-86q-22-86-22-122 0-48 24-72 16-16 40-16 33 0 67 32 25 23 40 56t33 105 18 106z"/></g><g data-mml-node="mo" transform="translate(1707,0)"><path data-c="2212" d="M84 237t0 13 14 20H679q15-8 15-20t-15-20H98q-14 7-14 20z"/></g><g data-mml-node="mn" transform="translate(2707.2,0)"><path data-c="37" d="M55 458q1 2 17 109L88 674q0 2 20 2h20v-4q0-10 15-17t52-9 169-2H485V605l-68-93q-9-12-30-40t-27-37-21-32-20-36-14-37-13-46-8-54-6-68-3-82q0-14 0-28t-1-24V19q-4-17-19-29T221-22q-11 0-21 3T179 0 168 40q0 158 97 328 20 32 84 121l46 63H302q-174 0-183-6-6-3-11-24T98 479l-3-21v-3H55v3z"/></g><g data-mml-node="mo" transform="translate(3429.4,0)"><path data-c="D7" d="M630 29q0-20-21-20-5 0-22 16t-94 93L389 222 284 117Q178 13 175 11q-4-2-7-2-8 0-14 6t-7 14q0 7 14 22t94 95L359 250 255 354q-81 81-94 95t-14 22q0 9 6 14t15 5q5 0 7-1 3-2 109-106L389 278 493 382q77 77 94 93t22 16q21 0 21-20 0-7-10-18t-98-98L418 250 522 145q84-84 96-97t12-19z"/></g><g data-mml-node="mfrac" transform="translate(4429.7,0)"><g data-mml-node="mn" transform="translate(220,676)"><path data-c="31" d="M213 578l-13-5q-14-5-40-10t-58-7H83v46h19q47 2 87 15t56 24 28 22q2 3 12 3 9 0 17-6V361l1-3e2q7-7 12-9t24-4 62-2h26V0H416Q395 3 257 3 121 3 1e2.0H88V46h26q22 0 38 0t25 1 16 3 8 2 6 5 6 4V578z"/></g><g data-mml-node="mn" transform="translate(220,-686)"><path data-c="34" d="M462 0Q444 3 333 3 217 3 199 0h-9V46h31q20 0 27 0t17 2 14 5 7 8q1 2 1 54v50H28v46L179 442Q332 674 334 675q2 2 21 2h18l6-6V211h92V165H379V114q0-41 0-48t6-12q8-7 57-8h29V0h-9zM293 211V545L74 212l109-1H293z"/></g><rect width="700" height="60" x="120" y="220"/></g><g data-mml-node="mo" transform="translate(5369.7,0)"><path data-c="28" d="M94 250q0 69 10 131t23 107 37 88 38 67 42 52 33 34 25 21h13 4q14 0 14-9 0-3-17-21t-41-53-49-86-42-138-17-193T184 58 225-81t49-86 42-53 17-21q0-9-15-9h-3-13l-28 24Q180-141 137-14T94 250z"/></g><g data-mml-node="mfrac" transform="translate(5758.7,0)"><g data-mml-node="mrow" transform="translate(220,676)"><g data-mml-node="mn"><path data-c="33" d="M127 463q-27 0-42 17T69 524q0 55 48 98t116 43q35 0 44-1 74-12 113-53t40-89q0-52-34-101t-94-71l-3-2q0-1 9-3t29-9 38-21q82-53 82-140 0-79-62-138T238-22q-80 0-138 43T42 130q0 28 18 45t45 18q28 0 46-18t18-45q0-11-3-20t-7-16-11-12-12-8-10-4-8-3l-4-1q51-45 124-45 55 0 83 53 17 33 17 101v20q0 95-64 127-15 6-61 7l-42 1-3 2q-2 3-2 16 0 18 8 18 28 0 58 5 34 5 62 42t28 112v8q0 57-35 79-22 14-47 14-32 0-59-11t-38-23-11-12h3q3-1 8-2t10-5 12-7 10-11 8-15 3-20q0-22-14-39t-45-18z"/></g><g data-mml-node="mi" transform="translate(500,0)"><path data-c="1D44F" d="M73 647q0 10 4 23t12 13q1 0 72 5t73 6q12 0 12-9T212 542q-8-34-17-70t-15-54l-4-19q0-3 6 3 49 40 101 40 62 0 1e2-46t39-116q0-111-79-201T173-11q-50 0-91 38T40 150v9q0 21 8 58T97 414q50 197 50 209t-38 14q-5 0-8 0H96q-10 0-13 0t-7 3-3 7zM336 325v6q0 74-61 74-17 0-35-8t-33-21-26-24-18-22l-6-8-21-86q-22-86-22-122 0-48 24-72 16-16 40-16 33 0 67 32 25 23 40 56t33 105 18 106z"/></g></g><g data-mml-node="mn" transform="translate(434.5,-686)"><path data-c="37" d="M55 458q1 2 17 109L88 674q0 2 20 2h20v-4q0-10 15-17t52-9 169-2H485V605l-68-93q-9-12-30-40t-27-37-21-32-20-36-14-37-13-46-8-54-6-68-3-82q0-14 0-28t-1-24V19q-4-17-19-29T221-22q-11 0-21 3T179 0 168 40q0 158 97 328 20 32 84 121l46 63H302q-174 0-183-6-6-3-11-24T98 479l-3-21v-3H55v3z"/></g><rect width="1129" height="60" x="120" y="220"/></g><g data-mml-node="mo" transform="translate(7349.9,0)"><path data-c="2B" d="M56 237t0 13 14 20H369V420l1 150q10 13 19 13 13 0 20-15V270H707q15-8 15-20t-15-20H409V-68q-8-14-18-14h-2-2q-12 0-18 14V230H70q-14 7-14 20z"/></g><g data-mml-node="mfrac" transform="translate(8350.1,0)"><g data-mml-node="mi" transform="translate(255.5,676)"><path data-c="1D44F" d="M73 647q0 10 4 23t12 13q1 0 72 5t73 6q12 0 12-9T212 542q-8-34-17-70t-15-54l-4-19q0-3 6 3 49 40 101 40 62 0 1e2-46t39-116q0-111-79-201T173-11q-50 0-91 38T40 150v9q0 21 8 58T97 414q50 197 50 209t-38 14q-5 0-8 0H96q-10 0-13 0t-7 3-3 7zM336 325v6q0 74-61 74-17 0-35-8t-33-21-26-24-18-22l-6-8-21-86q-22-86-22-122 0-48 24-72 16-16 40-16 33 0 67 32 25 23 40 56t33 105 18 106z"/></g><g data-mml-node="mn" transform="translate(220,-686)"><path data-c="37" d="M55 458q1 2 17 109L88 674q0 2 20 2h20v-4q0-10 15-17t52-9 169-2H485V605l-68-93q-9-12-30-40t-27-37-21-32-20-36-14-37-13-46-8-54-6-68-3-82q0-14 0-28t-1-24V19q-4-17-19-29T221-22q-11 0-21 3T179 0 168 40q0 158 97 328 20 32 84 121l46 63H302q-174 0-183-6-6-3-11-24T98 479l-3-21v-3H55v3z"/></g><rect width="700" height="60" x="120" y="220"/></g><g data-mml-node="mo" transform="translate(9290.1,0)"><path data-c="29" d="M60 749l4 1q5 0 10 0H86l28-24q94-85 137-212t43-264q0-68-10-131T261 12 224-76t-38-67-41-51-32-33-23-19q-3-3-4-4H74q-8 0-11 0t-5 3-3 9q1 1 11 13Q221-64 221 250T66 725q-10 12-11 13 0 8 5 11z"/></g></g></g></svg></div><div class=math><svg style="vertical-align:-1.602ex" xmlns="http://www.w3.org/2000/svg" width="21.748ex" height="4.701ex" role="img" focusable="false" viewBox="0 -1370 9612.6 2078"><g stroke="currentcolor" fill="currentcolor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="3D" d="M56 347q0 13 14 20H707q15-8 15-20 0-11-14-19l-318-1H72q-16 5-16 20zm0-194q0 15 16 20H708q14-10 14-20 0-13-15-20H70q-14 7-14 20z"/></g><g data-mml-node="mi" transform="translate(1055.8,0)"><path data-c="1D44F" d="M73 647q0 10 4 23t12 13q1 0 72 5t73 6q12 0 12-9T212 542q-8-34-17-70t-15-54l-4-19q0-3 6 3 49 40 101 40 62 0 1e2-46t39-116q0-111-79-201T173-11q-50 0-91 38T40 150v9q0 21 8 58T97 414q50 197 50 209t-38 14q-5 0-8 0H96q-10 0-13 0t-7 3-3 7zM336 325v6q0 74-61 74-17 0-35-8t-33-21-26-24-18-22l-6-8-21-86q-22-86-22-122 0-48 24-72 16-16 40-16 33 0 67 32 25 23 40 56t33 105 18 106z"/></g><g data-mml-node="mo" transform="translate(1707,0)"><path data-c="2212" d="M84 237t0 13 14 20H679q15-8 15-20t-15-20H98q-14 7-14 20z"/></g><g data-mml-node="mn" transform="translate(2707.2,0)"><path data-c="37" d="M55 458q1 2 17 109L88 674q0 2 20 2h20v-4q0-10 15-17t52-9 169-2H485V605l-68-93q-9-12-30-40t-27-37-21-32-20-36-14-37-13-46-8-54-6-68-3-82q0-14 0-28t-1-24V19q-4-17-19-29T221-22q-11 0-21 3T179 0 168 40q0 158 97 328 20 32 84 121l46 63H302q-174 0-183-6-6-3-11-24T98 479l-3-21v-3H55v3z"/></g><g data-mml-node="mo" transform="translate(3429.4,0)"><path data-c="D7" d="M630 29q0-20-21-20-5 0-22 16t-94 93L389 222 284 117Q178 13 175 11q-4-2-7-2-8 0-14 6t-7 14q0 7 14 22t94 95L359 250 255 354q-81 81-94 95t-14 22q0 9 6 14t15 5q5 0 7-1 3-2 109-106L389 278 493 382q77 77 94 93t22 16q21 0 21-20 0-7-10-18t-98-98L418 250 522 145q84-84 96-97t12-19z"/></g><g data-mml-node="mfrac" transform="translate(4429.7,0)"><g data-mml-node="mn" transform="translate(220,676)"><path data-c="31" d="M213 578l-13-5q-14-5-40-10t-58-7H83v46h19q47 2 87 15t56 24 28 22q2 3 12 3 9 0 17-6V361l1-3e2q7-7 12-9t24-4 62-2h26V0H416Q395 3 257 3 121 3 1e2.0H88V46h26q22 0 38 0t25 1 16 3 8 2 6 5 6 4V578z"/></g><g data-mml-node="mn" transform="translate(220,-686)"><path data-c="34" d="M462 0Q444 3 333 3 217 3 199 0h-9V46h31q20 0 27 0t17 2 14 5 7 8q1 2 1 54v50H28v46L179 442Q332 674 334 675q2 2 21 2h18l6-6V211h92V165H379V114q0-41 0-48t6-12q8-7 57-8h29V0h-9zM293 211V545L74 212l109-1H293z"/></g><rect width="700" height="60" x="120" y="220"/></g><g data-mml-node="mo" transform="translate(5591.9,0)"><path data-c="D7" d="M630 29q0-20-21-20-5 0-22 16t-94 93L389 222 284 117Q178 13 175 11q-4-2-7-2-8 0-14 6t-7 14q0 7 14 22t94 95L359 250 255 354q-81 81-94 95t-14 22q0 9 6 14t15 5q5 0 7-1 3-2 109-106L389 278 493 382q77 77 94 93t22 16q21 0 21-20 0-7-10-18t-98-98L418 250 522 145q84-84 96-97t12-19z"/></g><g data-mml-node="mfrac" transform="translate(6592.1,0)"><g data-mml-node="mrow" transform="translate(220,676)"><g data-mml-node="mn"><path data-c="33" d="M127 463q-27 0-42 17T69 524q0 55 48 98t116 43q35 0 44-1 74-12 113-53t40-89q0-52-34-101t-94-71l-3-2q0-1 9-3t29-9 38-21q82-53 82-140 0-79-62-138T238-22q-80 0-138 43T42 130q0 28 18 45t45 18q28 0 46-18t18-45q0-11-3-20t-7-16-11-12-12-8-10-4-8-3l-4-1q51-45 124-45 55 0 83 53 17 33 17 101v20q0 95-64 127-15 6-61 7l-42 1-3 2q-2 3-2 16 0 18 8 18 28 0 58 5 34 5 62 42t28 112v8q0 57-35 79-22 14-47 14-32 0-59-11t-38-23-11-12h3q3-1 8-2t10-5 12-7 10-11 8-15 3-20q0-22-14-39t-45-18z"/></g><g data-mml-node="mi" transform="translate(500,0)"><path data-c="1D44F" d="M73 647q0 10 4 23t12 13q1 0 72 5t73 6q12 0 12-9T212 542q-8-34-17-70t-15-54l-4-19q0-3 6 3 49 40 101 40 62 0 1e2-46t39-116q0-111-79-201T173-11q-50 0-91 38T40 150v9q0 21 8 58T97 414q50 197 50 209t-38 14q-5 0-8 0H96q-10 0-13 0t-7 3-3 7zM336 325v6q0 74-61 74-17 0-35-8t-33-21-26-24-18-22l-6-8-21-86q-22-86-22-122 0-48 24-72 16-16 40-16 33 0 67 32 25 23 40 56t33 105 18 106z"/></g><g data-mml-node="mo" transform="translate(1151.2,0)"><path data-c="2B" d="M56 237t0 13 14 20H369V420l1 150q10 13 19 13 13 0 20-15V270H707q15-8 15-20t-15-20H409V-68q-8-14-18-14h-2-2q-12 0-18 14V230H70q-14 7-14 20z"/></g><g data-mml-node="mi" transform="translate(2151.4,0)"><path data-c="1D44F" d="M73 647q0 10 4 23t12 13q1 0 72 5t73 6q12 0 12-9T212 542q-8-34-17-70t-15-54l-4-19q0-3 6 3 49 40 101 40 62 0 1e2-46t39-116q0-111-79-201T173-11q-50 0-91 38T40 150v9q0 21 8 58T97 414q50 197 50 209t-38 14q-5 0-8 0H96q-10 0-13 0t-7 3-3 7zM336 325v6q0 74-61 74-17 0-35-8t-33-21-26-24-18-22l-6-8-21-86q-22-86-22-122 0-48 24-72 16-16 40-16 33 0 67 32 25 23 40 56t33 105 18 106z"/></g></g><g data-mml-node="mn" transform="translate(1260.2,-686)"><path data-c="37" d="M55 458q1 2 17 109L88 674q0 2 20 2h20v-4q0-10 15-17t52-9 169-2H485V605l-68-93q-9-12-30-40t-27-37-21-32-20-36-14-37-13-46-8-54-6-68-3-82q0-14 0-28t-1-24V19q-4-17-19-29T221-22q-11 0-21 3T179 0 168 40q0 158 97 328 20 32 84 121l46 63H302q-174 0-183-6-6-3-11-24T98 479l-3-21v-3H55v3z"/></g><rect width="2780.4" height="60" x="120" y="220"/></g></g></g></svg></div><div class=math><svg style="vertical-align:-1.602ex" xmlns="http://www.w3.org/2000/svg" width="18.012ex" height="4.701ex" role="img" focusable="false" viewBox="0 -1370 7961.1 2078"><g stroke="currentcolor" fill="currentcolor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="3D" d="M56 347q0 13 14 20H707q15-8 15-20 0-11-14-19l-318-1H72q-16 5-16 20zm0-194q0 15 16 20H708q14-10 14-20 0-13-15-20H70q-14 7-14 20z"/></g><g data-mml-node="mi" transform="translate(1055.8,0)"><path data-c="1D44F" d="M73 647q0 10 4 23t12 13q1 0 72 5t73 6q12 0 12-9T212 542q-8-34-17-70t-15-54l-4-19q0-3 6 3 49 40 101 40 62 0 1e2-46t39-116q0-111-79-201T173-11q-50 0-91 38T40 150v9q0 21 8 58T97 414q50 197 50 209t-38 14q-5 0-8 0H96q-10 0-13 0t-7 3-3 7zM336 325v6q0 74-61 74-17 0-35-8t-33-21-26-24-18-22l-6-8-21-86q-22-86-22-122 0-48 24-72 16-16 40-16 33 0 67 32 25 23 40 56t33 105 18 106z"/></g><g data-mml-node="mo" transform="translate(1707,0)"><path data-c="2212" d="M84 237t0 13 14 20H679q15-8 15-20t-15-20H98q-14 7-14 20z"/></g><g data-mml-node="mn" transform="translate(2707.2,0)"><path data-c="37" d="M55 458q1 2 17 109L88 674q0 2 20 2h20v-4q0-10 15-17t52-9 169-2H485V605l-68-93q-9-12-30-40t-27-37-21-32-20-36-14-37-13-46-8-54-6-68-3-82q0-14 0-28t-1-24V19q-4-17-19-29T221-22q-11 0-21 3T179 0 168 40q0 158 97 328 20 32 84 121l46 63H302q-174 0-183-6-6-3-11-24T98 479l-3-21v-3H55v3z"/></g><g data-mml-node="mo" transform="translate(3429.4,0)"><path data-c="D7" d="M630 29q0-20-21-20-5 0-22 16t-94 93L389 222 284 117Q178 13 175 11q-4-2-7-2-8 0-14 6t-7 14q0 7 14 22t94 95L359 250 255 354q-81 81-94 95t-14 22q0 9 6 14t15 5q5 0 7-1 3-2 109-106L389 278 493 382q77 77 94 93t22 16q21 0 21-20 0-7-10-18t-98-98L418 250 522 145q84-84 96-97t12-19z"/></g><g data-mml-node="mfrac" transform="translate(4429.7,0)"><g data-mml-node="mn" transform="translate(220,676)"><path data-c="31" d="M213 578l-13-5q-14-5-40-10t-58-7H83v46h19q47 2 87 15t56 24 28 22q2 3 12 3 9 0 17-6V361l1-3e2q7-7 12-9t24-4 62-2h26V0H416Q395 3 257 3 121 3 1e2.0H88V46h26q22 0 38 0t25 1 16 3 8 2 6 5 6 4V578z"/></g><g data-mml-node="mn" transform="translate(220,-686)"><path data-c="34" d="M462 0Q444 3 333 3 217 3 199 0h-9V46h31q20 0 27 0t17 2 14 5 7 8q1 2 1 54v50H28v46L179 442Q332 674 334 675q2 2 21 2h18l6-6V211h92V165H379V114q0-41 0-48t6-12q8-7 57-8h29V0h-9zM293 211V545L74 212l109-1H293z"/></g><rect width="700" height="60" x="120" y="220"/></g><g data-mml-node="mo" transform="translate(5591.9,0)"><path data-c="D7" d="M630 29q0-20-21-20-5 0-22 16t-94 93L389 222 284 117Q178 13 175 11q-4-2-7-2-8 0-14 6t-7 14q0 7 14 22t94 95L359 250 255 354q-81 81-94 95t-14 22q0 9 6 14t15 5q5 0 7-1 3-2 109-106L389 278 493 382q77 77 94 93t22 16q21 0 21-20 0-7-10-18t-98-98L418 250 522 145q84-84 96-97t12-19z"/></g><g data-mml-node="mfrac" transform="translate(6592.1,0)"><g data-mml-node="mrow" transform="translate(220,676)"><g data-mml-node="mn"><path data-c="34" d="M462 0Q444 3 333 3 217 3 199 0h-9V46h31q20 0 27 0t17 2 14 5 7 8q1 2 1 54v50H28v46L179 442Q332 674 334 675q2 2 21 2h18l6-6V211h92V165H379V114q0-41 0-48t6-12q8-7 57-8h29V0h-9zM293 211V545L74 212l109-1H293z"/></g><g data-mml-node="mi" transform="translate(500,0)"><path data-c="1D44F" d="M73 647q0 10 4 23t12 13q1 0 72 5t73 6q12 0 12-9T212 542q-8-34-17-70t-15-54l-4-19q0-3 6 3 49 40 101 40 62 0 1e2-46t39-116q0-111-79-201T173-11q-50 0-91 38T40 150v9q0 21 8 58T97 414q50 197 50 209t-38 14q-5 0-8 0H96q-10 0-13 0t-7 3-3 7zM336 325v6q0 74-61 74-17 0-35-8t-33-21-26-24-18-22l-6-8-21-86q-22-86-22-122 0-48 24-72 16-16 40-16 33 0 67 32 25 23 40 56t33 105 18 106z"/></g></g><g data-mml-node="mn" transform="translate(434.5,-686)"><path data-c="37" d="M55 458q1 2 17 109L88 674q0 2 20 2h20v-4q0-10 15-17t52-9 169-2H485V605l-68-93q-9-12-30-40t-27-37-21-32-20-36-14-37-13-46-8-54-6-68-3-82q0-14 0-28t-1-24V19q-4-17-19-29T221-22q-11 0-21 3T179 0 168 40q0 158 97 328 20 32 84 121l46 63H302q-174 0-183-6-6-3-11-24T98 479l-3-21v-3H55v3z"/></g><rect width="1129" height="60" x="120" y="220"/></g></g></g></svg></div><p>We can cancel the 4s in the numerator since they were results of the shift operations.</p><div class=math><svg style="vertical-align:-1.602ex" xmlns="http://www.w3.org/2000/svg" width="12.149ex" height="4.701ex" role="img" focusable="false" viewBox="0 -1370 5369.7 2078"><g stroke="currentcolor" fill="currentcolor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="3D" d="M56 347q0 13 14 20H707q15-8 15-20 0-11-14-19l-318-1H72q-16 5-16 20zm0-194q0 15 16 20H708q14-10 14-20 0-13-15-20H70q-14 7-14 20z"/></g><g data-mml-node="mi" transform="translate(1055.8,0)"><path data-c="1D44F" d="M73 647q0 10 4 23t12 13q1 0 72 5t73 6q12 0 12-9T212 542q-8-34-17-70t-15-54l-4-19q0-3 6 3 49 40 101 40 62 0 1e2-46t39-116q0-111-79-201T173-11q-50 0-91 38T40 150v9q0 21 8 58T97 414q50 197 50 209t-38 14q-5 0-8 0H96q-10 0-13 0t-7 3-3 7zM336 325v6q0 74-61 74-17 0-35-8t-33-21-26-24-18-22l-6-8-21-86q-22-86-22-122 0-48 24-72 16-16 40-16 33 0 67 32 25 23 40 56t33 105 18 106z"/></g><g data-mml-node="mo" transform="translate(1707,0)"><path data-c="2212" d="M84 237t0 13 14 20H679q15-8 15-20t-15-20H98q-14 7-14 20z"/></g><g data-mml-node="mn" transform="translate(2707.2,0)"><path data-c="37" d="M55 458q1 2 17 109L88 674q0 2 20 2h20v-4q0-10 15-17t52-9 169-2H485V605l-68-93q-9-12-30-40t-27-37-21-32-20-36-14-37-13-46-8-54-6-68-3-82q0-14 0-28t-1-24V19q-4-17-19-29T221-22q-11 0-21 3T179 0 168 40q0 158 97 328 20 32 84 121l46 63H302q-174 0-183-6-6-3-11-24T98 479l-3-21v-3H55v3z"/></g><g data-mml-node="mo" transform="translate(3429.4,0)"><path data-c="D7" d="M630 29q0-20-21-20-5 0-22 16t-94 93L389 222 284 117Q178 13 175 11q-4-2-7-2-8 0-14 6t-7 14q0 7 14 22t94 95L359 250 255 354q-81 81-94 95t-14 22q0 9 6 14t15 5q5 0 7-1 3-2 109-106L389 278 493 382q77 77 94 93t22 16q21 0 21-20 0-7-10-18t-98-98L418 250 522 145q84-84 96-97t12-19z"/></g><g data-mml-node="mfrac" transform="translate(4429.7,0)"><g data-mml-node="mi" transform="translate(255.5,676)"><path data-c="1D44F" d="M73 647q0 10 4 23t12 13q1 0 72 5t73 6q12 0 12-9T212 542q-8-34-17-70t-15-54l-4-19q0-3 6 3 49 40 101 40 62 0 1e2-46t39-116q0-111-79-201T173-11q-50 0-91 38T40 150v9q0 21 8 58T97 414q50 197 50 209t-38 14q-5 0-8 0H96q-10 0-13 0t-7 3-3 7zM336 325v6q0 74-61 74-17 0-35-8t-33-21-26-24-18-22l-6-8-21-86q-22-86-22-122 0-48 24-72 16-16 40-16 33 0 67 32 25 23 40 56t33 105 18 106z"/></g><g data-mml-node="mn" transform="translate(220,-686)"><path data-c="37" d="M55 458q1 2 17 109L88 674q0 2 20 2h20v-4q0-10 15-17t52-9 169-2H485V605l-68-93q-9-12-30-40t-27-37-21-32-20-36-14-37-13-46-8-54-6-68-3-82q0-14 0-28t-1-24V19q-4-17-19-29T221-22q-11 0-21 3T179 0 168 40q0 158 97 328 20 32 84 121l46 63H302q-174 0-183-6-6-3-11-24T98 479l-3-21v-3H55v3z"/></g><rect width="700" height="60" x="120" y="220"/></g></g></g></svg></div><p>However, we cannot cancel out the 7s since they were part of the C division.
Remember, the divison operation in C results in the truncated integer quotient, not a floating point number.
This means</p><div class=math><svg style="vertical-align:-1.602ex" xmlns="http://www.w3.org/2000/svg" width="6.024ex" height="4.701ex" role="img" focusable="false" viewBox="0 -1370 2662.4 2078"><g stroke="currentcolor" fill="currentcolor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mn"><path data-c="37" d="M55 458q1 2 17 109L88 674q0 2 20 2h20v-4q0-10 15-17t52-9 169-2H485V605l-68-93q-9-12-30-40t-27-37-21-32-20-36-14-37-13-46-8-54-6-68-3-82q0-14 0-28t-1-24V19q-4-17-19-29T221-22q-11 0-21 3T179 0 168 40q0 158 97 328 20 32 84 121l46 63H302q-174 0-183-6-6-3-11-24T98 479l-3-21v-3H55v3z"/></g><g data-mml-node="mo" transform="translate(722.2,0)"><path data-c="D7" d="M630 29q0-20-21-20-5 0-22 16t-94 93L389 222 284 117Q178 13 175 11q-4-2-7-2-8 0-14 6t-7 14q0 7 14 22t94 95L359 250 255 354q-81 81-94 95t-14 22q0 9 6 14t15 5q5 0 7-1 3-2 109-106L389 278 493 382q77 77 94 93t22 16q21 0 21-20 0-7-10-18t-98-98L418 250 522 145q84-84 96-97t12-19z"/></g><g data-mml-node="mfrac" transform="translate(1722.4,0)"><g data-mml-node="mi" transform="translate(255.5,676)"><path data-c="1D44F" d="M73 647q0 10 4 23t12 13q1 0 72 5t73 6q12 0 12-9T212 542q-8-34-17-70t-15-54l-4-19q0-3 6 3 49 40 101 40 62 0 1e2-46t39-116q0-111-79-201T173-11q-50 0-91 38T40 150v9q0 21 8 58T97 414q50 197 50 209t-38 14q-5 0-8 0H96q-10 0-13 0t-7 3-3 7zM336 325v6q0 74-61 74-17 0-35-8t-33-21-26-24-18-22l-6-8-21-86q-22-86-22-122 0-48 24-72 16-16 40-16 33 0 67 32 25 23 40 56t33 105 18 106z"/></g><g data-mml-node="mn" transform="translate(220,-686)"><path data-c="37" d="M55 458q1 2 17 109L88 674q0 2 20 2h20v-4q0-10 15-17t52-9 169-2H485V605l-68-93q-9-12-30-40t-27-37-21-32-20-36-14-37-13-46-8-54-6-68-3-82q0-14 0-28t-1-24V19q-4-17-19-29T221-22q-11 0-21 3T179 0 168 40q0 158 97 328 20 32 84 121l46 63H302q-174 0-183-6-6-3-11-24T98 479l-3-21v-3H55v3z"/></g><rect width="700" height="60" x="120" y="220"/></g></g></g></svg></div><p>here gives us the largest multiple of 7 below <code>b</code>.</p><p>Another way to think of it is the part of <code>b</code> that is divisible by 7, leaving out the remainder.</p><p>When we subtract this from the original number, we get what was left out, the remainder itself!</p><p>The entire condition simplifies to:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C data-lang=C><span style=display:flex><span>b <span style=color:#f92672>%</span> <span style=color:#ae81ff>7</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>3</span>
</span></span></code></pre></div><p>This will be another constraint for the <code>bear</code> number.</p><h3 id=process_volcano><code>process_volcano</code></h3><p>The decompilation after renames and cleanups looks like the following:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C data-lang=C><span style=display:flex><span><span style=color:#66d9ef>bool</span> <span style=color:#a6e22e>process_volcano</span>(<span style=color:#66d9ef>uint64_t</span> v) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>uint64_t</span> total_bits <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>uint64_t</span> i <span style=color:#f92672>=</span> v; i <span style=color:#f92672>!=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>=</span> i <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>1</span>) {
</span></span><span style=display:flex><span>    total_bits <span style=color:#f92672>=</span> total_bits <span style=color:#f92672>+</span> (i <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (total_bits <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0x11</span>) <span style=color:#f92672>&amp;&amp;</span> (total_bits <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0x1b</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> true;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> false;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Here the program loops over the bits in the number supplied and counts the ones that are high.
The function only returns a true value when the total number of high bits is between 17 (0x11, inclusive) and 27 (0x1b, exclusive).</p><p>This is a constraint for the <code>volcano</code> number.</p><h3 id=check_proof><code>check_proof</code></h3><p>As usual, I have cleaned some of the code, renamed a bunch of variables for them to make sense.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C data-lang=C><span style=display:flex><span><span style=color:#66d9ef>uint64_t</span> <span style=color:#a6e22e>check_proof</span>(<span style=color:#66d9ef>uint64_t</span> leet, <span style=color:#66d9ef>uint64_t</span> v, <span style=color:#66d9ef>uint64_t</span> proof) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>uint64_t</span> ret <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>, mod <span style=color:#f92672>=</span> leet <span style=color:#f92672>%</span> proof;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>uint64_t</span> i <span style=color:#f92672>=</span> v; i <span style=color:#f92672>!=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>=</span> i <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>1</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (i <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>1</span>) {
</span></span><span style=display:flex><span>      ret <span style=color:#f92672>=</span> (ret <span style=color:#f92672>*</span> mod) <span style=color:#f92672>%</span> proof;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    mod <span style=color:#f92672>=</span> (mod <span style=color:#f92672>*</span> mod) <span style=color:#f92672>%</span> proof;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> ret;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>This function begins by defining a return variable as 1 and another variable <code>mod</code> as result of the <code>leet</code> modulo the proof value. I have renamed this
variable leet since 0x1337 is the only number supplied as the argument throughout the program.</p><p>It then loops over the bits of the argument <code>v</code>. If a given bit is high, the return value gets assigned itself multiplied by the <code>mod</code>, modulo the proof value.
Otherwise, the <code>mod</code> variable gets assigned itself squared, modulo the proof.</p><p>Recall that the result of this function must be equal for both the <code>volcano</code> and the <code>bear</code> number.</p><p>How do we make sure that the results are equal if there is so much of pseudo-randomness involved?</p><p>Our best option is to somehow have the <code>mod</code> variable as 1 since anything times 1 is itself.
The return value in such a case is bound to its initial value of 1 for any non-zero proof value.</p><p>For this to happen, <code>leet % proof</code> must be equal to 1. Noting that 0x1337 (4919) is the only value passed as leet,
we have the constraint</p><div class=math><svg style="vertical-align:-.566ex" xmlns="http://www.w3.org/2000/svg" width="26.016ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 11499.2 1e3"><g stroke="currentcolor" fill="currentcolor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mn"><path data-c="30" d="M96 585q56 81 153 81 48 0 96-26t78-92q37-83 37-228 0-155-43-237-20-42-55-67T301-15t-51-7q-26 0-52 6T137 16 82 83Q39 165 39 320q0 174 57 265zm225 12q-30 32-71 32-42 0-72-32-25-26-33-72t-8-192q0-158 8-208t36-79q28-30 69-30 40 0 68 30 29 30 36 84t8 203q0 145-8 191t-33 73z"/></g><g data-mml-node="mtext" transform="translate(500,0)"><path data-c="1D6A1" d="M35 393q0 24 11 31t43 8q6 0 23 0t29-1h82q15-9 18-16t3-22q0-4 0-10t-7-16-21-12q-7 0-7-1l25-35q25-33 26-33l48 68q0 1-7 1-16 1-23 10t-8 19l1 9q0 27 18 35 6 3 87 3h83q1-1 6-4t7-5 4-6 4-9 1-14q0-25-11-31t-36-7h-9-33l-48-65q-49-65-49-67-1 0 14-20t41-54l55-72 34-1h14q21 0 31-7t11-31q0-28-22-37H303q-22 8-22 31v6q0 11 1 16t8 13 23 9q11 0 11 1l-65 96-62-96q5-1 12-1 16-1 24-8t8-13 1-17q0-10 0-14t-6-12T221 1H51Q29 9 29 32v6q0 10 0 13t2 8 7 8 13 9h66l54 73q53 73 53 74L124 355H90 78q-24 0-33 6T35 393z"/></g><g data-mml-node="mn" transform="translate(1025,0)"><path data-c="31" d="M213 578l-13-5q-14-5-40-10t-58-7H83v46h19q47 2 87 15t56 24 28 22q2 3 12 3 9 0 17-6V361l1-3e2q7-7 12-9t24-4 62-2h26V0H416Q395 3 257 3 121 3 1e2.0H88V46h26q22 0 38 0t25 1 16 3 8 2 6 5 6 4V578z"/><path data-c="33" d="M127 463q-27 0-42 17T69 524q0 55 48 98t116 43q35 0 44-1 74-12 113-53t40-89q0-52-34-101t-94-71l-3-2q0-1 9-3t29-9 38-21q82-53 82-140 0-79-62-138T238-22q-80 0-138 43T42 130q0 28 18 45t45 18q28 0 46-18t18-45q0-11-3-20t-7-16-11-12-12-8-10-4-8-3l-4-1q51-45 124-45 55 0 83 53 17 33 17 101v20q0 95-64 127-15 6-61 7l-42 1-3 2q-2 3-2 16 0 18 8 18 28 0 58 5 34 5 62 42t28 112v8q0 57-35 79-22 14-47 14-32 0-59-11t-38-23-11-12h3q3-1 8-2t10-5 12-7 10-11 8-15 3-20q0-22-14-39t-45-18z" transform="translate(500,0)"/><path data-c="33" d="M127 463q-27 0-42 17T69 524q0 55 48 98t116 43q35 0 44-1 74-12 113-53t40-89q0-52-34-101t-94-71l-3-2q0-1 9-3t29-9 38-21q82-53 82-140 0-79-62-138T238-22q-80 0-138 43T42 130q0 28 18 45t45 18q28 0 46-18t18-45q0-11-3-20t-7-16-11-12-12-8-10-4-8-3l-4-1q51-45 124-45 55 0 83 53 17 33 17 101v20q0 95-64 127-15 6-61 7l-42 1-3 2q-2 3-2 16 0 18 8 18 28 0 58 5 34 5 62 42t28 112v8q0 57-35 79-22 14-47 14-32 0-59-11t-38-23-11-12h3q3-1 8-2t10-5 12-7 10-11 8-15 3-20q0-22-14-39t-45-18z" transform="translate(1000,0)"/><path data-c="37" d="M55 458q1 2 17 109L88 674q0 2 20 2h20v-4q0-10 15-17t52-9 169-2H485V605l-68-93q-9-12-30-40t-27-37-21-32-20-36-14-37-13-46-8-54-6-68-3-82q0-14 0-28t-1-24V19q-4-17-19-29T221-22q-11 0-21 3T179 0 168 40q0 158 97 328 20 32 84 121l46 63H302q-174 0-183-6-6-3-11-24T98 479l-3-21v-3H55v3z" transform="translate(1500,0)"/></g><g data-mml-node="mo" transform="translate(3302.8,0)"><path data-c="2261" d="M56 444q0 13 14 20H707q15-8 15-20 0-14-16-20H72q-16 5-16 20zm0-207t0 13 14 20H707q15-8 15-20t-15-20H70q-14 7-14 20zM56 56q0 15 16 20H706q16-6 16-20 0-12-15-20H70Q56 43 56 56z"/></g><g data-mml-node="mn" transform="translate(4358.6,0)"><path data-c="31" d="M213 578l-13-5q-14-5-40-10t-58-7H83v46h19q47 2 87 15t56 24 28 22q2 3 12 3 9 0 17-6V361l1-3e2q7-7 12-9t24-4 62-2h26V0H416Q395 3 257 3 121 3 1e2.0H88V46h26q22 0 38 0t25 1 16 3 8 2 6 5 6 4V578z"/></g><g data-mml-node="mspace" transform="translate(4858.6,0)"/><g data-mml-node="mo" transform="translate(5858.6,0)"><path data-c="28" d="M94 250q0 69 10 131t23 107 37 88 38 67 42 52 33 34 25 21h13 4q14 0 14-9 0-3-17-21t-41-53-49-86-42-138-17-193T184 58 225-81t49-86 42-53 17-21q0-9-15-9h-3-13l-28 24Q180-141 137-14T94 250z"/></g><g data-mml-node="mi" transform="translate(6247.6,0)"><path data-c="6D" d="M41 46H55q39 0 47 14v8q0 9 0 23t0 31 1 39 0 42q0 31 0 66t-1 59v23q-3 19-14 25t-45 9H25v23q0 23 2 23l10 1q10 1 28 2t37 2q17 1 36 2t29 3 11 1h3V402q0-38 1-38t5 5 12 15 19 18 29 19 38 16 51 5q15 0 28-2t23-6 19-8 15-9 11-11 9-11 7-11 4-10 3-8l2-5 3 4q3 4 6 8t9 11 13 13 15 13 20 12 23 10 26 7 31 3q126 0 137-113 1-7 1-139V104q0-38 2-45t11-10q21-3 49-3h16V0h-8L788 1q-24 1-51 1T699 3Q596 3 587 0h-8V46h16q61 0 61 16 1 2 1 138-1 135-2 143-6 28-20 42t-24 17-26 2q-45 0-79-34-27-27-34-55t-8-83V168 108q0-30 1-40t3-13 9-6q21-3 49-3h16V0h-8L510 1q-23 1-50 1T422 3Q319 3 310 0h-8V46h16q61 0 61 16 1 2 1 138-1 135-2 143-6 28-20 42t-24 17-26 2q-45 0-79-34-27-27-34-55t-8-83V168 108q0-30 1-40t3-13 9-6q21-3 49-3h16V0h-8L234 1q-24 1-51 1T145 3Q42 3 33 0H25V46H41z"/><path data-c="6F" d="M28 214q0 95 65 164t157 70q90 0 155-68t66-165q0-95-64-160T250-10Q153-10 91 57T28 214zM250 30q122 0 122 163v32 25q0 22-1 38t-7 38-16 36-31 28-49 20q-5 1-16 1-30 0-57-12-43-22-56-61t-13-92V226q0-96 19-135 32-61 105-61z" transform="translate(833,0)"/><path data-c="64" d="M376 495q0 16 0 40t1 33q0 45-10 56t-51 13H298v23q0 23 2 23l10 1q10 1 29 2t37 2q17 1 37 2t30 3 11 1h3V390q0-306 1-309 3-20 14-26t45-9h18V0q-2 0-76-5t-79-6h-7V44l-8-7Q307-11 235-11 158-11 96 50T34 215q0 1e2 63 163t147 64q75 0 132-49V495zm-3-153q-45 63-113 63-49 0-87-36-27-28-34-64t-8-94q0-56 7-91t35-61q30-33 78-33 71 0 122 77V342z" transform="translate(1333,0)"/></g><g data-mml-node="mspace" transform="translate(8136.6,0)"/><g data-mml-node="mi" transform="translate(8636.2,0)"><path data-c="1D45D" d="M23 287q1 3 2 8t5 22 10 31 15 33 20 30 26 22 33 9q75 0 96-64l10 9q62 55 118 55 65 0 102-47t37-114q0-108-76-199T249-10q-22 0-39 6-11 5-23 15T168 28l-7 8q-1-1-22-87t-21-87q0-6 8-7t37-3h25q6-7 6-9t-3-18q-3-12-6-15t-13-4q-2 0-11 0t-34 1-62 1q-70 0-89-2h-8q-7 7-7 11 2 27 13 35H-6q34 1 39 12 3 6 61 239t61 247q1 5 1 14 0 41-25 41-22 0-37-28T71 316 59 280q-2-2-16-2H29q-6 6-6 9zM178 102q22-76 74-76 30 0 58 23t46 58q18 34 36 108t19 110v6q0 74-61 74-11 0-22-3t-22-9-20-13-17-15-15-15-11-14-8-10l-3-4q0-1-3-14t-11-44-14-52q-26-106-26-110z"/></g><g data-mml-node="mi" transform="translate(9139.2,0)"><path data-c="1D45F" d="M21 287q1 3 2 8t5 22 10 31 15 33 20 30 26 22 33 9q29 0 51-12t31-22 11-20q2-6 3-6t8 7q48 52 111 52h3q48 0 72-41 8-19 8-37 0-30-13-48t-26-23-25-4q-20 0-32 11t-12 29q0 48 56 64-22 13-36 13-56 0-103-74-10-16-15-33T190 165Q156 25 151 16q-13-27-43-27-13 0-21 6T76 7 74 17q0 13 40 172t40 177q0 39-26 39-21 0-36-28T68 316 57 280q-2-2-16-2H27q-6 6-6 9z"/></g><g data-mml-node="mi" transform="translate(9590.2,0)"><path data-c="1D45C" d="M201-11Q126-11 80 38T34 156q0 65 30 123t82 101q76 61 155 61 32 0 40-1 13-3 26-7t35-16 36-30 26-49 12-70q0-107-86-193T201-11zM121 120q0-50 26-72t59-22q44 0 83 32t62 84q9 21 23 74t14 92q0 44-18 67-24 30-64 30-63 0-111-58-37-44-55-117T121 120z"/></g><g data-mml-node="mi" transform="translate(10075.2,0)"><path data-c="1D45C" d="M201-11Q126-11 80 38T34 156q0 65 30 123t82 101q76 61 155 61 32 0 40-1 13-3 26-7t35-16 36-30 26-49 12-70q0-107-86-193T201-11zM121 120q0-50 26-72t59-22q44 0 83 32t62 84q9 21 23 74t14 92q0 44-18 67-24 30-64 30-63 0-111-58-37-44-55-117T121 120z"/></g><g data-mml-node="mi" transform="translate(10560.2,0)"><path data-c="1D453" d="M118-162q2 0 6-2t11-3 12-1q13 0 24 13t16 29q10 27 34 153t46 240 22 115v3H242q-47 0-50 2-4 3-4 10l7 28q2 5 8 5t47 1q48 0 48 1 0 2 9 50t12 58q37 165 146 165 37-2 61-22t24-53q0-36-21-52t-42-17q-44 0-44 42 0 19 11 33t24 21l9 5q-16 6-30 6-12 0-23-10t-15-28q-7-29-16-78t-16-83-7-36 55-2q45 0 52-1t11-6q1-4-2-17t-5-16q-2-5-9-5t-54-1H372L349 263Q301 15 282-47q-27-85-70-126-37-32-73-32-32 0-58 19T55-132q0 37 21 54t42 17q44 0 44-42 0-19-11-33t-24-21l-9-5z"/></g><g data-mml-node="mo" transform="translate(11110.2,0)"><path data-c="29" d="M60 749l4 1q5 0 10 0H86l28-24q94-85 137-212t43-264q0-68-10-131T261 12 224-76t-38-67-41-51-32-33-23-19q-3-3-4-4H74q-8 0-11 0t-5 3-3 9q1 1 11 13Q221-64 221 250T66 725q-10 12-11 13 0 8 5 11z"/></g></g></g></svg></div><p>The congruence can be rewritten as:</p><div class=math><svg style="vertical-align:-.566ex" xmlns="http://www.w3.org/2000/svg" width="23.697ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 10474.2 1e3"><g stroke="currentcolor" fill="currentcolor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mn"><path data-c="34" d="M462 0Q444 3 333 3 217 3 199 0h-9V46h31q20 0 27 0t17 2 14 5 7 8q1 2 1 54v50H28v46L179 442Q332 674 334 675q2 2 21 2h18l6-6V211h92V165H379V114q0-41 0-48t6-12q8-7 57-8h29V0h-9zM293 211V545L74 212l109-1H293z"/><path data-c="39" d="M352 287q-48-76-120-76-78 0-128 59T44 396q-2 16-2 40v8q0 93 69 162 60 60 132 60 2 0 6 0t8-1h4q12 0 25-2t37-12 47-32 43-59q43-88 43-226 0-140-60-237-35-56-84-87T208-22Q147-22 108 7T68 93t53 56q22 0 37-14t15-39q0-18-9-31T148 49t-13-5l-4-1q0-2 7-6t26-10 42-5h6q60 0 101 64 39 56 39 194v7zM244 248q48 0 77 49t30 133q0 78-8 112-2 10-6 20t-14 26-30 27-47 10q-38 0-65-27-21-22-27-52t-7-105q0-83 5-112t20-47q25-34 72-34z" transform="translate(500,0)"/><path data-c="31" d="M213 578l-13-5q-14-5-40-10t-58-7H83v46h19q47 2 87 15t56 24 28 22q2 3 12 3 9 0 17-6V361l1-3e2q7-7 12-9t24-4 62-2h26V0H416Q395 3 257 3 121 3 1e2.0H88V46h26q22 0 38 0t25 1 16 3 8 2 6 5 6 4V578z" transform="translate(1000,0)"/><path data-c="39" d="M352 287q-48-76-120-76-78 0-128 59T44 396q-2 16-2 40v8q0 93 69 162 60 60 132 60 2 0 6 0t8-1h4q12 0 25-2t37-12 47-32 43-59q43-88 43-226 0-140-60-237-35-56-84-87T208-22Q147-22 108 7T68 93t53 56q22 0 37-14t15-39q0-18-9-31T148 49t-13-5l-4-1q0-2 7-6t26-10 42-5h6q60 0 101 64 39 56 39 194v7zM244 248q48 0 77 49t30 133q0 78-8 112-2 10-6 20t-14 26-30 27-47 10q-38 0-65-27-21-22-27-52t-7-105q0-83 5-112t20-47q25-34 72-34z" transform="translate(1500,0)"/></g><g data-mml-node="mo" transform="translate(2277.8,0)"><path data-c="2261" d="M56 444q0 13 14 20H707q15-8 15-20 0-14-16-20H72q-16 5-16 20zm0-207t0 13 14 20H707q15-8 15-20t-15-20H70q-14 7-14 20zM56 56q0 15 16 20H706q16-6 16-20 0-12-15-20H70Q56 43 56 56z"/></g><g data-mml-node="mn" transform="translate(3333.6,0)"><path data-c="31" d="M213 578l-13-5q-14-5-40-10t-58-7H83v46h19q47 2 87 15t56 24 28 22q2 3 12 3 9 0 17-6V361l1-3e2q7-7 12-9t24-4 62-2h26V0H416Q395 3 257 3 121 3 1e2.0H88V46h26q22 0 38 0t25 1 16 3 8 2 6 5 6 4V578z"/></g><g data-mml-node="mspace" transform="translate(3833.6,0)"/><g data-mml-node="mo" transform="translate(4833.6,0)"><path data-c="28" d="M94 250q0 69 10 131t23 107 37 88 38 67 42 52 33 34 25 21h13 4q14 0 14-9 0-3-17-21t-41-53-49-86-42-138-17-193T184 58 225-81t49-86 42-53 17-21q0-9-15-9h-3-13l-28 24Q180-141 137-14T94 250z"/></g><g data-mml-node="mi" transform="translate(5222.6,0)"><path data-c="6D" d="M41 46H55q39 0 47 14v8q0 9 0 23t0 31 1 39 0 42q0 31 0 66t-1 59v23q-3 19-14 25t-45 9H25v23q0 23 2 23l10 1q10 1 28 2t37 2q17 1 36 2t29 3 11 1h3V402q0-38 1-38t5 5 12 15 19 18 29 19 38 16 51 5q15 0 28-2t23-6 19-8 15-9 11-11 9-11 7-11 4-10 3-8l2-5 3 4q3 4 6 8t9 11 13 13 15 13 20 12 23 10 26 7 31 3q126 0 137-113 1-7 1-139V104q0-38 2-45t11-10q21-3 49-3h16V0h-8L788 1q-24 1-51 1T699 3Q596 3 587 0h-8V46h16q61 0 61 16 1 2 1 138-1 135-2 143-6 28-20 42t-24 17-26 2q-45 0-79-34-27-27-34-55t-8-83V168 108q0-30 1-40t3-13 9-6q21-3 49-3h16V0h-8L510 1q-23 1-50 1T422 3Q319 3 310 0h-8V46h16q61 0 61 16 1 2 1 138-1 135-2 143-6 28-20 42t-24 17-26 2q-45 0-79-34-27-27-34-55t-8-83V168 108q0-30 1-40t3-13 9-6q21-3 49-3h16V0h-8L234 1q-24 1-51 1T145 3Q42 3 33 0H25V46H41z"/><path data-c="6F" d="M28 214q0 95 65 164t157 70q90 0 155-68t66-165q0-95-64-160T250-10Q153-10 91 57T28 214zM250 30q122 0 122 163v32 25q0 22-1 38t-7 38-16 36-31 28-49 20q-5 1-16 1-30 0-57-12-43-22-56-61t-13-92V226q0-96 19-135 32-61 105-61z" transform="translate(833,0)"/><path data-c="64" d="M376 495q0 16 0 40t1 33q0 45-10 56t-51 13H298v23q0 23 2 23l10 1q10 1 29 2t37 2q17 1 37 2t30 3 11 1h3V390q0-306 1-309 3-20 14-26t45-9h18V0q-2 0-76-5t-79-6h-7V44l-8-7Q307-11 235-11 158-11 96 50T34 215q0 1e2 63 163t147 64q75 0 132-49V495zm-3-153q-45 63-113 63-49 0-87-36-27-28-34-64t-8-94q0-56 7-91t35-61q30-33 78-33 71 0 122 77V342z" transform="translate(1333,0)"/></g><g data-mml-node="mspace" transform="translate(7111.6,0)"/><g data-mml-node="mi" transform="translate(7611.2,0)"><path data-c="1D45D" d="M23 287q1 3 2 8t5 22 10 31 15 33 20 30 26 22 33 9q75 0 96-64l10 9q62 55 118 55 65 0 102-47t37-114q0-108-76-199T249-10q-22 0-39 6-11 5-23 15T168 28l-7 8q-1-1-22-87t-21-87q0-6 8-7t37-3h25q6-7 6-9t-3-18q-3-12-6-15t-13-4q-2 0-11 0t-34 1-62 1q-70 0-89-2h-8q-7 7-7 11 2 27 13 35H-6q34 1 39 12 3 6 61 239t61 247q1 5 1 14 0 41-25 41-22 0-37-28T71 316 59 280q-2-2-16-2H29q-6 6-6 9zM178 102q22-76 74-76 30 0 58 23t46 58q18 34 36 108t19 110v6q0 74-61 74-11 0-22-3t-22-9-20-13-17-15-15-15-11-14-8-10l-3-4q0-1-3-14t-11-44-14-52q-26-106-26-110z"/></g><g data-mml-node="mi" transform="translate(8114.2,0)"><path data-c="1D45F" d="M21 287q1 3 2 8t5 22 10 31 15 33 20 30 26 22 33 9q29 0 51-12t31-22 11-20q2-6 3-6t8 7q48 52 111 52h3q48 0 72-41 8-19 8-37 0-30-13-48t-26-23-25-4q-20 0-32 11t-12 29q0 48 56 64-22 13-36 13-56 0-103-74-10-16-15-33T190 165Q156 25 151 16q-13-27-43-27-13 0-21 6T76 7 74 17q0 13 40 172t40 177q0 39-26 39-21 0-36-28T68 316 57 280q-2-2-16-2H27q-6 6-6 9z"/></g><g data-mml-node="mi" transform="translate(8565.2,0)"><path data-c="1D45C" d="M201-11Q126-11 80 38T34 156q0 65 30 123t82 101q76 61 155 61 32 0 40-1 13-3 26-7t35-16 36-30 26-49 12-70q0-107-86-193T201-11zM121 120q0-50 26-72t59-22q44 0 83 32t62 84q9 21 23 74t14 92q0 44-18 67-24 30-64 30-63 0-111-58-37-44-55-117T121 120z"/></g><g data-mml-node="mi" transform="translate(9050.2,0)"><path data-c="1D45C" d="M201-11Q126-11 80 38T34 156q0 65 30 123t82 101q76 61 155 61 32 0 40-1 13-3 26-7t35-16 36-30 26-49 12-70q0-107-86-193T201-11zM121 120q0-50 26-72t59-22q44 0 83 32t62 84q9 21 23 74t14 92q0 44-18 67-24 30-64 30-63 0-111-58-37-44-55-117T121 120z"/></g><g data-mml-node="mi" transform="translate(9535.2,0)"><path data-c="1D453" d="M118-162q2 0 6-2t11-3 12-1q13 0 24 13t16 29q10 27 34 153t46 240 22 115v3H242q-47 0-50 2-4 3-4 10l7 28q2 5 8 5t47 1q48 0 48 1 0 2 9 50t12 58q37 165 146 165 37-2 61-22t24-53q0-36-21-52t-42-17q-44 0-44 42 0 19 11 33t24 21l9 5q-16 6-30 6-12 0-23-10t-15-28q-7-29-16-78t-16-83-7-36 55-2q45 0 52-1t11-6q1-4-2-17t-5-16q-2-5-9-5t-54-1H372L349 263Q301 15 282-47q-27-85-70-126-37-32-73-32-32 0-58 19T55-132q0 37 21 54t42 17q44 0 44-42 0-19-11-33t-24-21l-9-5z"/></g><g data-mml-node="mo" transform="translate(10085.2,0)"><path data-c="29" d="M60 749l4 1q5 0 10 0H86l28-24q94-85 137-212t43-264q0-68-10-131T261 12 224-76t-38-67-41-51-32-33-23-19q-3-3-4-4H74q-8 0-11 0t-5 3-3 9q1 1 11 13Q221-64 221 250T66 725q-10 12-11 13 0 8 5 11z"/></g></g></g></svg></div><div class=math><svg style="vertical-align:-.566ex" xmlns="http://www.w3.org/2000/svg" width="33.187ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 14668.4 1e3"><g stroke="currentcolor" fill="currentcolor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mstyle"><g data-mml-node="mspace"/></g><g data-mml-node="mo" transform="translate(278,0)"><path data-c="27F9" d="M1218 514q0 11 16 11 5 0 8 0t5 0 4-1 2-1 2-3 2-3 3-5q37-74 98-131t111-81 96-37q17-5 17-13t-9-11-37-11-58-24q-144-70-218-216-4-9-7-10t-15-2q-20 0-20 7 0 4 5 17 35 69 86 123l10 10H70q-14 7-14 20 0 15 16 20H1363l10 8q39 30 117 69-1 1-18 9t-45 24-54 36l-10 8H710l-3 1-317-1H72q-16 5-16 20 0 13 14 20H1319l-10 10q-33 35-62 81t-29 56z"/></g><g data-mml-node="mstyle" transform="translate(1916,0)"><g data-mml-node="mspace"/></g><g data-mml-node="mn" transform="translate(2471.8,0)"><path data-c="34" d="M462 0Q444 3 333 3 217 3 199 0h-9V46h31q20 0 27 0t17 2 14 5 7 8q1 2 1 54v50H28v46L179 442Q332 674 334 675q2 2 21 2h18l6-6V211h92V165H379V114q0-41 0-48t6-12q8-7 57-8h29V0h-9zM293 211V545L74 212l109-1H293z"/><path data-c="39" d="M352 287q-48-76-120-76-78 0-128 59T44 396q-2 16-2 40v8q0 93 69 162 60 60 132 60 2 0 6 0t8-1h4q12 0 25-2t37-12 47-32 43-59q43-88 43-226 0-140-60-237-35-56-84-87T208-22Q147-22 108 7T68 93t53 56q22 0 37-14t15-39q0-18-9-31T148 49t-13-5l-4-1q0-2 7-6t26-10 42-5h6q60 0 101 64 39 56 39 194v7zM244 248q48 0 77 49t30 133q0 78-8 112-2 10-6 20t-14 26-30 27-47 10q-38 0-65-27-21-22-27-52t-7-105q0-83 5-112t20-47q25-34 72-34z" transform="translate(500,0)"/><path data-c="31" d="M213 578l-13-5q-14-5-40-10t-58-7H83v46h19q47 2 87 15t56 24 28 22q2 3 12 3 9 0 17-6V361l1-3e2q7-7 12-9t24-4 62-2h26V0H416Q395 3 257 3 121 3 1e2.0H88V46h26q22 0 38 0t25 1 16 3 8 2 6 5 6 4V578z" transform="translate(1000,0)"/><path data-c="39" d="M352 287q-48-76-120-76-78 0-128 59T44 396q-2 16-2 40v8q0 93 69 162 60 60 132 60 2 0 6 0t8-1h4q12 0 25-2t37-12 47-32 43-59q43-88 43-226 0-140-60-237-35-56-84-87T208-22Q147-22 108 7T68 93t53 56q22 0 37-14t15-39q0-18-9-31T148 49t-13-5l-4-1q0-2 7-6t26-10 42-5h6q60 0 101 64 39 56 39 194v7zM244 248q48 0 77 49t30 133q0 78-8 112-2 10-6 20t-14 26-30 27-47 10q-38 0-65-27-21-22-27-52t-7-105q0-83 5-112t20-47q25-34 72-34z" transform="translate(1500,0)"/></g><g data-mml-node="mo" transform="translate(4694,0)"><path data-c="2212" d="M84 237t0 13 14 20H679q15-8 15-20t-15-20H98q-14 7-14 20z"/></g><g data-mml-node="mn" transform="translate(5694.2,0)"><path data-c="31" d="M213 578l-13-5q-14-5-40-10t-58-7H83v46h19q47 2 87 15t56 24 28 22q2 3 12 3 9 0 17-6V361l1-3e2q7-7 12-9t24-4 62-2h26V0H416Q395 3 257 3 121 3 1e2.0H88V46h26q22 0 38 0t25 1 16 3 8 2 6 5 6 4V578z"/></g><g data-mml-node="mo" transform="translate(6472,0)"><path data-c="2261" d="M56 444q0 13 14 20H707q15-8 15-20 0-14-16-20H72q-16 5-16 20zm0-207t0 13 14 20H707q15-8 15-20t-15-20H70q-14 7-14 20zM56 56q0 15 16 20H706q16-6 16-20 0-12-15-20H70Q56 43 56 56z"/></g><g data-mml-node="mn" transform="translate(7527.8,0)"><path data-c="30" d="M96 585q56 81 153 81 48 0 96-26t78-92q37-83 37-228 0-155-43-237-20-42-55-67T301-15t-51-7q-26 0-52 6T137 16 82 83Q39 165 39 320q0 174 57 265zm225 12q-30 32-71 32-42 0-72-32-25-26-33-72t-8-192q0-158 8-208t36-79q28-30 69-30 40 0 68 30 29 30 36 84t8 203q0 145-8 191t-33 73z"/></g><g data-mml-node="mspace" transform="translate(8027.8,0)"/><g data-mml-node="mo" transform="translate(9027.8,0)"><path data-c="28" d="M94 250q0 69 10 131t23 107 37 88 38 67 42 52 33 34 25 21h13 4q14 0 14-9 0-3-17-21t-41-53-49-86-42-138-17-193T184 58 225-81t49-86 42-53 17-21q0-9-15-9h-3-13l-28 24Q180-141 137-14T94 250z"/></g><g data-mml-node="mi" transform="translate(9416.8,0)"><path data-c="6D" d="M41 46H55q39 0 47 14v8q0 9 0 23t0 31 1 39 0 42q0 31 0 66t-1 59v23q-3 19-14 25t-45 9H25v23q0 23 2 23l10 1q10 1 28 2t37 2q17 1 36 2t29 3 11 1h3V402q0-38 1-38t5 5 12 15 19 18 29 19 38 16 51 5q15 0 28-2t23-6 19-8 15-9 11-11 9-11 7-11 4-10 3-8l2-5 3 4q3 4 6 8t9 11 13 13 15 13 20 12 23 10 26 7 31 3q126 0 137-113 1-7 1-139V104q0-38 2-45t11-10q21-3 49-3h16V0h-8L788 1q-24 1-51 1T699 3Q596 3 587 0h-8V46h16q61 0 61 16 1 2 1 138-1 135-2 143-6 28-20 42t-24 17-26 2q-45 0-79-34-27-27-34-55t-8-83V168 108q0-30 1-40t3-13 9-6q21-3 49-3h16V0h-8L510 1q-23 1-50 1T422 3Q319 3 310 0h-8V46h16q61 0 61 16 1 2 1 138-1 135-2 143-6 28-20 42t-24 17-26 2q-45 0-79-34-27-27-34-55t-8-83V168 108q0-30 1-40t3-13 9-6q21-3 49-3h16V0h-8L234 1q-24 1-51 1T145 3Q42 3 33 0H25V46H41z"/><path data-c="6F" d="M28 214q0 95 65 164t157 70q90 0 155-68t66-165q0-95-64-160T250-10Q153-10 91 57T28 214zM250 30q122 0 122 163v32 25q0 22-1 38t-7 38-16 36-31 28-49 20q-5 1-16 1-30 0-57-12-43-22-56-61t-13-92V226q0-96 19-135 32-61 105-61z" transform="translate(833,0)"/><path data-c="64" d="M376 495q0 16 0 40t1 33q0 45-10 56t-51 13H298v23q0 23 2 23l10 1q10 1 29 2t37 2q17 1 37 2t30 3 11 1h3V390q0-306 1-309 3-20 14-26t45-9h18V0q-2 0-76-5t-79-6h-7V44l-8-7Q307-11 235-11 158-11 96 50T34 215q0 1e2 63 163t147 64q75 0 132-49V495zm-3-153q-45 63-113 63-49 0-87-36-27-28-34-64t-8-94q0-56 7-91t35-61q30-33 78-33 71 0 122 77V342z" transform="translate(1333,0)"/></g><g data-mml-node="mspace" transform="translate(11305.8,0)"/><g data-mml-node="mi" transform="translate(11805.4,0)"><path data-c="1D45D" d="M23 287q1 3 2 8t5 22 10 31 15 33 20 30 26 22 33 9q75 0 96-64l10 9q62 55 118 55 65 0 102-47t37-114q0-108-76-199T249-10q-22 0-39 6-11 5-23 15T168 28l-7 8q-1-1-22-87t-21-87q0-6 8-7t37-3h25q6-7 6-9t-3-18q-3-12-6-15t-13-4q-2 0-11 0t-34 1-62 1q-70 0-89-2h-8q-7 7-7 11 2 27 13 35H-6q34 1 39 12 3 6 61 239t61 247q1 5 1 14 0 41-25 41-22 0-37-28T71 316 59 280q-2-2-16-2H29q-6 6-6 9zM178 102q22-76 74-76 30 0 58 23t46 58q18 34 36 108t19 110v6q0 74-61 74-11 0-22-3t-22-9-20-13-17-15-15-15-11-14-8-10l-3-4q0-1-3-14t-11-44-14-52q-26-106-26-110z"/></g><g data-mml-node="mi" transform="translate(12308.4,0)"><path data-c="1D45F" d="M21 287q1 3 2 8t5 22 10 31 15 33 20 30 26 22 33 9q29 0 51-12t31-22 11-20q2-6 3-6t8 7q48 52 111 52h3q48 0 72-41 8-19 8-37 0-30-13-48t-26-23-25-4q-20 0-32 11t-12 29q0 48 56 64-22 13-36 13-56 0-103-74-10-16-15-33T190 165Q156 25 151 16q-13-27-43-27-13 0-21 6T76 7 74 17q0 13 40 172t40 177q0 39-26 39-21 0-36-28T68 316 57 280q-2-2-16-2H27q-6 6-6 9z"/></g><g data-mml-node="mi" transform="translate(12759.4,0)"><path data-c="1D45C" d="M201-11Q126-11 80 38T34 156q0 65 30 123t82 101q76 61 155 61 32 0 40-1 13-3 26-7t35-16 36-30 26-49 12-70q0-107-86-193T201-11zM121 120q0-50 26-72t59-22q44 0 83 32t62 84q9 21 23 74t14 92q0 44-18 67-24 30-64 30-63 0-111-58-37-44-55-117T121 120z"/></g><g data-mml-node="mi" transform="translate(13244.4,0)"><path data-c="1D45C" d="M201-11Q126-11 80 38T34 156q0 65 30 123t82 101q76 61 155 61 32 0 40-1 13-3 26-7t35-16 36-30 26-49 12-70q0-107-86-193T201-11zM121 120q0-50 26-72t59-22q44 0 83 32t62 84q9 21 23 74t14 92q0 44-18 67-24 30-64 30-63 0-111-58-37-44-55-117T121 120z"/></g><g data-mml-node="mi" transform="translate(13729.4,0)"><path data-c="1D453" d="M118-162q2 0 6-2t11-3 12-1q13 0 24 13t16 29q10 27 34 153t46 240 22 115v3H242q-47 0-50 2-4 3-4 10l7 28q2 5 8 5t47 1q48 0 48 1 0 2 9 50t12 58q37 165 146 165 37-2 61-22t24-53q0-36-21-52t-42-17q-44 0-44 42 0 19 11 33t24 21l9 5q-16 6-30 6-12 0-23-10t-15-28q-7-29-16-78t-16-83-7-36 55-2q45 0 52-1t11-6q1-4-2-17t-5-16q-2-5-9-5t-54-1H372L349 263Q301 15 282-47q-27-85-70-126-37-32-73-32-32 0-58 19T55-132q0 37 21 54t42 17q44 0 44-42 0-19-11-33t-24-21l-9-5z"/></g><g data-mml-node="mo" transform="translate(14279.4,0)"><path data-c="29" d="M60 749l4 1q5 0 10 0H86l28-24q94-85 137-212t43-264q0-68-10-131T261 12 224-76t-38-67-41-51-32-33-23-19q-3-3-4-4H74q-8 0-11 0t-5 3-3 9q1 1 11 13Q221-64 221 250T66 725q-10 12-11 13 0 8 5 11z"/></g></g></g></svg></div><div class=math><svg style="vertical-align:-.566ex" xmlns="http://www.w3.org/2000/svg" width="29.29ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 12946 1e3"><g stroke="currentcolor" fill="currentcolor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mstyle"><g data-mml-node="mspace"/></g><g data-mml-node="mo" transform="translate(278,0)"><path data-c="27F9" d="M1218 514q0 11 16 11 5 0 8 0t5 0 4-1 2-1 2-3 2-3 3-5q37-74 98-131t111-81 96-37q17-5 17-13t-9-11-37-11-58-24q-144-70-218-216-4-9-7-10t-15-2q-20 0-20 7 0 4 5 17 35 69 86 123l10 10H70q-14 7-14 20 0 15 16 20H1363l10 8q39 30 117 69-1 1-18 9t-45 24-54 36l-10 8H710l-3 1-317-1H72q-16 5-16 20 0 13 14 20H1319l-10 10q-33 35-62 81t-29 56z"/></g><g data-mml-node="mstyle" transform="translate(1916,0)"><g data-mml-node="mspace"/></g><g data-mml-node="mn" transform="translate(2471.8,0)"><path data-c="34" d="M462 0Q444 3 333 3 217 3 199 0h-9V46h31q20 0 27 0t17 2 14 5 7 8q1 2 1 54v50H28v46L179 442Q332 674 334 675q2 2 21 2h18l6-6V211h92V165H379V114q0-41 0-48t6-12q8-7 57-8h29V0h-9zM293 211V545L74 212l109-1H293z"/><path data-c="39" d="M352 287q-48-76-120-76-78 0-128 59T44 396q-2 16-2 40v8q0 93 69 162 60 60 132 60 2 0 6 0t8-1h4q12 0 25-2t37-12 47-32 43-59q43-88 43-226 0-140-60-237-35-56-84-87T208-22Q147-22 108 7T68 93t53 56q22 0 37-14t15-39q0-18-9-31T148 49t-13-5l-4-1q0-2 7-6t26-10 42-5h6q60 0 101 64 39 56 39 194v7zM244 248q48 0 77 49t30 133q0 78-8 112-2 10-6 20t-14 26-30 27-47 10q-38 0-65-27-21-22-27-52t-7-105q0-83 5-112t20-47q25-34 72-34z" transform="translate(500,0)"/><path data-c="31" d="M213 578l-13-5q-14-5-40-10t-58-7H83v46h19q47 2 87 15t56 24 28 22q2 3 12 3 9 0 17-6V361l1-3e2q7-7 12-9t24-4 62-2h26V0H416Q395 3 257 3 121 3 1e2.0H88V46h26q22 0 38 0t25 1 16 3 8 2 6 5 6 4V578z" transform="translate(1000,0)"/><path data-c="38" d="M70 417t0 77 54 124 124 48q71 0 126-42t55-109q0-30-11-56t-26-42-31-28-26-18-11-8l14-9q14-10 28-20t16-11q75-59 75-149 0-79-58-137T249-22q-90 0-148 51T43 155q0 108 129 180l-18 13q-21 13-27 20-57 49-57 126zm216-31 6 4q6 4 9 6t10 7 12 10 11 12 11 13 10 16 9 17 5 20 2 22q0 43-29 73t-67 38q-7 1-33 1-41 0-77-26t-37-65q0-23 13-42t26-29 50-32q7-5 11-7l58-38zM250 21q58 0 1e2 34t42 82q0 17-5 32t-12 25-22 22-23 18-29 19-27 17q-14 9-30 19t-26 17l-8 5q-6 0-29-17t-48-55-26-82q0-59 43-97T250 21z" transform="translate(1500,0)"/></g><g data-mml-node="mo" transform="translate(4749.6,0)"><path data-c="2261" d="M56 444q0 13 14 20H707q15-8 15-20 0-14-16-20H72q-16 5-16 20zm0-207t0 13 14 20H707q15-8 15-20t-15-20H70q-14 7-14 20zM56 56q0 15 16 20H706q16-6 16-20 0-12-15-20H70Q56 43 56 56z"/></g><g data-mml-node="mn" transform="translate(5805.3,0)"><path data-c="30" d="M96 585q56 81 153 81 48 0 96-26t78-92q37-83 37-228 0-155-43-237-20-42-55-67T301-15t-51-7q-26 0-52 6T137 16 82 83Q39 165 39 320q0 174 57 265zm225 12q-30 32-71 32-42 0-72-32-25-26-33-72t-8-192q0-158 8-208t36-79q28-30 69-30 40 0 68 30 29 30 36 84t8 203q0 145-8 191t-33 73z"/></g><g data-mml-node="mspace" transform="translate(6305.3,0)"/><g data-mml-node="mo" transform="translate(7305.3,0)"><path data-c="28" d="M94 250q0 69 10 131t23 107 37 88 38 67 42 52 33 34 25 21h13 4q14 0 14-9 0-3-17-21t-41-53-49-86-42-138-17-193T184 58 225-81t49-86 42-53 17-21q0-9-15-9h-3-13l-28 24Q180-141 137-14T94 250z"/></g><g data-mml-node="mi" transform="translate(7694.3,0)"><path data-c="6D" d="M41 46H55q39 0 47 14v8q0 9 0 23t0 31 1 39 0 42q0 31 0 66t-1 59v23q-3 19-14 25t-45 9H25v23q0 23 2 23l10 1q10 1 28 2t37 2q17 1 36 2t29 3 11 1h3V402q0-38 1-38t5 5 12 15 19 18 29 19 38 16 51 5q15 0 28-2t23-6 19-8 15-9 11-11 9-11 7-11 4-10 3-8l2-5 3 4q3 4 6 8t9 11 13 13 15 13 20 12 23 10 26 7 31 3q126 0 137-113 1-7 1-139V104q0-38 2-45t11-10q21-3 49-3h16V0h-8L788 1q-24 1-51 1T699 3Q596 3 587 0h-8V46h16q61 0 61 16 1 2 1 138-1 135-2 143-6 28-20 42t-24 17-26 2q-45 0-79-34-27-27-34-55t-8-83V168 108q0-30 1-40t3-13 9-6q21-3 49-3h16V0h-8L510 1q-23 1-50 1T422 3Q319 3 310 0h-8V46h16q61 0 61 16 1 2 1 138-1 135-2 143-6 28-20 42t-24 17-26 2q-45 0-79-34-27-27-34-55t-8-83V168 108q0-30 1-40t3-13 9-6q21-3 49-3h16V0h-8L234 1q-24 1-51 1T145 3Q42 3 33 0H25V46H41z"/><path data-c="6F" d="M28 214q0 95 65 164t157 70q90 0 155-68t66-165q0-95-64-160T250-10Q153-10 91 57T28 214zM250 30q122 0 122 163v32 25q0 22-1 38t-7 38-16 36-31 28-49 20q-5 1-16 1-30 0-57-12-43-22-56-61t-13-92V226q0-96 19-135 32-61 105-61z" transform="translate(833,0)"/><path data-c="64" d="M376 495q0 16 0 40t1 33q0 45-10 56t-51 13H298v23q0 23 2 23l10 1q10 1 29 2t37 2q17 1 37 2t30 3 11 1h3V390q0-306 1-309 3-20 14-26t45-9h18V0q-2 0-76-5t-79-6h-7V44l-8-7Q307-11 235-11 158-11 96 50T34 215q0 1e2 63 163t147 64q75 0 132-49V495zm-3-153q-45 63-113 63-49 0-87-36-27-28-34-64t-8-94q0-56 7-91t35-61q30-33 78-33 71 0 122 77V342z" transform="translate(1333,0)"/></g><g data-mml-node="mspace" transform="translate(9583.3,0)"/><g data-mml-node="mi" transform="translate(10083,0)"><path data-c="1D45D" d="M23 287q1 3 2 8t5 22 10 31 15 33 20 30 26 22 33 9q75 0 96-64l10 9q62 55 118 55 65 0 102-47t37-114q0-108-76-199T249-10q-22 0-39 6-11 5-23 15T168 28l-7 8q-1-1-22-87t-21-87q0-6 8-7t37-3h25q6-7 6-9t-3-18q-3-12-6-15t-13-4q-2 0-11 0t-34 1-62 1q-70 0-89-2h-8q-7 7-7 11 2 27 13 35H-6q34 1 39 12 3 6 61 239t61 247q1 5 1 14 0 41-25 41-22 0-37-28T71 316 59 280q-2-2-16-2H29q-6 6-6 9zM178 102q22-76 74-76 30 0 58 23t46 58q18 34 36 108t19 110v6q0 74-61 74-11 0-22-3t-22-9-20-13-17-15-15-15-11-14-8-10l-3-4q0-1-3-14t-11-44-14-52q-26-106-26-110z"/></g><g data-mml-node="mi" transform="translate(10586,0)"><path data-c="1D45F" d="M21 287q1 3 2 8t5 22 10 31 15 33 20 30 26 22 33 9q29 0 51-12t31-22 11-20q2-6 3-6t8 7q48 52 111 52h3q48 0 72-41 8-19 8-37 0-30-13-48t-26-23-25-4q-20 0-32 11t-12 29q0 48 56 64-22 13-36 13-56 0-103-74-10-16-15-33T190 165Q156 25 151 16q-13-27-43-27-13 0-21 6T76 7 74 17q0 13 40 172t40 177q0 39-26 39-21 0-36-28T68 316 57 280q-2-2-16-2H27q-6 6-6 9z"/></g><g data-mml-node="mi" transform="translate(11037,0)"><path data-c="1D45C" d="M201-11Q126-11 80 38T34 156q0 65 30 123t82 101q76 61 155 61 32 0 40-1 13-3 26-7t35-16 36-30 26-49 12-70q0-107-86-193T201-11zM121 120q0-50 26-72t59-22q44 0 83 32t62 84q9 21 23 74t14 92q0 44-18 67-24 30-64 30-63 0-111-58-37-44-55-117T121 120z"/></g><g data-mml-node="mi" transform="translate(11522,0)"><path data-c="1D45C" d="M201-11Q126-11 80 38T34 156q0 65 30 123t82 101q76 61 155 61 32 0 40-1 13-3 26-7t35-16 36-30 26-49 12-70q0-107-86-193T201-11zM121 120q0-50 26-72t59-22q44 0 83 32t62 84q9 21 23 74t14 92q0 44-18 67-24 30-64 30-63 0-111-58-37-44-55-117T121 120z"/></g><g data-mml-node="mi" transform="translate(12007,0)"><path data-c="1D453" d="M118-162q2 0 6-2t11-3 12-1q13 0 24 13t16 29q10 27 34 153t46 240 22 115v3H242q-47 0-50 2-4 3-4 10l7 28q2 5 8 5t47 1q48 0 48 1 0 2 9 50t12 58q37 165 146 165 37-2 61-22t24-53q0-36-21-52t-42-17q-44 0-44 42 0 19 11 33t24 21l9 5q-16 6-30 6-12 0-23-10t-15-28q-7-29-16-78t-16-83-7-36 55-2q45 0 52-1t11-6q1-4-2-17t-5-16q-2-5-9-5t-54-1H372L349 263Q301 15 282-47q-27-85-70-126-37-32-73-32-32 0-58 19T55-132q0 37 21 54t42 17q44 0 44-42 0-19-11-33t-24-21l-9-5z"/></g><g data-mml-node="mo" transform="translate(12557,0)"><path data-c="29" d="M60 749l4 1q5 0 10 0H86l28-24q94-85 137-212t43-264q0-68-10-131T261 12 224-76t-38-67-41-51-32-33-23-19q-3-3-4-4H74q-8 0-11 0t-5 3-3 9q1 1 11 13Q221-64 221 250T66 725q-10 12-11 13 0 8 5 11z"/></g></g></g></svg></div><p>Earlier, we noted that the proof value cannot be 1 and it cannot be even.
Thus, we need an odd proof value that divides 4918 without leaving any remainder.</p><p>The number 2 divides 4918 to give 2459, a prime number.</p><p>This implies, 2 and 2459 are the prime factors of 4918. Since 2 is even, we will choose <strong>2459</strong> as the proof value.</p><h2 id=solving-for-the-volcano-and-the-bear>Solving for the <code>volcano</code> and the <code>bear</code></h2><p>I will be writing a little Rust program to solve for the remaining constraints.</p><p>We know that the <code>volcano</code> number must have at least 17 high bits and at most 27 high bits. Hence, we will begin by
generating numbers that have 17 high bits and 1 low bit.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#66d9ef>let</span> ones <span style=color:#f92672>=</span> <span style=color:#ae81ff>17</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> bits <span style=color:#f92672>=</span> ones <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> volcanos <span style=color:#f92672>=</span> (<span style=color:#ae81ff>0</span><span style=color:#f92672>..</span>bits)
</span></span><span style=display:flex><span>    .map(<span style=color:#f92672>|</span>position<span style=color:#f92672>|</span> (<span style=color:#ae81ff>1</span> <span style=color:#f92672>&lt;&lt;</span> position) <span style=color:#f92672>^</span> ((<span style=color:#ae81ff>1</span> <span style=color:#f92672>&lt;&lt;</span> bits) <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>))
</span></span><span style=display:flex><span>    .collect::<span style=color:#f92672>&lt;</span>Vec<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>i32</span><span style=color:#f92672>&gt;&gt;</span>();
</span></span></code></pre></div><p>This gives us numbers that have a binary representation like:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#ae81ff>111111111111111110</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>111111111111111101</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>111111111111111011</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>111111111111110111</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// and so on
</span></span></span></code></pre></div><p>For any of these numbers we wish to find a <code>bear</code> number that:</p><ul><li>is even</li><li>yields the remainder of 2 when divided by 3</li><li>yields the remainder of 1 when divided by 5</li><li>yields the remainder of 3 when divided by 7</li><li>yields the remainder of 55 when divided by 109</li><li>has the same number of digits as the <code>volcano</code></li><li>has the same sum of digits as the <code>volcano</code></li></ul><p>The naive, inefficient solution would be to loop from 1 to infinity and check for each condition manually.
The code would look like the following:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#66d9ef>for</span> bear <span style=color:#66d9ef>in</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>..</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> bear <span style=color:#f92672>%</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&amp;&amp;</span> bear <span style=color:#f92672>%</span> <span style=color:#ae81ff>3</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&amp;&amp;</span> bear <span style=color:#f92672>%</span> <span style=color:#ae81ff>5</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&amp;&amp;</span> bear <span style=color:#f92672>%</span> <span style=color:#ae81ff>7</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&amp;&amp;</span> bear <span style=color:#f92672>%</span> <span style=color:#ae81ff>109</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>55</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&amp;&amp;</span> sum_and_number_of_digits(bear) <span style=color:#f92672>==</span> sum_and_number_of_digits(volcano)
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// do something
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Since most of the conditions are modulo congruence checks, we can use the Chinese Remainder Theorem
to solve for the smallest number that leaves the respective remainders and begin from there.</p><p>Let <code>a</code> be the array of all the moduli 2, 3, 5, 7 and 109.</p><div class=math><svg style="vertical-align:-6.9ex" xmlns="http://www.w3.org/2000/svg" width="11.567ex" height="14.932ex" role="img" focusable="false" viewBox="0 -3550 5112.6 6600"><g stroke="currentcolor" fill="currentcolor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D44E" d="M33 157q0 101 76 192t171 92q51 0 90-49 16 30 46 30 13 0 23-8t10-20q0-13-37-160T374 68q0-25 7-33t21-9q9 1 20 9 21 20 41 96 6 20 10 21 2 1 10 1h4q19 0 19-9 0-6-5-27T481 63 449 13Q436 0 417-8q-8-2-24-2-34 0-57 15T306 36l-6 15q-1 1-4-1-2-2-4-4-59-56-120-56-55 0-97 40T33 157zM351 328q0 6-5 22t-23 35-46 20q-35 0-67-31t-50-81q-29-79-41-164 0-3 0-11t-1-12q0-45 18-62t43-18q38 0 75 33t44 51q2 4 27 107t26 111z"/></g><g data-mml-node="mo" transform="translate(806.8,0)"><path data-c="3D" d="M56 347q0 13 14 20H707q15-8 15-20 0-11-14-19l-318-1H72q-16 5-16 20zm0-194q0 15 16 20H708q14-10 14-20 0-13-15-20H70q-14 7-14 20z"/></g><g data-mml-node="mrow" transform="translate(1862.6,0)"><g data-mml-node="mo"><path data-c="239B" d="M837 1154q6-6 6-9 0-4-25-39t-65-104-86-161-93-237-80-305Q417-84 417-609q0-32-1-38t-5-7q-2-1-45-1-67 0-69 1-5 2-5 11t-1 60q2 183 13 341t43 352 85 360T574 813t211 323q2 3 5 6t4 5 2 3 3 2 3 1 5 1 6 0h6 18z" transform="translate(0,2396)"/><path data-c="239D" d="M843-635q0-3-6-9H820q-19 0-20 1-8 8-15 17Q684-503 605-363T473-75 385 216 330 518 302 809t-11 284q0 51 0 60t5 11q2 1 70 1 43 0 45-1 4-1 5-7t1-38q0-590 1e2-1010T833-617q10-14 10-18z" transform="translate(0,-2406)"/><svg width="875" height="3182" y="-1341" viewBox="0 718.5 875 3182"><path data-c="239C" d="M413-9q-1 0-6 0t-19-1-34 0q-54 0-57 1t-4 4q-2 10-2 132V3e2q0 302 1 305l4 4q2 1 70 1 16 0 26 0t15 0 5-1q4 0 4-17t1-119V127Q417-9 413-9z" transform="scale(1,7.698)"/></svg></g><g data-mml-node=mtable transform=translate(875,0)><g data-mml-node=mtr transform=translate(0,2800)><g data-mml-node=mtd transform=translate(500,0)><g data-mml-node=mn><path data-c=32 d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g></g><g data-mml-node=mtr transform=translate(0,1400)><g data-mml-node=mtd transform=translate(500,0)><g data-mml-node=mn><path data-c=33 d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z"></path></g></g></g><g data-mml-node=mtr transform=translate(0,0)><g data-mml-node=mtd transform=translate(500,0)><g data-mml-node=mn><path data-c=35 d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z"></path></g></g></g><g data-mml-node=mtr transform=translate(0,-1400)><g data-mml-node=mtd transform=translate(500,0)><g data-mml-node=mn><path data-c=37 d="M55 458Q56 460 72 567L88 674Q88 676 108 676H128V672Q128 662 143 655T195 646T364 644H485V605L417 512Q408 500 387 472T360 435T339 403T319 367T305 330T292 284T284 230T278 162T275 80Q275 66 275 52T274 28V19Q270 2 255 -10T221 -22Q210 -22 200 -19T179 0T168 40Q168 198 265 368Q285 400 349 489L395 552H302Q128 552 119 546Q113 543 108 522T98 479L95 458V455H55V458Z"></path></g></g></g><g data-mml-node=mtr transform=translate(0,-2800)><g data-mml-node=mtd><g data-mml-node=mn><path data-c=31 d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path data-c=30 d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform=translate(500,0)></path><path data-c=39 d="M352 287Q304 211 232 211Q154 211 104 270T44 396Q42 412 42 436V444Q42 537 111 606Q171 666 243 666Q245 666 249 666T257 665H261Q273 665 286 663T323 651T370 619T413 560Q456 472 456 334Q456 194 396 97Q361 41 312 10T208 -22Q147 -22 108 7T68 93T121 149Q143 149 158 135T173 96Q173 78 164 65T148 49T135 44L131 43Q131 41 138 37T164 27T206 22H212Q272 22 313 86Q352 142 352 280V287ZM244 248Q292 248 321 297T351 430Q351 508 343 542Q341 552 337 562T323 588T293 615T246 625Q208 625 181 598Q160 576 154 546T147 441Q147 358 152 329T172 282Q197 248 244 248Z" transform=translate(1000,0)></path></g></g></g></g><g data-mml-node=mo transform=translate(2375,0)><path data-c=239E d="M31 1143Q31 1154 49 1154H59Q72 1154 75 1152T89 1136Q190 1013 269 873T401 585T489 294T544 -8T572 -299T583 -583Q583 -634 583 -643T577 -654Q575 -655 508 -655Q465 -655 463 -654Q459 -653 458 -647T457 -609Q457 -58 371 340T100 1037Q87 1059 61 1098T31 1143Z" transform=translate(0,2396)></path><path data-c=23A0 d="M56 -644H50Q31 -644 31 -635Q31 -632 37 -622Q69 -579 100 -527Q286 -228 371 170T457 1119Q457 1161 462 1164Q464 1165 520 1165Q575 1165 577 1164Q582 1162 582 1153T583 1093Q581 910 570 752T527 400T442 40T300 -303T89 -626Q78 -640 75 -642T61 -644H56Z" transform=translate(0,-2406)></path><svg width="875" height="3182" y="-1341" viewBox="0 718.5 875 3182"><path data-c="239F" d="M579-9q-1 0-6 0t-19-1-34 0q-54 0-57 1t-4 4q-2 10-2 132V3e2q0 302 1 305l4 4q2 1 70 1 16 0 26 0t15 0 5-1q4 0 4-17t1-119V127Q583-9 579-9z" transform="scale(1,7.698)"/></svg></g></g></g></g></svg></div><p>Let <code>r</code> represent the array of the respective remainders.</p><div class=math><svg style="vertical-align:-6.9ex" xmlns="http://www.w3.org/2000/svg" width="10.259ex" height="14.932ex" role="img" focusable="false" viewBox="0 -3550 4534.6 6600"><g stroke="currentcolor" fill="currentcolor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45F" d="M21 287q1 3 2 8t5 22 10 31 15 33 20 30 26 22 33 9q29 0 51-12t31-22 11-20q2-6 3-6t8 7q48 52 111 52h3q48 0 72-41 8-19 8-37 0-30-13-48t-26-23-25-4q-20 0-32 11t-12 29q0 48 56 64-22 13-36 13-56 0-103-74-10-16-15-33T190 165Q156 25 151 16q-13-27-43-27-13 0-21 6T76 7 74 17q0 13 40 172t40 177q0 39-26 39-21 0-36-28T68 316 57 280q-2-2-16-2H27q-6 6-6 9z"/></g><g data-mml-node="mo" transform="translate(728.8,0)"><path data-c="3D" d="M56 347q0 13 14 20H707q15-8 15-20 0-11-14-19l-318-1H72q-16 5-16 20zm0-194q0 15 16 20H708q14-10 14-20 0-13-15-20H70q-14 7-14 20z"/></g><g data-mml-node="mrow" transform="translate(1784.6,0)"><g data-mml-node="mo"><path data-c="239B" d="M837 1154q6-6 6-9 0-4-25-39t-65-104-86-161-93-237-80-305Q417-84 417-609q0-32-1-38t-5-7q-2-1-45-1-67 0-69 1-5 2-5 11t-1 60q2 183 13 341t43 352 85 360T574 813t211 323q2 3 5 6t4 5 2 3 3 2 3 1 5 1 6 0h6 18z" transform="translate(0,2396)"/><path data-c="239D" d="M843-635q0-3-6-9H820q-19 0-20 1-8 8-15 17Q684-503 605-363T473-75 385 216 330 518 302 809t-11 284q0 51 0 60t5 11q2 1 70 1 43 0 45-1 4-1 5-7t1-38q0-590 1e2-1010T833-617q10-14 10-18z" transform="translate(0,-2406)"/><svg width="875" height="3182" y="-1341" viewBox="0 718.5 875 3182"><path data-c="239C" d="M413-9q-1 0-6 0t-19-1-34 0q-54 0-57 1t-4 4q-2 10-2 132V3e2q0 302 1 305l4 4q2 1 70 1 16 0 26 0t15 0 5-1q4 0 4-17t1-119V127Q417-9 413-9z" transform="scale(1,7.698)"/></svg></g><g data-mml-node=mtable transform=translate(875,0)><g data-mml-node=mtr transform=translate(0,2800)><g data-mml-node=mtd transform=translate(250,0)><g data-mml-node=mn><path data-c=30 d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></g></g></g><g data-mml-node=mtr transform=translate(0,1400)><g data-mml-node=mtd transform=translate(250,0)><g data-mml-node=mn><path data-c=32 d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g></g><g data-mml-node=mtr transform=translate(0,0)><g data-mml-node=mtd transform=translate(250,0)><g data-mml-node=mn><path data-c=31 d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g><g data-mml-node=mtr transform=translate(0,-1400)><g data-mml-node=mtd transform=translate(250,0)><g data-mml-node=mn><path data-c=33 d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z"></path></g></g></g><g data-mml-node=mtr transform=translate(0,-2800)><g data-mml-node=mtd><g data-mml-node=mn><path data-c=35 d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z"></path><path data-c=35 d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z" transform=translate(500,0)></path></g></g></g></g><g data-mml-node=mo transform=translate(1875,0)><path data-c=239E d="M31 1143Q31 1154 49 1154H59Q72 1154 75 1152T89 1136Q190 1013 269 873T401 585T489 294T544 -8T572 -299T583 -583Q583 -634 583 -643T577 -654Q575 -655 508 -655Q465 -655 463 -654Q459 -653 458 -647T457 -609Q457 -58 371 340T100 1037Q87 1059 61 1098T31 1143Z" transform=translate(0,2396)></path><path data-c=23A0 d="M56 -644H50Q31 -644 31 -635Q31 -632 37 -622Q69 -579 100 -527Q286 -228 371 170T457 1119Q457 1161 462 1164Q464 1165 520 1165Q575 1165 577 1164Q582 1162 582 1153T583 1093Q581 910 570 752T527 400T442 40T300 -303T89 -626Q78 -640 75 -642T61 -644H56Z" transform=translate(0,-2406)></path><svg width="875" height="3182" y="-1341" viewBox="0 718.5 875 3182"><path data-c="239F" d="M579-9q-1 0-6 0t-19-1-34 0q-54 0-57 1t-4 4q-2 10-2 132V3e2q0 302 1 305l4 4q2 1 70 1 16 0 26 0t15 0 5-1q4 0 4-17t1-119V127Q583-9 579-9z" transform="scale(1,7.698)"/></svg></g></g></g></g></svg></div><p>We begin by calculating <code>n</code> as the product of all the moduli.</p><div class=math><svg style="vertical-align:-1.018ex" xmlns="http://www.w3.org/2000/svg" width="8.84ex" height="3.167ex" role="img" focusable="false" viewBox="0 -950 3907.2 1400"><g stroke="currentcolor" fill="currentcolor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45B" d="M21 287q1 6 3 16t12 38 20 47 33 37 46 17q36 0 60-18t30-34 6-21q0-2 1-2l11 11q61 64 139 64 54 0 87-27t34-79-38-157T427 52q0-26 17-26 6 0 9 1 29 5 52 38t35 80q2 8 20 8 20 0 20-8 0-1-4-15-8-29-22-57T508 17 439-10q-47 0-68 27T350 73q0 19 36 120t37 152q0 59-44 59h-5q-86 0-145-101l-7-12-33-134Q156 26 151 16q-13-27-43-27-13 0-21 6T76 7 74 17q0 13 38 163t40 163q1 5 1 23 0 39-24 39-38 0-63-1e2-6-20-6-21-2-6-19-6H27q-6 6-6 9z"/></g><g data-mml-node="mo" transform="translate(877.8,0)"><path data-c="3D" d="M56 347q0 13 14 20H707q15-8 15-20 0-11-14-19l-318-1H72q-16 5-16 20zm0-194q0 15 16 20H708q14-10 14-20 0-13-15-20H70q-14 7-14 20z"/></g><g data-mml-node="mo" transform="translate(1933.6,0)"><path data-c="220F" d="M220 812q0 1-2 7t-4 10-6 11-9 13-14 13-19 12-26 9-33 6-41 3H56v54H1221V896h-10q-131 0-153-84V-311q18-85 153-85h10v-54H725v54h10q129 0 153 82 1 2 1 3V896H388V292l1-603q16-85 153-85h10v-54H56v54H66q129 0 153 82 1 2 1 3V812z"/></g><g data-mml-node="mi" transform="translate(3378.2,0)"><path data-c="1D44E" d="M33 157q0 101 76 192t171 92q51 0 90-49 16 30 46 30 13 0 23-8t10-20q0-13-37-160T374 68q0-25 7-33t21-9q9 1 20 9 21 20 41 96 6 20 10 21 2 1 10 1h4q19 0 19-9 0-6-5-27T481 63 449 13Q436 0 417-8q-8-2-24-2-34 0-57 15T306 36l-6 15q-1 1-4-1-2-2-4-4-59-56-120-56-55 0-97 40T33 157zM351 328q0 6-5 22t-23 35-46 20q-35 0-67-31t-50-81q-29-79-41-164 0-3 0-11t-1-12q0-45 18-62t43-18q38 0 75 33t44 51q2 4 27 107t26 111z"/></g></g></g></svg></div><p>We construct <code>m</code> containing the modulus of each equation by diving <code>n</code> by each element of <code>a</code>.</p><div class=math><svg style="vertical-align:-1.909ex" xmlns="http://www.w3.org/2000/svg" width="8.675ex" height="4.438ex" role="img" focusable="false" viewBox="0 -1118 3834.5 1961.8"><g stroke="currentcolor" fill="currentcolor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287q1 6 3 16t12 38 20 47 32 37 44 17 43-7 30-18 16-22 8-19l2-7q0-2 1-2l11 11q60 64 141 64 17 0 31-2t26-7 19-10 15-12 10-13 8-13 4-12 3-9 2-7l8 10q63 75 149 75 54 0 87-27t34-79q0-51-38-158T704 50q1-14 5-19t15-5q28 0 52 30t39 82q3 11 6 13t16 2q20 0 20-8 0-1-4-15-8-29-22-57T785 17 716-10q-47 0-68 27T627 73q0 19 36 120t37 152q0 59-44 59h-5q-86 0-145-101l-7-12-33-134Q433 26 428 16q-13-27-43-27-13 0-21 7T353 8t-3 10q0 11 34 143l36 146q3 15 3 38 0 59-44 59h-5q-86 0-145-101l-7-12-33-134Q156 26 151 16q-13-27-43-27-13 0-21 6T76 7 74 17q0 13 38 164 39 154 39 161 3 15 3 27 0 36-25 36-22 0-37-28T69 316 57 280q-2-2-16-2H27q-6 6-6 9z"/></g><g data-mml-node="TeXAtom" transform="translate(911,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D456" d="M184 6e2q0 24 19 42t44 19q18 0 30-12t13-30q0-23-20-42t-44-20q-15 0-28 10t-14 33zM21 287q0 8 9 31t24 51 44 51 60 22q39 0 65-23t27-62q0-17-14-56T196 196 154 83q-5-22-5-32 0-25 17-25 9 0 19 3t23 14 27 35 25 59q3 12 5 14t17 2q20 0 20-10 0-8-9-31T268 61 223 11 161-11q-32 0-59 21T74 74q0 17 5 32t43 114q38 101 44 121t7 39q0 24-17 24h-2q-30 0-55-33T61 287q-1-1-2-3t-1-3-2-2-3-1-4 0-8 0H27q-6 6-6 9z"/></g></g></g><g data-mml-node="mo" transform="translate(1482.7,0)"><path data-c="3D" d="M56 347q0 13 14 20H707q15-8 15-20 0-11-14-19l-318-1H72q-16 5-16 20zm0-194q0 15 16 20H708q14-10 14-20 0-13-15-20H70q-14 7-14 20z"/></g><g data-mml-node="mfrac" transform="translate(2538.5,0)"><g data-mml-node="mi" transform="translate(348,676)"><path data-c="1D45B" d="M21 287q1 6 3 16t12 38 20 47 33 37 46 17q36 0 60-18t30-34 6-21q0-2 1-2l11 11q61 64 139 64 54 0 87-27t34-79-38-157T427 52q0-26 17-26 6 0 9 1 29 5 52 38t35 80q2 8 20 8 20 0 20-8 0-1-4-15-8-29-22-57T508 17 439-10q-47 0-68 27T350 73q0 19 36 120t37 152q0 59-44 59h-5q-86 0-145-101l-7-12-33-134Q156 26 151 16q-13-27-43-27-13 0-21 6T76 7 74 17q0 13 38 163t40 163q1 5 1 23 0 39-24 39-38 0-63-1e2-6-20-6-21-2-6-19-6H27q-6 6-6 9z"/></g><g data-mml-node="msub" transform="translate(220,-686)"><g data-mml-node="mi"><path data-c="1D44E" d="M33 157q0 101 76 192t171 92q51 0 90-49 16 30 46 30 13 0 23-8t10-20q0-13-37-160T374 68q0-25 7-33t21-9q9 1 20 9 21 20 41 96 6 20 10 21 2 1 10 1h4q19 0 19-9 0-6-5-27T481 63 449 13Q436 0 417-8q-8-2-24-2-34 0-57 15T306 36l-6 15q-1 1-4-1-2-2-4-4-59-56-120-56-55 0-97 40T33 157zM351 328q0 6-5 22t-23 35-46 20q-35 0-67-31t-50-81q-29-79-41-164 0-3 0-11t-1-12q0-45 18-62t43-18q38 0 75 33t44 51q2 4 27 107t26 111z"/></g><g data-mml-node="TeXAtom" transform="translate(562,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D456" d="M184 6e2q0 24 19 42t44 19q18 0 30-12t13-30q0-23-20-42t-44-20q-15 0-28 10t-14 33zM21 287q0 8 9 31t24 51 44 51 60 22q39 0 65-23t27-62q0-17-14-56T196 196 154 83q-5-22-5-32 0-25 17-25 9 0 19 3t23 14 27 35 25 59q3 12 5 14t17 2q20 0 20-10 0-8-9-31T268 61 223 11 161-11q-32 0-59 21T74 74q0 17 5 32t43 114q38 101 44 121t7 39q0 24-17 24h-2q-30 0-55-33T61 287q-1-1-2-3t-1-3-2-2-3-1-4 0-8 0H27q-6 6-6 9z"/></g></g></g><rect width="1056" height="60" x="120" y="220"/></g></g></g></svg></div><p>We then calculate the multiplicative modular inverse of the aforementioned moduli with respect to the original moduli.</p><div class=math><svg style="vertical-align:-1.909ex" xmlns="http://www.w3.org/2000/svg" width="21.036ex" height="4.945ex" role="img" focusable="false" viewBox="0 -1342 9298.1 2185.8"><g stroke="currentcolor" fill="currentcolor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D440" d="M289 629q0 6-57 8-24 0-31 1t-7 10q0 1 2 11 1 3 2 7t1 5 2 5 2 3 4 2 5 2 8 0 12 1q6 0 30 0t45-1q79 0 91 0t16-5q1-4 37-282l36-279 23 37q24 36 64 1e2t88 140Q837 673 839 675q1 1 3 3t4 3l6 2h96q17 0 40 0t29 1q34 0 34-11 0-5-3-17t-3-13q-4-6-37-6-40-1-51-3t-18-11q-3-5-72-283T797 59q0-4 1-5t7-4 17-2 33-2h31q6-9 6-11 0-16-7-30-5-5-16-5-5 0-41 1T736 2q-61 0-92 0T609 1q-17 0-17 10 0 2 2 14 4 16 8 18t23 3q27 0 60 3 14 3 19 12 2 4 38 146t71 283 35 141L654 322Q458 10 453 5q-2-1-4-2-5-3-16-3-15 0-18 7-2 4-41 310L335 624 267 354Q2e2 88 2e2 79q6-33 72-33h10q6-5 7-9t-3-18q-4-16-8-18-4-1-11-1-2 0-12 0T221 1 157 2Q127 2 95 1T58 0Q43 0 39 2t-4 9q0 2 3 14t5 15q2 6 22 6 70 0 89 40 4 6 69 268t66 275z"/></g><g data-mml-node="TeXAtom" transform="translate(1003,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D456" d="M184 6e2q0 24 19 42t44 19q18 0 30-12t13-30q0-23-20-42t-44-20q-15 0-28 10t-14 33zM21 287q0 8 9 31t24 51 44 51 60 22q39 0 65-23t27-62q0-17-14-56T196 196 154 83q-5-22-5-32 0-25 17-25 9 0 19 3t23 14 27 35 25 59q3 12 5 14t17 2q20 0 20-10 0-8-9-31T268 61 223 11 161-11q-32 0-59 21T74 74q0 17 5 32t43 114q38 101 44 121t7 39q0 24-17 24h-2q-30 0-55-33T61 287q-1-1-2-3t-1-3-2-2-3-1-4 0-8 0H27q-6 6-6 9z"/></g></g></g><g data-mml-node="mo" transform="translate(1574.7,0)"><path data-c="2261" d="M56 444q0 13 14 20H707q15-8 15-20 0-14-16-20H72q-16 5-16 20zm0-207t0 13 14 20H707q15-8 15-20t-15-20H70q-14 7-14 20zM56 56q0 15 16 20H706q16-6 16-20 0-12-15-20H70Q56 43 56 56z"/></g><g data-mml-node="mfrac" transform="translate(2630.5,0)"><g data-mml-node="mn" transform="translate(572.5,676)"><path data-c="31" d="M213 578l-13-5q-14-5-40-10t-58-7H83v46h19q47 2 87 15t56 24 28 22q2 3 12 3 9 0 17-6V361l1-3e2q7-7 12-9t24-4 62-2h26V0H416Q395 3 257 3 121 3 1e2.0H88V46h26q22 0 38 0t25 1 16 3 8 2 6 5 6 4V578z"/></g><g data-mml-node="msub" transform="translate(220,-686)"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287q1 6 3 16t12 38 20 47 32 37 44 17 43-7 30-18 16-22 8-19l2-7q0-2 1-2l11 11q60 64 141 64 17 0 31-2t26-7 19-10 15-12 10-13 8-13 4-12 3-9 2-7l8 10q63 75 149 75 54 0 87-27t34-79q0-51-38-158T704 50q1-14 5-19t15-5q28 0 52 30t39 82q3 11 6 13t16 2q20 0 20-8 0-1-4-15-8-29-22-57T785 17 716-10q-47 0-68 27T627 73q0 19 36 120t37 152q0 59-44 59h-5q-86 0-145-101l-7-12-33-134Q433 26 428 16q-13-27-43-27-13 0-21 7T353 8t-3 10q0 11 34 143l36 146q3 15 3 38 0 59-44 59h-5q-86 0-145-101l-7-12-33-134Q156 26 151 16q-13-27-43-27-13 0-21 6T76 7 74 17q0 13 38 164 39 154 39 161 3 15 3 27 0 36-25 36-22 0-37-28T69 316 57 280q-2-2-16-2H27q-6 6-6 9z"/></g><g data-mml-node="TeXAtom" transform="translate(911,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D456" d="M184 6e2q0 24 19 42t44 19q18 0 30-12t13-30q0-23-20-42t-44-20q-15 0-28 10t-14 33zM21 287q0 8 9 31t24 51 44 51 60 22q39 0 65-23t27-62q0-17-14-56T196 196 154 83q-5-22-5-32 0-25 17-25 9 0 19 3t23 14 27 35 25 59q3 12 5 14t17 2q20 0 20-10 0-8-9-31T268 61 223 11 161-11q-32 0-59 21T74 74q0 17 5 32t43 114q38 101 44 121t7 39q0 24-17 24h-2q-30 0-55-33T61 287q-1-1-2-3t-1-3-2-2-3-1-4 0-8 0H27q-6 6-6 9z"/></g></g></g><rect width="1405" height="60" x="120" y="220"/></g><g data-mml-node="mspace" transform="translate(4275.5,0)"/><g data-mml-node="mo" transform="translate(5275.5,0)"><path data-c="28" d="M94 250q0 69 10 131t23 107 37 88 38 67 42 52 33 34 25 21h13 4q14 0 14-9 0-3-17-21t-41-53-49-86-42-138-17-193T184 58 225-81t49-86 42-53 17-21q0-9-15-9h-3-13l-28 24Q180-141 137-14T94 250z"/></g><g data-mml-node="mi" transform="translate(5664.5,0)"><path data-c="6D" d="M41 46H55q39 0 47 14v8q0 9 0 23t0 31 1 39 0 42q0 31 0 66t-1 59v23q-3 19-14 25t-45 9H25v23q0 23 2 23l10 1q10 1 28 2t37 2q17 1 36 2t29 3 11 1h3V402q0-38 1-38t5 5 12 15 19 18 29 19 38 16 51 5q15 0 28-2t23-6 19-8 15-9 11-11 9-11 7-11 4-10 3-8l2-5 3 4q3 4 6 8t9 11 13 13 15 13 20 12 23 10 26 7 31 3q126 0 137-113 1-7 1-139V104q0-38 2-45t11-10q21-3 49-3h16V0h-8L788 1q-24 1-51 1T699 3Q596 3 587 0h-8V46h16q61 0 61 16 1 2 1 138-1 135-2 143-6 28-20 42t-24 17-26 2q-45 0-79-34-27-27-34-55t-8-83V168 108q0-30 1-40t3-13 9-6q21-3 49-3h16V0h-8L510 1q-23 1-50 1T422 3Q319 3 310 0h-8V46h16q61 0 61 16 1 2 1 138-1 135-2 143-6 28-20 42t-24 17-26 2q-45 0-79-34-27-27-34-55t-8-83V168 108q0-30 1-40t3-13 9-6q21-3 49-3h16V0h-8L234 1q-24 1-51 1T145 3Q42 3 33 0H25V46H41z"/><path data-c="6F" d="M28 214q0 95 65 164t157 70q90 0 155-68t66-165q0-95-64-160T250-10Q153-10 91 57T28 214zM250 30q122 0 122 163v32 25q0 22-1 38t-7 38-16 36-31 28-49 20q-5 1-16 1-30 0-57-12-43-22-56-61t-13-92V226q0-96 19-135 32-61 105-61z" transform="translate(833,0)"/><path data-c="64" d="M376 495q0 16 0 40t1 33q0 45-10 56t-51 13H298v23q0 23 2 23l10 1q10 1 29 2t37 2q17 1 37 2t30 3 11 1h3V390q0-306 1-309 3-20 14-26t45-9h18V0q-2 0-76-5t-79-6h-7V44l-8-7Q307-11 235-11 158-11 96 50T34 215q0 1e2 63 163t147 64q75 0 132-49V495zm-3-153q-45 63-113 63-49 0-87-36-27-28-34-64t-8-94q0-56 7-91t35-61q30-33 78-33 71 0 122 77V342z" transform="translate(1333,0)"/></g><g data-mml-node="mspace" transform="translate(7553.5,0)"/><g data-mml-node="msub" transform="translate(8053.1,0)"><g data-mml-node="mi"><path data-c="1D44E" d="M33 157q0 101 76 192t171 92q51 0 90-49 16 30 46 30 13 0 23-8t10-20q0-13-37-160T374 68q0-25 7-33t21-9q9 1 20 9 21 20 41 96 6 20 10 21 2 1 10 1h4q19 0 19-9 0-6-5-27T481 63 449 13Q436 0 417-8q-8-2-24-2-34 0-57 15T306 36l-6 15q-1 1-4-1-2-2-4-4-59-56-120-56-55 0-97 40T33 157zM351 328q0 6-5 22t-23 35-46 20q-35 0-67-31t-50-81q-29-79-41-164 0-3 0-11t-1-12q0-45 18-62t43-18q38 0 75 33t44 51q2 4 27 107t26 111z"/></g><g data-mml-node="mi" transform="translate(562,-150) scale(0.707)"><path data-c="1D456" d="M184 6e2q0 24 19 42t44 19q18 0 30-12t13-30q0-23-20-42t-44-20q-15 0-28 10t-14 33zM21 287q0 8 9 31t24 51 44 51 60 22q39 0 65-23t27-62q0-17-14-56T196 196 154 83q-5-22-5-32 0-25 17-25 9 0 19 3t23 14 27 35 25 59q3 12 5 14t17 2q20 0 20-10 0-8-9-31T268 61 223 11 161-11q-32 0-59 21T74 74q0 17 5 32t43 114q38 101 44 121t7 39q0 24-17 24h-2q-30 0-55-33T61 287q-1-1-2-3t-1-3-2-2-3-1-4 0-8 0H27q-6 6-6 9z"/></g></g><g data-mml-node="mo" transform="translate(8909.1,0)"><path data-c="29" d="M60 749l4 1q5 0 10 0H86l28-24q94-85 137-212t43-264q0-68-10-131T261 12 224-76t-38-67-41-51-32-33-23-19q-3-3-4-4H74q-8 0-11 0t-5 3-3 9q1 1 11 13Q221-64 221 250T66 725q-10 12-11 13 0 8 5 11z"/></g></g></g></svg></div><blockquote><p>The modular inverse of a number <code>x</code> modulo <code>m</code> is the number <code>x_inv</code> such that its product with <code>x</code> mod <code>m</code> is 1.</p><div class=math><svg style="vertical-align:-.566ex" xmlns="http://www.w3.org/2000/svg" width="22.26ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 9838.8 1e3"><g stroke="currentcolor" fill="currentcolor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D465" d="M52 289q7 42 54 97t116 56q35 0 64-18t43-45q42 63 101 63 37 0 64-22t28-59q0-29-14-47t-27-22-23-4q-19 0-31 11t-12 29q0 46 50 63-11 13-40 13-13 0-19-2-38-16-56-66-60-221-60-258 0-28 16-40t35-12q37 0 73 33t49 81q3 10 6 11t16 2h4q15 0 15-8 0-1-2-11-16-57-62-101T333-11q-70 0-106 63-41-62-94-62h-6Q78-10 57 16T35 71q0 32 19 52t45 20q43 0 43-42 0-20-12-35T107 46 94 41l-3-1q0-1 6-4t16-7 19-3q36 0 62 45 9 16 23 68t28 108 16 66q5 27 5 39 0 28-15 40t-34 12q-40 0-75-32T93 290q-2-9-5-10t-16-2H58q-6 6-6 11z"/></g><g data-mml-node="mo" transform="translate(794.2,0)"><path data-c="22C5" d="M78 250q0 24 17 42t43 18q24 0 42-16t19-43q0-25-17-43t-43-18-43 17-18 43z"/></g><g data-mml-node="msub" transform="translate(1294.4,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289q7 42 54 97t116 56q35 0 64-18t43-45q42 63 101 63 37 0 64-22t28-59q0-29-14-47t-27-22-23-4q-19 0-31 11t-12 29q0 46 50 63-11 13-40 13-13 0-19-2-38-16-56-66-60-221-60-258 0-28 16-40t35-12q37 0 73 33t49 81q3 10 6 11t16 2h4q15 0 15-8 0-1-2-11-16-57-62-101T333-11q-70 0-106 63-41-62-94-62h-6Q78-10 57 16T35 71q0 32 19 52t45 20q43 0 43-42 0-20-12-35T107 46 94 41l-3-1q0-1 6-4t16-7 19-3q36 0 62 45 9 16 23 68t28 108 16 66q5 27 5 39 0 28-15 40t-34 12q-40 0-75-32T93 290q-2-9-5-10t-16-2H58q-6 6-6 11z"/></g><g data-mml-node="TeXAtom" transform="translate(605,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D456" d="M184 6e2q0 24 19 42t44 19q18 0 30-12t13-30q0-23-20-42t-44-20q-15 0-28 10t-14 33zM21 287q0 8 9 31t24 51 44 51 60 22q39 0 65-23t27-62q0-17-14-56T196 196 154 83q-5-22-5-32 0-25 17-25 9 0 19 3t23 14 27 35 25 59q3 12 5 14t17 2q20 0 20-10 0-8-9-31T268 61 223 11 161-11q-32 0-59 21T74 74q0 17 5 32t43 114q38 101 44 121t7 39q0 24-17 24h-2q-30 0-55-33T61 287q-1-1-2-3t-1-3-2-2-3-1-4 0-8 0H27q-6 6-6 9z"/></g><g data-mml-node="mi" transform="translate(345,0)"><path data-c="1D45B" d="M21 287q1 6 3 16t12 38 20 47 33 37 46 17q36 0 60-18t30-34 6-21q0-2 1-2l11 11q61 64 139 64 54 0 87-27t34-79-38-157T427 52q0-26 17-26 6 0 9 1 29 5 52 38t35 80q2 8 20 8 20 0 20-8 0-1-4-15-8-29-22-57T508 17 439-10q-47 0-68 27T350 73q0 19 36 120t37 152q0 59-44 59h-5q-86 0-145-101l-7-12-33-134Q156 26 151 16q-13-27-43-27-13 0-21 6T76 7 74 17q0 13 38 163t40 163q1 5 1 23 0 39-24 39-38 0-63-1e2-6-20-6-21-2-6-19-6H27q-6 6-6 9z"/></g><g data-mml-node="mi" transform="translate(945,0)"><path data-c="1D463" d="M173 380q0 25-19 25-24 0-50-29T61 287q-1-1-2-3t-1-3-2-2-3-1-4 0-8 0H27q-6 6-6 9 0 7 8 29t24 52 44 51 63 22q42 0 65-24t24-56q0-17-3-26 0-6-15-44t-31-89-18-89q0-27 5-44 13-43 63-43 37 0 69 34t50 79 29 83 11 55q0 23-8 40t-18 26-18 18-8 22q0 22 19 41t41 19q19 0 34-18t16-58q0-27-12-83T418 159 347 40 241-11q-64 0-102 33-37 32-37 95 0 31 8 64t41 117q22 64 22 82z"/></g></g></g><g data-mml-node="mo" transform="translate(3238.4,0)"><path data-c="2261" d="M56 444q0 13 14 20H707q15-8 15-20 0-14-16-20H72q-16 5-16 20zm0-207t0 13 14 20H707q15-8 15-20t-15-20H70q-14 7-14 20zM56 56q0 15 16 20H706q16-6 16-20 0-12-15-20H70Q56 43 56 56z"/></g><g data-mml-node="mn" transform="translate(4294.2,0)"><path data-c="31" d="M213 578l-13-5q-14-5-40-10t-58-7H83v46h19q47 2 87 15t56 24 28 22q2 3 12 3 9 0 17-6V361l1-3e2q7-7 12-9t24-4 62-2h26V0H416Q395 3 257 3 121 3 1e2.0H88V46h26q22 0 38 0t25 1 16 3 8 2 6 5 6 4V578z"/></g><g data-mml-node="mspace" transform="translate(4794.2,0)"/><g data-mml-node="mo" transform="translate(5794.2,0)"><path data-c="28" d="M94 250q0 69 10 131t23 107 37 88 38 67 42 52 33 34 25 21h13 4q14 0 14-9 0-3-17-21t-41-53-49-86-42-138-17-193T184 58 225-81t49-86 42-53 17-21q0-9-15-9h-3-13l-28 24Q180-141 137-14T94 250z"/></g><g data-mml-node="mi" transform="translate(6183.2,0)"><path data-c="6D" d="M41 46H55q39 0 47 14v8q0 9 0 23t0 31 1 39 0 42q0 31 0 66t-1 59v23q-3 19-14 25t-45 9H25v23q0 23 2 23l10 1q10 1 28 2t37 2q17 1 36 2t29 3 11 1h3V402q0-38 1-38t5 5 12 15 19 18 29 19 38 16 51 5q15 0 28-2t23-6 19-8 15-9 11-11 9-11 7-11 4-10 3-8l2-5 3 4q3 4 6 8t9 11 13 13 15 13 20 12 23 10 26 7 31 3q126 0 137-113 1-7 1-139V104q0-38 2-45t11-10q21-3 49-3h16V0h-8L788 1q-24 1-51 1T699 3Q596 3 587 0h-8V46h16q61 0 61 16 1 2 1 138-1 135-2 143-6 28-20 42t-24 17-26 2q-45 0-79-34-27-27-34-55t-8-83V168 108q0-30 1-40t3-13 9-6q21-3 49-3h16V0h-8L510 1q-23 1-50 1T422 3Q319 3 310 0h-8V46h16q61 0 61 16 1 2 1 138-1 135-2 143-6 28-20 42t-24 17-26 2q-45 0-79-34-27-27-34-55t-8-83V168 108q0-30 1-40t3-13 9-6q21-3 49-3h16V0h-8L234 1q-24 1-51 1T145 3Q42 3 33 0H25V46H41z"/><path data-c="6F" d="M28 214q0 95 65 164t157 70q90 0 155-68t66-165q0-95-64-160T250-10Q153-10 91 57T28 214zM250 30q122 0 122 163v32 25q0 22-1 38t-7 38-16 36-31 28-49 20q-5 1-16 1-30 0-57-12-43-22-56-61t-13-92V226q0-96 19-135 32-61 105-61z" transform="translate(833,0)"/><path data-c="64" d="M376 495q0 16 0 40t1 33q0 45-10 56t-51 13H298v23q0 23 2 23l10 1q10 1 29 2t37 2q17 1 37 2t30 3 11 1h3V390q0-306 1-309 3-20 14-26t45-9h18V0q-2 0-76-5t-79-6h-7V44l-8-7Q307-11 235-11 158-11 96 50T34 215q0 1e2 63 163t147 64q75 0 132-49V495zm-3-153q-45 63-113 63-49 0-87-36-27-28-34-64t-8-94q0-56 7-91t35-61q30-33 78-33 71 0 122 77V342z" transform="translate(1333,0)"/></g><g data-mml-node="mspace" transform="translate(8072.2,0)"/><g data-mml-node="mi" transform="translate(8571.8,0)"><path data-c="1D45A" d="M21 287q1 6 3 16t12 38 20 47 32 37 44 17 43-7 30-18 16-22 8-19l2-7q0-2 1-2l11 11q60 64 141 64 17 0 31-2t26-7 19-10 15-12 10-13 8-13 4-12 3-9 2-7l8 10q63 75 149 75 54 0 87-27t34-79q0-51-38-158T704 50q1-14 5-19t15-5q28 0 52 30t39 82q3 11 6 13t16 2q20 0 20-8 0-1-4-15-8-29-22-57T785 17 716-10q-47 0-68 27T627 73q0 19 36 120t37 152q0 59-44 59h-5q-86 0-145-101l-7-12-33-134Q433 26 428 16q-13-27-43-27-13 0-21 7T353 8t-3 10q0 11 34 143l36 146q3 15 3 38 0 59-44 59h-5q-86 0-145-101l-7-12-33-134Q156 26 151 16q-13-27-43-27-13 0-21 6T76 7 74 17q0 13 38 164 39 154 39 161 3 15 3 27 0 36-25 36-22 0-37-28T69 316 57 280q-2-2-16-2H27q-6 6-6 9z"/></g><g data-mml-node="mo" transform="translate(9449.8,0)"><path data-c="29" d="M60 749l4 1q5 0 10 0H86l28-24q94-85 137-212t43-264q0-68-10-131T261 12 224-76t-38-67-41-51-32-33-23-19q-3-3-4-4H74q-8 0-11 0t-5 3-3 9q1 1 11 13Q221-64 221 250T66 725q-10 12-11 13 0 8 5 11z"/></g></g></g></svg></div></blockquote><p>We now multiply the calculated moduli and their inverses to find out the constants that leave the remainder 1.
Let&rsquo;s name this array of constants as <code>c</code>.</p><div class=math><svg style="vertical-align:-.357ex" xmlns="http://www.w3.org/2000/svg" width="12.031ex" height="1.902ex" role="img" focusable="false" viewBox="0 -683 5317.9 840.8"><g stroke="currentcolor" fill="currentcolor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D450" d="M34 159q0 109 86 196t186 87q56 0 88-24t33-63q0-29-19-49t-48-21q-19 0-30 10t-11 30 11 34 22 21 14 6h1q0 2-6 6t-21 8-34 4q-30 0-57-14-21-9-43-31-44-44-64-124T121 119q0-46 26-69 22-24 58-24h4q112 0 185 85 9 10 12 10 4 0 13-9t10-14-9-15-29-28-45-30T282 0 202-11Q127-11 81 37T34 159z"/></g><g data-mml-node="TeXAtom" transform="translate(466,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D456" d="M184 6e2q0 24 19 42t44 19q18 0 30-12t13-30q0-23-20-42t-44-20q-15 0-28 10t-14 33zM21 287q0 8 9 31t24 51 44 51 60 22q39 0 65-23t27-62q0-17-14-56T196 196 154 83q-5-22-5-32 0-25 17-25 9 0 19 3t23 14 27 35 25 59q3 12 5 14t17 2q20 0 20-10 0-8-9-31T268 61 223 11 161-11q-32 0-59 21T74 74q0 17 5 32t43 114q38 101 44 121t7 39q0 24-17 24h-2q-30 0-55-33T61 287q-1-1-2-3t-1-3-2-2-3-1-4 0-8 0H27q-6 6-6 9z"/></g></g></g><g data-mml-node="mo" transform="translate(1037.7,0)"><path data-c="3D" d="M56 347q0 13 14 20H707q15-8 15-20 0-11-14-19l-318-1H72q-16 5-16 20zm0-194q0 15 16 20H708q14-10 14-20 0-13-15-20H70q-14 7-14 20z"/></g><g data-mml-node="msub" transform="translate(2093.5,0)"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287q1 6 3 16t12 38 20 47 32 37 44 17 43-7 30-18 16-22 8-19l2-7q0-2 1-2l11 11q60 64 141 64 17 0 31-2t26-7 19-10 15-12 10-13 8-13 4-12 3-9 2-7l8 10q63 75 149 75 54 0 87-27t34-79q0-51-38-158T704 50q1-14 5-19t15-5q28 0 52 30t39 82q3 11 6 13t16 2q20 0 20-8 0-1-4-15-8-29-22-57T785 17 716-10q-47 0-68 27T627 73q0 19 36 120t37 152q0 59-44 59h-5q-86 0-145-101l-7-12-33-134Q433 26 428 16q-13-27-43-27-13 0-21 7T353 8t-3 10q0 11 34 143l36 146q3 15 3 38 0 59-44 59h-5q-86 0-145-101l-7-12-33-134Q156 26 151 16q-13-27-43-27-13 0-21 6T76 7 74 17q0 13 38 164 39 154 39 161 3 15 3 27 0 36-25 36-22 0-37-28T69 316 57 280q-2-2-16-2H27q-6 6-6 9z"/></g><g data-mml-node="TeXAtom" transform="translate(911,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D456" d="M184 6e2q0 24 19 42t44 19q18 0 30-12t13-30q0-23-20-42t-44-20q-15 0-28 10t-14 33zM21 287q0 8 9 31t24 51 44 51 60 22q39 0 65-23t27-62q0-17-14-56T196 196 154 83q-5-22-5-32 0-25 17-25 9 0 19 3t23 14 27 35 25 59q3 12 5 14t17 2q20 0 20-10 0-8-9-31T268 61 223 11 161-11q-32 0-59 21T74 74q0 17 5 32t43 114q38 101 44 121t7 39q0 24-17 24h-2q-30 0-55-33T61 287q-1-1-2-3t-1-3-2-2-3-1-4 0-8 0H27q-6 6-6 9z"/></g></g></g><g data-mml-node="mo" transform="translate(3520.7,0)"><path data-c="22C5" d="M78 250q0 24 17 42t43 18q24 0 42-16t19-43q0-25-17-43t-43-18-43 17-18 43z"/></g><g data-mml-node="msub" transform="translate(4020.9,0)"><g data-mml-node="mi"><path data-c="1D440" d="M289 629q0 6-57 8-24 0-31 1t-7 10q0 1 2 11 1 3 2 7t1 5 2 5 2 3 4 2 5 2 8 0 12 1q6 0 30 0t45-1q79 0 91 0t16-5q1-4 37-282l36-279 23 37q24 36 64 1e2t88 140Q837 673 839 675q1 1 3 3t4 3l6 2h96q17 0 40 0t29 1q34 0 34-11 0-5-3-17t-3-13q-4-6-37-6-40-1-51-3t-18-11q-3-5-72-283T797 59q0-4 1-5t7-4 17-2 33-2h31q6-9 6-11 0-16-7-30-5-5-16-5-5 0-41 1T736 2q-61 0-92 0T609 1q-17 0-17 10 0 2 2 14 4 16 8 18t23 3q27 0 60 3 14 3 19 12 2 4 38 146t71 283 35 141L654 322Q458 10 453 5q-2-1-4-2-5-3-16-3-15 0-18 7-2 4-41 310L335 624 267 354Q2e2 88 2e2 79q6-33 72-33h10q6-5 7-9t-3-18q-4-16-8-18-4-1-11-1-2 0-12 0T221 1 157 2Q127 2 95 1T58 0Q43 0 39 2t-4 9q0 2 3 14t5 15q2 6 22 6 70 0 89 40 4 6 69 268t66 275z"/></g><g data-mml-node="TeXAtom" transform="translate(1003,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D456" d="M184 6e2q0 24 19 42t44 19q18 0 30-12t13-30q0-23-20-42t-44-20q-15 0-28 10t-14 33zM21 287q0 8 9 31t24 51 44 51 60 22q39 0 65-23t27-62q0-17-14-56T196 196 154 83q-5-22-5-32 0-25 17-25 9 0 19 3t23 14 27 35 25 59q3 12 5 14t17 2q20 0 20-10 0-8-9-31T268 61 223 11 161-11q-32 0-59 21T74 74q0 17 5 32t43 114q38 101 44 121t7 39q0 24-17 24h-2q-30 0-55-33T61 287q-1-1-2-3t-1-3-2-2-3-1-4 0-8 0H27q-6 6-6 9z"/></g></g></g></g></g></svg></div><p>We multiply the remainder with each constant and add them up. The final unique solution is this number modulo <code>n</code>.</p><div class=math><svg style="vertical-align:-2.697ex" xmlns="http://www.w3.org/2000/svg" width="32.498ex" height="5ex" role="img" focusable="false" viewBox="0 -950 14364.2 2142.2"><g stroke="currentcolor" fill="currentcolor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D460" d="M131 289q0 32 16 65t56 61 97 27q62 0 90-27t29-60q0-32-17-47t-38-16q-13 0-24 8t-12 26q0 16 9 28t17 18 13 6q1 0 1 1 0 3-7 9t-25 11-39 6q-48 0-70-26t-23-53q0-25 19-35t55-17 52-15q66-29 66-96 0-28-11-56T352 51 289 7 195-10Q118-10 86 19T53 87q0 39 21 56t44 17q15 0 28-9t14-31q0-26-18-44T111 58q-2-1-3-1t-1-2q1-3 8-8t31-13 55-7q36 0 62 11t38 28 17 31 5 25q0 28-21 42t-48 17-59 15-47 35q-17 25-17 58z"/></g><g data-mml-node="mi" transform="translate(469,0)"><path data-c="1D45C" d="M201-11Q126-11 80 38T34 156q0 65 30 123t82 101q76 61 155 61 32 0 40-1 13-3 26-7t35-16 36-30 26-49 12-70q0-107-86-193T201-11zM121 120q0-50 26-72t59-22q44 0 83 32t62 84q9 21 23 74t14 92q0 44-18 67-24 30-64 30-63 0-111-58-37-44-55-117T121 120z"/></g><g data-mml-node="mi" transform="translate(954,0)"><path data-c="1D459" d="M117 59q0-33 25-33 37 0 63 105 6 20 10 21 2 1 10 1h4q9 0 12 0t5-2 2-7q-1-6-3-16T234 90 214 43 183 6 137-11q-36 0-67 22T38 85q0 12 1 17l65 258q63 255 63 263 0 3-1 5t-4 4-5 2-8 1-8 1-9 1-10 0q-10 0-13 0t-8 1-6 3-1 6q0 2 2 14 5 19 11 21t72 6q15 1 34 2t30 3 11 1q12 0 12-8 0-11-73-3e2T118 83q0-2 0-8t-1-10V59z"/></g><g data-mml-node="mi" transform="translate(1252,0)"><path data-c="1D462" d="M21 287q0 8 9 31t25 52 44 50 59 22q46 0 69-25t23-59q0-18-34-112T182 105q0-43 14-60t42-18 53 17 37 34l11 17q2 4 38 152 30 120 36 140t14 29q17 15 36 15 17 0 25-10t8-19L420 84q-1-5-1-16 0-25 7-33t21-9q22 3 35 31t30 88q2 8 20 8 19 0 19-9-1-5-2-14t-9-32-17-43-25-38T462-8q-8-2-24-2-66 0-91 56-2-1-11-10T318 21 296 6 267-6t-34-5q-44 0-78 18-52 31-52 106 0 57 35 149t35 117q0 1 0 2 0 9 0 12t-4 7-11 4h-4q-23 0-42-19T82 344 65 302t-8-22-16-2H27q-6 6-6 9z"/></g><g data-mml-node="mi" transform="translate(1824,0)"><path data-c="1D461" d="M26 385q-7 7-7 10 0 4 3 16t5 14q2 5 9 5t51 1h53l19 80q3 11 7 29t7 26 6 20 8 17 10 12 14 9 18 2q18-1 25-11t7-19q0-7-9-47t-20-79l-10-37q0-2 50-2h51q7-7 7-11 0-22-13-35H210L174 240Q135 80 135 68q0-42 27-42 35 0 68 34t53 84q2 6 5 7t15 2h4q15 0 15-8 0-3-3-12-5-16-18-38T267 48 216 6 155-11Q125-11 98 4T59 56q-2 8-2 27v18L92 241q35 141 36 142 0 2-51 2H26z"/></g><g data-mml-node="mi" transform="translate(2185,0)"><path data-c="1D456" d="M184 6e2q0 24 19 42t44 19q18 0 30-12t13-30q0-23-20-42t-44-20q-15 0-28 10t-14 33zM21 287q0 8 9 31t24 51 44 51 60 22q39 0 65-23t27-62q0-17-14-56T196 196 154 83q-5-22-5-32 0-25 17-25 9 0 19 3t23 14 27 35 25 59q3 12 5 14t17 2q20 0 20-10 0-8-9-31T268 61 223 11 161-11q-32 0-59 21T74 74q0 17 5 32t43 114q38 101 44 121t7 39q0 24-17 24h-2q-30 0-55-33T61 287q-1-1-2-3t-1-3-2-2-3-1-4 0-8 0H27q-6 6-6 9z"/></g><g data-mml-node="mi" transform="translate(2530,0)"><path data-c="1D45C" d="M201-11Q126-11 80 38T34 156q0 65 30 123t82 101q76 61 155 61 32 0 40-1 13-3 26-7t35-16 36-30 26-49 12-70q0-107-86-193T201-11zM121 120q0-50 26-72t59-22q44 0 83 32t62 84q9 21 23 74t14 92q0 44-18 67-24 30-64 30-63 0-111-58-37-44-55-117T121 120z"/></g><g data-mml-node="mi" transform="translate(3015,0)"><path data-c="1D45B" d="M21 287q1 6 3 16t12 38 20 47 33 37 46 17q36 0 60-18t30-34 6-21q0-2 1-2l11 11q61 64 139 64 54 0 87-27t34-79-38-157T427 52q0-26 17-26 6 0 9 1 29 5 52 38t35 80q2 8 20 8 20 0 20-8 0-1-4-15-8-29-22-57T508 17 439-10q-47 0-68 27T350 73q0 19 36 120t37 152q0 59-44 59h-5q-86 0-145-101l-7-12-33-134Q156 26 151 16q-13-27-43-27-13 0-21 6T76 7 74 17q0 13 38 163t40 163q1 5 1 23 0 39-24 39-38 0-63-1e2-6-20-6-21-2-6-19-6H27q-6 6-6 9z"/></g><g data-mml-node="mo" transform="translate(3892.8,0)"><path data-c="3D" d="M56 347q0 13 14 20H707q15-8 15-20 0-11-14-19l-318-1H72q-16 5-16 20zm0-194q0 15 16 20H708q14-10 14-20 0-13-15-20H70q-14 7-14 20z"/></g><g data-mml-node="mo" transform="translate(4948.6,0)"><path data-c="28" d="M94 250q0 69 10 131t23 107 37 88 38 67 42 52 33 34 25 21h13 4q14 0 14-9 0-3-17-21t-41-53-49-86-42-138-17-193T184 58 225-81t49-86 42-53 17-21q0-9-15-9h-3-13l-28 24Q180-141 137-14T94 250z"/></g><g data-mml-node="munder" transform="translate(5337.6,0)"><g data-mml-node="mo"><path data-c="2211" d="M60 948q3 2 605 2h602l58-135q59-138 63-146h-40l-7 14q-21 41-56 78-50 48-111 77t-141 43-151 17-183 4H574 543 251l8-11Q722 258 724 252q1-2 0-6-3-3-264-302L196-356q0-1 211-1 52 0 141 0t128-1q136 0 220 5t167 21 141 49 103 87q21 26 41 72h40q0-1-7-21t-25-65-31-84l-58-155-601-1q-602 0-605 2-6 2-6 9 0 2 2 6L590 177q0 1-33 45T452 366 322 544L56 909l-1 15q0 21 5 24z"/></g><g data-mml-node="TeXAtom" transform="translate(600,-1084.4) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D456" d="M184 6e2q0 24 19 42t44 19q18 0 30-12t13-30q0-23-20-42t-44-20q-15 0-28 10t-14 33zM21 287q0 8 9 31t24 51 44 51 60 22q39 0 65-23t27-62q0-17-14-56T196 196 154 83q-5-22-5-32 0-25 17-25 9 0 19 3t23 14 27 35 25 59q3 12 5 14t17 2q20 0 20-10 0-8-9-31T268 61 223 11 161-11q-32 0-59 21T74 74q0 17 5 32t43 114q38 101 44 121t7 39q0 24-17 24h-2q-30 0-55-33T61 287q-1-1-2-3t-1-3-2-2-3-1-4 0-8 0H27q-6 6-6 9z"/></g></g></g><g data-mml-node="msub" transform="translate(6948.2,0)"><g data-mml-node="mi"><path data-c="1D450" d="M34 159q0 109 86 196t186 87q56 0 88-24t33-63q0-29-19-49t-48-21q-19 0-30 10t-11 30 11 34 22 21 14 6h1q0 2-6 6t-21 8-34 4q-30 0-57-14-21-9-43-31-44-44-64-124T121 119q0-46 26-69 22-24 58-24h4q112 0 185 85 9 10 12 10 4 0 13-9t10-14-9-15-29-28-45-30T282 0 202-11Q127-11 81 37T34 159z"/></g><g data-mml-node="TeXAtom" transform="translate(466,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D456" d="M184 6e2q0 24 19 42t44 19q18 0 30-12t13-30q0-23-20-42t-44-20q-15 0-28 10t-14 33zM21 287q0 8 9 31t24 51 44 51 60 22q39 0 65-23t27-62q0-17-14-56T196 196 154 83q-5-22-5-32 0-25 17-25 9 0 19 3t23 14 27 35 25 59q3 12 5 14t17 2q20 0 20-10 0-8-9-31T268 61 223 11 161-11q-32 0-59 21T74 74q0 17 5 32t43 114q38 101 44 121t7 39q0 24-17 24h-2q-30 0-55-33T61 287q-1-1-2-3t-1-3-2-2-3-1-4 0-8 0H27q-6 6-6 9z"/></g></g></g><g data-mml-node="mo" transform="translate(7930.4,0)"><path data-c="22C5" d="M78 250q0 24 17 42t43 18q24 0 42-16t19-43q0-25-17-43t-43-18-43 17-18 43z"/></g><g data-mml-node="msub" transform="translate(8430.6,0)"><g data-mml-node="mi"><path data-c="1D45F" d="M21 287q1 3 2 8t5 22 10 31 15 33 20 30 26 22 33 9q29 0 51-12t31-22 11-20q2-6 3-6t8 7q48 52 111 52h3q48 0 72-41 8-19 8-37 0-30-13-48t-26-23-25-4q-20 0-32 11t-12 29q0 48 56 64-22 13-36 13-56 0-103-74-10-16-15-33T190 165Q156 25 151 16q-13-27-43-27-13 0-21 6T76 7 74 17q0 13 40 172t40 177q0 39-26 39-21 0-36-28T68 316 57 280q-2-2-16-2H27q-6 6-6 9z"/></g><g data-mml-node="TeXAtom" transform="translate(484,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D456" d="M184 6e2q0 24 19 42t44 19q18 0 30-12t13-30q0-23-20-42t-44-20q-15 0-28 10t-14 33zM21 287q0 8 9 31t24 51 44 51 60 22q39 0 65-23t27-62q0-17-14-56T196 196 154 83q-5-22-5-32 0-25 17-25 9 0 19 3t23 14 27 35 25 59q3 12 5 14t17 2q20 0 20-10 0-8-9-31T268 61 223 11 161-11q-32 0-59 21T74 74q0 17 5 32t43 114q38 101 44 121t7 39q0 24-17 24h-2q-30 0-55-33T61 287q-1-1-2-3t-1-3-2-2-3-1-4 0-8 0H27q-6 6-6 9z"/></g></g></g><g data-mml-node="mo" transform="translate(9208.6,0)"><path data-c="29" d="M60 749l4 1q5 0 10 0H86l28-24q94-85 137-212t43-264q0-68-10-131T261 12 224-76t-38-67-41-51-32-33-23-19q-3-3-4-4H74q-8 0-11 0t-5 3-3 9q1 1 11 13Q221-64 221 250T66 725q-10 12-11 13 0 8 5 11z"/></g><g data-mml-node="mspace" transform="translate(9597.6,0)"/><g data-mml-node="mo" transform="translate(10597.6,0)"><path data-c="28" d="M94 250q0 69 10 131t23 107 37 88 38 67 42 52 33 34 25 21h13 4q14 0 14-9 0-3-17-21t-41-53-49-86-42-138-17-193T184 58 225-81t49-86 42-53 17-21q0-9-15-9h-3-13l-28 24Q180-141 137-14T94 250z"/></g><g data-mml-node="mi" transform="translate(10986.6,0)"><path data-c="6D" d="M41 46H55q39 0 47 14v8q0 9 0 23t0 31 1 39 0 42q0 31 0 66t-1 59v23q-3 19-14 25t-45 9H25v23q0 23 2 23l10 1q10 1 28 2t37 2q17 1 36 2t29 3 11 1h3V402q0-38 1-38t5 5 12 15 19 18 29 19 38 16 51 5q15 0 28-2t23-6 19-8 15-9 11-11 9-11 7-11 4-10 3-8l2-5 3 4q3 4 6 8t9 11 13 13 15 13 20 12 23 10 26 7 31 3q126 0 137-113 1-7 1-139V104q0-38 2-45t11-10q21-3 49-3h16V0h-8L788 1q-24 1-51 1T699 3Q596 3 587 0h-8V46h16q61 0 61 16 1 2 1 138-1 135-2 143-6 28-20 42t-24 17-26 2q-45 0-79-34-27-27-34-55t-8-83V168 108q0-30 1-40t3-13 9-6q21-3 49-3h16V0h-8L510 1q-23 1-50 1T422 3Q319 3 310 0h-8V46h16q61 0 61 16 1 2 1 138-1 135-2 143-6 28-20 42t-24 17-26 2q-45 0-79-34-27-27-34-55t-8-83V168 108q0-30 1-40t3-13 9-6q21-3 49-3h16V0h-8L234 1q-24 1-51 1T145 3Q42 3 33 0H25V46H41z"/><path data-c="6F" d="M28 214q0 95 65 164t157 70q90 0 155-68t66-165q0-95-64-160T250-10Q153-10 91 57T28 214zM250 30q122 0 122 163v32 25q0 22-1 38t-7 38-16 36-31 28-49 20q-5 1-16 1-30 0-57-12-43-22-56-61t-13-92V226q0-96 19-135 32-61 105-61z" transform="translate(833,0)"/><path data-c="64" d="M376 495q0 16 0 40t1 33q0 45-10 56t-51 13H298v23q0 23 2 23l10 1q10 1 29 2t37 2q17 1 37 2t30 3 11 1h3V390q0-306 1-309 3-20 14-26t45-9h18V0q-2 0-76-5t-79-6h-7V44l-8-7Q307-11 235-11 158-11 96 50T34 215q0 1e2 63 163t147 64q75 0 132-49V495zm-3-153q-45 63-113 63-49 0-87-36-27-28-34-64t-8-94q0-56 7-91t35-61q30-33 78-33 71 0 122 77V342z" transform="translate(1333,0)"/></g><g data-mml-node="mspace" transform="translate(12875.6,0)"/><g data-mml-node="mi" transform="translate(13375.2,0)"><path data-c="1D45B" d="M21 287q1 6 3 16t12 38 20 47 33 37 46 17q36 0 60-18t30-34 6-21q0-2 1-2l11 11q61 64 139 64 54 0 87-27t34-79-38-157T427 52q0-26 17-26 6 0 9 1 29 5 52 38t35 80q2 8 20 8 20 0 20-8 0-1-4-15-8-29-22-57T508 17 439-10q-47 0-68 27T350 73q0 19 36 120t37 152q0 59-44 59h-5q-86 0-145-101l-7-12-33-134Q156 26 151 16q-13-27-43-27-13 0-21 6T76 7 74 17q0 13 38 163t40 163q1 5 1 23 0 39-24 39-38 0-63-1e2-6-20-6-21-2-6-19-6H27q-6 6-6 9z"/></g><g data-mml-node="mo" transform="translate(13975.2,0)"><path data-c="29" d="M60 749l4 1q5 0 10 0H86l28-24q94-85 137-212t43-264q0-68-10-131T261 12 224-76t-38-67-41-51-32-33-23-19q-3-3-4-4H74q-8 0-11 0t-5 3-3 9q1 1 11 13Q221-64 221 250T66 725q-10 12-11 13 0 8 5 11z"/></g></g></g></svg></div><p>The code implementation looks like the following:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#66d9ef>let</span> moduli <span style=color:#f92672>=</span> [<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>7</span>, <span style=color:#ae81ff>109</span>];
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> remainders <span style=color:#f92672>=</span> [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>55</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> n: <span style=color:#66d9ef>i32</span> <span style=color:#f92672>=</span> moduli.iter().product();
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> generated: Vec<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>i32</span><span style=color:#f92672>&gt;</span> <span style=color:#f92672>=</span> moduli.iter().map(<span style=color:#f92672>|</span>m<span style=color:#f92672>|</span> n <span style=color:#f92672>/</span> m).collect();
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> inverses: Vec<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>i32</span><span style=color:#f92672>&gt;</span> <span style=color:#f92672>=</span> generated
</span></span><span style=display:flex><span>    .iter()
</span></span><span style=display:flex><span>    .zip(moduli.iter())
</span></span><span style=display:flex><span>    .filter_map(<span style=color:#f92672>|</span>(a, m)<span style=color:#f92672>|</span> modinverse::modinverse(<span style=color:#f92672>*</span>a, <span style=color:#f92672>*</span>m))
</span></span><span style=display:flex><span>    .collect();
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> s: <span style=color:#66d9ef>i32</span> <span style=color:#f92672>=</span> inverses
</span></span><span style=display:flex><span>    .iter()
</span></span><span style=display:flex><span>    .zip(generated.iter())
</span></span><span style=display:flex><span>    .zip(remainders.iter())
</span></span><span style=display:flex><span>    .map(<span style=color:#f92672>|</span>((m, m_inv), r)<span style=color:#f92672>|</span> m <span style=color:#f92672>*</span> m_inv <span style=color:#f92672>*</span> r)
</span></span><span style=display:flex><span>    .sum();
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> solution <span style=color:#f92672>=</span> s <span style=color:#f92672>%</span> n;
</span></span></code></pre></div><p>Here, I&rsquo;m using the <a href=https://docs.rs/modinverse/latest/modinverse/>modinverse</a> crate so that I don&rsquo;t have to implement it manually. If you are following along,
run the following to add it to your Rust project:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>cargo add modinverse
</span></span></code></pre></div><p>For all the <code>volcano</code> numbers generated we search for a <code>bear</code> number starting from the unique <code>solution</code> and stepping by the product of all the moduli, <code>n</code>.
Again, if any of the <code>bear</code> values has the same number of digits and the same sum of digits as the volcano number, it is valid.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#66d9ef>for</span> volcano <span style=color:#66d9ef>in</span> volcanos {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> v_digits <span style=color:#f92672>=</span> digits(volcano);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> bear <span style=color:#66d9ef>in</span> (solution<span style=color:#f92672>..</span>volcano).step_by(n <span style=color:#66d9ef>as</span> <span style=color:#66d9ef>usize</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> digits(bear) <span style=color:#f92672>==</span> v_digits {
</span></span><span style=display:flex><span>            println!(<span style=color:#e6db74>&#34;volcano: </span><span style=color:#e6db74>{volcano}</span><span style=color:#e6db74>, bear: </span><span style=color:#e6db74>{bear}</span><span style=color:#e6db74>&#34;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Here <code>digits</code> is a function that returns a tuple of the number of digits and sum of digits for an argument.</p><p>The complete program source code becomes the following:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>digits</span>(<span style=color:#66d9ef>mut</span> n: <span style=color:#66d9ef>i32</span>) -&gt; (<span style=color:#66d9ef>i32</span>, <span style=color:#66d9ef>i32</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> c <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> r <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> n <span style=color:#f92672>!=</span> <span style=color:#ae81ff>0</span> {
</span></span><span style=display:flex><span>        r <span style=color:#f92672>+=</span> n <span style=color:#f92672>%</span> <span style=color:#ae81ff>10</span>;
</span></span><span style=display:flex><span>        n <span style=color:#f92672>/=</span> <span style=color:#ae81ff>10</span>;
</span></span><span style=display:flex><span>        c <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    (c, r)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> ones <span style=color:#f92672>=</span> <span style=color:#ae81ff>17</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> bits <span style=color:#f92672>=</span> ones <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> volcanos <span style=color:#f92672>=</span> (<span style=color:#ae81ff>0</span><span style=color:#f92672>..</span>bits)
</span></span><span style=display:flex><span>        .map(<span style=color:#f92672>|</span>position<span style=color:#f92672>|</span> (<span style=color:#ae81ff>1</span> <span style=color:#f92672>&lt;&lt;</span> position) <span style=color:#f92672>^</span> ((<span style=color:#ae81ff>1</span> <span style=color:#f92672>&lt;&lt;</span> bits) <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>))
</span></span><span style=display:flex><span>        .collect::<span style=color:#f92672>&lt;</span>Vec<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>i32</span><span style=color:#f92672>&gt;&gt;</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> moduli <span style=color:#f92672>=</span> [<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>7</span>, <span style=color:#ae81ff>109</span>];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> remainders <span style=color:#f92672>=</span> [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>55</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> n: <span style=color:#66d9ef>i32</span> <span style=color:#f92672>=</span> moduli.iter().product();
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> generated: Vec<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>i32</span><span style=color:#f92672>&gt;</span> <span style=color:#f92672>=</span> moduli.iter().map(<span style=color:#f92672>|</span>m<span style=color:#f92672>|</span> n <span style=color:#f92672>/</span> m).collect();
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> inverses: Vec<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>i32</span><span style=color:#f92672>&gt;</span> <span style=color:#f92672>=</span> generated
</span></span><span style=display:flex><span>        .iter()
</span></span><span style=display:flex><span>        .zip(moduli.iter())
</span></span><span style=display:flex><span>        .filter_map(<span style=color:#f92672>|</span>(a, m)<span style=color:#f92672>|</span> modinverse::modinverse(<span style=color:#f92672>*</span>a, <span style=color:#f92672>*</span>m))
</span></span><span style=display:flex><span>        .collect();
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> constants_sum: <span style=color:#66d9ef>i32</span> <span style=color:#f92672>=</span> inverses
</span></span><span style=display:flex><span>        .iter()
</span></span><span style=display:flex><span>        .zip(generated.iter())
</span></span><span style=display:flex><span>        .zip(remainders.iter())
</span></span><span style=display:flex><span>        .map(<span style=color:#f92672>|</span>((m, m_inv), r)<span style=color:#f92672>|</span> m <span style=color:#f92672>*</span> m_inv <span style=color:#f92672>*</span> r)
</span></span><span style=display:flex><span>        .sum();
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> solution <span style=color:#f92672>=</span> constants_sum <span style=color:#f92672>%</span> n;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> volcano <span style=color:#66d9ef>in</span> volcanos {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> v_digits <span style=color:#f92672>=</span> digits(volcano);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> bear <span style=color:#66d9ef>in</span> (solution<span style=color:#f92672>..</span>volcano).step_by(n <span style=color:#66d9ef>as</span> <span style=color:#66d9ef>usize</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> digits(bear) <span style=color:#f92672>==</span> v_digits {
</span></span><span style=display:flex><span>                println!(<span style=color:#e6db74>&#34;volcano: </span><span style=color:#e6db74>{volcano}</span><span style=color:#e6db74>, bear: </span><span style=color:#e6db74>{bear}</span><span style=color:#e6db74>&#34;</span>);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>If we run the program using <code>cargo run</code>, we get multiple unqiue solutions to the problem:</p><pre tabindex=0><code>volcano: 262139, bear: 132926
volcano: 262139, bear: 201596
volcano: 262079, bear: 155816
volcano: 262079, bear: 224486
volcano: 258047, bear: 155816
volcano: 258047, bear: 224486
volcano: 196607, bear: 178706
</code></pre><p>Now we can connect to the challenge server, supply any of the solutions and get the flag.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>nc amt.rs <span style=color:#ae81ff>31010</span>
</span></span></code></pre></div><pre tabindex=0><code>Give me a bear: 132926
Give me a volcano: 262139
Prove to me they are the same: 2459
That looks right to me!
amateursCTF{yep_th0se_l00k_th3_s4me_to_m3!_:clueless:}
</code></pre></section></article><footer class=post-tags data-pagefind-meta=tags><a href=https://lavafroth.is-a.dev/tags/amateursctf>AmateursCTF</a>
<a href=https://lavafroth.is-a.dev/tags/ctf>CTF</a>
<a href=https://lavafroth.is-a.dev/tags/remainder-theorem>Remainder Theorem</a>
<a href=https://lavafroth.is-a.dev/tags/reverse-engineering>Reverse Engineering</a></footer><nav class=post-nav><a class=prev href=https://lavafroth.is-a.dev/post/compact-xor-crypto-challenge-amateursctf-2023/><span></span><span>Compact XOR</span></a>
<a class=next href=https://lavafroth.is-a.dev/post/wait-an-eternity-web-challenge-amateursctf-2023/><span>Waiting an Eternity</span><span></span></a></nav></main><footer class=footer><p>&copy; 2023 <a href=https://lavafroth.is-a.dev/>lavafroth</a> | <a href=https://github.com/lavafroth/lavafroth.github.io/issues/new/choose>Report an issue</a> | <a href=https://github.com/lavafroth/lavafroth.github.io/discussions/>Discuss</a> | <a href=https://lavafroth.is-a.dev/privacy>Privacy</a></p></footer></body></html>