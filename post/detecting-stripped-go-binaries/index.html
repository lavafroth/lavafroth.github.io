<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>Easy grep to detect stripped Go binaries - lavafroth</title><meta name=description content='A couple of days ago when I was reading the guide to the Go garbage collector, I came across the following excerpt:

When all else fails, the Go GC provides a few different specific traces that provide much deeper insights into GC behavior. These traces are always printed directly to STDERR, one line per GC cycle, and are configured through the GODEBUG environment variable that all Go programs recognize.
An environment variable that all Go programs recognize, you say? I had a sneaking suspicion that I could just perform a string search for this term, given all Go programs would need to look for this environment variable definition. This way, we could guess if a binary was written in Go.'><meta name=author content><link rel="preload stylesheet" as=style href=https://lavafroth.is-a.dev/app.min.css><link rel=preload as=image href=../../header.svg><link rel=preload as=font href=https://lavafroth.is-a.dev/LeagueGothic.ttf><link as=font href=https://lavafroth.is-a.dev/latinmodern-math.otf><link rel=preload as=image href=https://lavafroth.is-a.dev/github.svg><link rel=preload as=image href=https://lavafroth.is-a.dev/about.svg><link rel=preload as=image href=https://lavafroth.is-a.dev/art.svg><link rel=icon href=https://lavafroth.is-a.dev/favicon.png><link rel=blog-icon href=https://lavafroth.is-a.dev/icon.png></head><body data-menu=true><header class=header><h1><a class=site-name href=https://lavafroth.is-a.dev/>lavafroth</a></h1><div class=push></div><a style=--url:url(./github.svg) href=https://github.com/lavafroth aria-label=github target=_blank></a><a href=../../about/ aria-label=about style=--url:url(./about.svg)></a><a href=../../art/ aria-label=art style=--url:url(./art.svg)></a></header><main class=main><article class=post-single><header class=post-title><p><time>Jun 13, 2025 | 2 minutes read</time></p><h1 data-pagefind-meta=title>Easy grep to detect stripped Go binaries</h1></header><section class=post-content data-pagefind-body><p>A couple of days ago when I was reading the <a href=https://tip.golang.org/doc/gc-guide>guide to the Go garbage collector</a>, I came across the following excerpt:</p><blockquote><p>When all else fails, the Go GC provides a few different specific traces that provide much deeper insights into GC behavior. These traces are always printed directly to STDERR, one line per GC cycle, and are configured through the GODEBUG environment variable that all Go programs recognize.</p></blockquote><p>An environment variable that all Go programs recognize, you say? I had a sneaking suspicion that I could just perform a string search for this term, given all Go programs would need to look for this environment variable definition. This way, we could guess if a binary was written in Go.</p><p>I created a program called <code>hello</code> to test this out. To make sure the binary is stripped, I compiled it with <code>go build -ldflags '-w -s'</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>grep GODEBUG hello
</span></span></code></pre></div><pre tabindex=0><code>grep: hello: binary file matches
</code></pre><p>Sure enough, looks like this does provide a decent heuristic for Go programs! Of course, there&rsquo;s the caveat that another binary can &ldquo;pretend&rdquo; to be a Go binary by simply having this string present in it.</p><p>We could try this technique with other environment variables like <code>GOGC</code>, available in all binaries and <code>GOMEMLIMIT</code>, available for Go 1.19 and up.</p><p>So if you have a hunch that a binary is written in Go 1.19 and above, try <code>grep</code>ping with all the aforementioned variables.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>grep -P <span style=color:#e6db74>&#39;(GOGC|GOMEMLIMIT|GODEBUG)&#39;</span> hello
</span></span></code></pre></div><p>Ok bye.</p></section></article><footer class=post-tags data-pagefind-meta=tags><a href=https://lavafroth.is-a.dev/tags/go class=list-tag>Go</a>
<a href=https://lavafroth.is-a.dev/tags/reverse-engieering class=list-tag>Reverse Engieering</a>
<a href=https://lavafroth.is-a.dev/tags/til class=list-tag>TIL</a></footer><nav class=post-nav><a class=prev href=https://lavafroth.is-a.dev/post/changing-recents-provider-on-eos/><span>←</span><span>Guide: Changing Recents Provider on /e/OS</span></a>
<a class=next href=https://lavafroth.is-a.dev/post/do-you-really-need-a-copilot/><span>Need a hand?</span><span>→</span></a></nav></main><footer class=footer><p>&copy; 2025 <a href=https://lavafroth.is-a.dev/>lavafroth</a></p><p><a href=https://github.com/lavafroth/lavafroth.github.io/issues/new/choose>Report an issue</a></p><p><a href=https://github.com/lavafroth/lavafroth.github.io/discussions/>Discuss</a></p><p><a href=https://lavafroth.is-a.dev/privacy>Privacy</a></p><p><a href=https://creativecommons.org/licenses/by-sa/4.0/legalcode>License</a></p></footer></body></html>