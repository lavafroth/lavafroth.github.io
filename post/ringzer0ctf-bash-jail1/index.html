<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>Bash Jail 1 - lavafroth</title><meta name=description content='The challenge
Upon SSHing into the box, we are told that the flag is located at /home/level1/flag.txt
Challenge bash code:
while :
do
        echo "Your input:"
        read input
        output=`$input`
done 
Inference and experimenation
The script is reading an input, executes it and then stores it in the
output variable without ever displaying the output to the console.
I tried a dummy command to see if I could see its stderr since command
substitution (backticks) only capture the stdout.'><meta name=author content><link rel="preload stylesheet" as=style href=https://lavafroth.is-a.dev/app.min.css><link rel=preload as=image href=../../header.svg><link as=font href=https://lavafroth.is-a.dev/latinmodern-math.otf><link rel=preload as=image href=https://lavafroth.is-a.dev/github.svg><link rel=preload as=image href=https://lavafroth.is-a.dev/about.svg><link rel=preload as=image href=https://lavafroth.is-a.dev/art.svg><link rel=icon href=https://lavafroth.is-a.dev/favicon.png><link rel=blog-icon href=https://lavafroth.is-a.dev/icon.png></head><body data-menu=true><header class=header><h1><a class=site-name href=https://lavafroth.is-a.dev/><svg viewBox="0 0 8790 2400"><path d="M80 1935V465h216v1270h286v2e2zm853 0 222-1470h264l222 1470h-210l-40-3e2h-208l-40 3e2zm280-528h148l-62-494-6-78h-12l-6 78zm1025 528L2014 465h210l108 868 8 142h12l8-142 108-868h210l-224 1470zm813 0 222-1470h264l222 1470h-210l-40-3e2h-208l-40 3e2zm280-528h148l-62-494-6-78h-12l-6 78zm851 528V465h514v222h-298v386h2e2v222h-2e2v640zm910 0V465h216q194 0 286 108 92 107 92 316 0 124-43 215-44 90-106 132l147 699h-216l-122-620h-38v620zm216-820q60 0 95-26 35-27 50-76t15-116q0-105-34-161-35-57-126-57zm1084 836q-90 0-154-42-65-42-99-114-35-72-35-162V767q0-91 35-162 34-72 99-114 64-42 154-42t155 42q64 42 99 114 34 72 34 162v866q0 90-34 162-35 72-99 114-65 42-155 42zm0-210q40 0 56-33 16-34 16-75V767q0-41-17-74-17-34-55-34-37 0-54 34-18 33-18 74v866q0 41 17 75 17 33 55 33zm890 194V687h-204V465h624v222h-204v1248zm828 0V465h216v608h168V465h216v1470h-216v-640h-168v640z"/></svg></a></h1><div class=push></div><a style=--url:url(./github.svg) href=https://github.com/lavafroth aria-label=github target=_blank></a><a href=../../about/ aria-label=about style=--url:url(./about.svg)></a><a href=../../art/ aria-label=art style=--url:url(./art.svg)></a></header><main class=main><article class=post-single data-pagefind-body><header class=post-title><p data-pagefind-ignore><time>Jul 24, 2022 | 1 minute read</time></p><h1 data-pagefind-meta=title>Bash Jail 1</h1></header><section class=post-content><h1 id=the-challenge>The challenge</h1><p>Upon SSHing into the box, we are told that the flag is located at <code>/home/level1/flag.txt</code></p><p>Challenge bash code:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#66d9ef>while</span> :
</span></span><span style=display:flex><span><span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>        echo <span style=color:#e6db74>&#34;Your input:&#34;</span>
</span></span><span style=display:flex><span>        read input
</span></span><span style=display:flex><span>        output<span style=color:#f92672>=</span><span style=color:#e6db74>`</span>$input<span style=color:#e6db74>`</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>done</span> 
</span></span></code></pre></div><h1 id=inference-and-experimenation>Inference and experimenation</h1><p>The script is reading an input, executes it and then stores it in the
<code>output</code> variable without ever displaying the output to the console.</p><p>I tried a dummy command to see if I could see its <code>stderr</code> since command
substitution (backticks) only capture the <code>stdout</code>.</p><pre tabindex=0><code>echo hi 1&gt;&amp;2
</code></pre><p>Unfortunately that did not work, we did not have the &ldquo;hi&rdquo; blurted out in
the stderr. So, I resorted to another route.</p><h1 id=solution>Solution</h1><p>Remember how, if we ever tweak our bashrc file, we need to source it
to bring it to effect? Well, we can also, source the flag.txt file
and the script should error out with the contents of the file.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>source flag.txt
</span></span><span style=display:flex><span>flag.txt: line 1: FLAG-U96l4k6m72a051GgE5EN0rA85499172K: command not found
</span></span></code></pre></div><p>There we have our flag.</p></section></article><footer class=post-tags data-pagefind-meta=tags><a href=https://lavafroth.is-a.dev/tags/bash class=list-tag>Bash</a>
<a href=https://lavafroth.is-a.dev/tags/ctf class=list-tag>CTF</a>
<a href=https://lavafroth.is-a.dev/tags/ringzer0 class=list-tag>RingZer0</a>
<a href=https://lavafroth.is-a.dev/tags/sandbox-escape class=list-tag>Sandbox Escape</a></footer><nav class=post-nav><a class=prev href=https://lavafroth.is-a.dev/post/ringzer0ctf-bash-jail2/><span>←</span><span>Bash Jail 2</span></a>
<a class=next href=https://lavafroth.is-a.dev/post/picoctf-forensics-operation-oni-operation-orchid/><span>Operation Oni, Operation Orchid</span><span>→</span></a></nav></main><footer class=footer><p>&copy; 2025 <a href=https://lavafroth.is-a.dev/>lavafroth</a></p><p><a href=https://github.com/lavafroth/lavafroth.github.io/issues/new/choose>Report an issue</a></p><p><a href=https://github.com/lavafroth/lavafroth.github.io/discussions/>Discuss</a></p><p><a href=https://lavafroth.is-a.dev/privacy>Privacy</a></p><p><a href=https://creativecommons.org/licenses/by-sa/4.0/legalcode>License</a></p></footer></body></html>