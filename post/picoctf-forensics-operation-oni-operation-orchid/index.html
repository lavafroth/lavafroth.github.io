<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>Operation Oni, Operation Orchid - lavafroth</title><meta name=description content='In this post, we&rsquo;ll walk through the Operation Oni and Operation Orchid challenges
from the PicoCTF competition held in March 2022. Both of these challenges involve
the use of tools from The Sleuth Kit suite. In order to follow along, I&rsquo;d recommend
installing the suite of tools.
Operation Oni
The challenge has an associated instance which we&rsquo;ll need to log into using SSH using
the following command:
ssh -i key_file -p 61948 ctf-player@saturn.picoctf.net
We are provided with a compressed disk image disk.img.gz which we&rsquo;ll decompress with:'><meta name=author content><link rel="preload stylesheet" as=style href=https://lavafroth.is-a.dev/app.min.css><link rel=preload as=image href=../../header.svg><link as=font href=https://lavafroth.is-a.dev/latinmodern-math.otf><link rel=preload as=image href=https://lavafroth.is-a.dev/github.svg><link rel=preload as=image href=https://lavafroth.is-a.dev/about.svg><link rel=preload as=image href=https://lavafroth.is-a.dev/art.svg><link rel=preload as=image href=https://lavafroth.is-a.dev/rss.svg><link rel=icon href=https://lavafroth.is-a.dev/favicon.png><link rel=blog-icon href=https://lavafroth.is-a.dev/icon.png></head><body><header><a class=site-name href=https://lavafroth.is-a.dev/><svg viewBox="0 0 8790 2080"><path d="M80 1935V465h216v1270h286v2e2zm853 0 222-1470h264l222 1470h-210l-40-3e2h-208l-40 3e2zm280-528h148l-62-494-6-78h-12l-6 78zm1025 528L2014 465h210l108 868 8 142h12l8-142 108-868h210l-224 1470zm813 0 222-1470h264l222 1470h-210l-40-3e2h-208l-40 3e2zm280-528h148l-62-494-6-78h-12l-6 78zm851 528V465h514v222h-298v386h2e2v222h-2e2v640zm910 0V465h216q194 0 286 108 92 107 92 316 0 124-43 215-44 90-106 132l147 699h-216l-122-620h-38v620zm216-820q60 0 95-26 35-27 50-76t15-116q0-105-34-161-35-57-126-57zm1084 836q-90 0-154-42-65-42-99-114-35-72-35-162V767q0-91 35-162 34-72 99-114 64-42 154-42t155 42q64 42 99 114 34 72 34 162v866q0 90-34 162-35 72-99 114-65 42-155 42zm0-210q40 0 56-33 16-34 16-75V767q0-41-17-74-17-34-55-34-37 0-54 34-18 33-18 74v866q0 41 17 75 17 33 55 33zm890 194V687h-204V465h624v222h-204v1248zm828 0V465h216v608h168V465h216v1470h-216v-640h-168v640z"/></svg></a><nav><a style=--url:url(./github.svg) href=https://github.com/lavafroth aria-label=github target=_blank></a><a href=../../about/ aria-label=about style=--url:url(./about.svg)></a><a href=../../art/ aria-label=art style=--url:url(./art.svg)></a><a href=../../index.xml aria-label=rss style=--url:url(./rss.svg)></a><nav></header><main><hgroup data-pagefind-body><p data-pagefind-ignore><time>Mar 18, 2022 | 6 minutes read</time></p><h1 data-pagefind-meta=title>Operation Oni, Operation Orchid</h1></hgroup><section class=post-content data-pagefind-body><p>In this post, we&rsquo;ll walk through the Operation Oni and Operation Orchid challenges
from the PicoCTF competition held in March 2022. Both of these challenges involve
the use of tools from The Sleuth Kit suite. In order to follow along, I&rsquo;d recommend
installing the suite of tools.</p><h1 id=operation-oni>Operation Oni</h1><p>The challenge has an associated instance which we&rsquo;ll need to log into using SSH using
the following command:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ssh -i key_file -p <span style=color:#ae81ff>61948</span> ctf-player@saturn.picoctf.net
</span></span></code></pre></div><p>We are provided with a compressed disk image <code>disk.img.gz</code> which we&rsquo;ll decompress with:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>gunzip disk.img.gz
</span></span></code></pre></div><p>To list the partition table for the given disk image, we will use the <code>mmls</code> command.
If <code>mmls</code> is unable to properly determine the filesystem of a given volume, we can
specify it using the <code>-t</code> flag.</p><p>Let&rsquo;s run <code>mmls</code> on the disk image by itself.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mmls disk.img
</span></span></code></pre></div><pre tabindex=0><code class=language-none data-lang=none>DOS Partition Table
Offset Sector: 0
Units are in 512-byte sectors

      Slot      Start        End          Length       Description
000:  Meta      0000000000   0000000000   0000000001   Primary Table (#0)
001:  -------   0000000000   0000002047   0000002048   Unallocated
002:  000:000   0000002048   0000206847   0000204800   Linux (0x83)
003:  000:001   0000206848   0000471039   0000264192   Linux (0x83)
</code></pre><p>We can see two linux partitions, one starting at offset <code>2048</code> and another at <code>206848</code></p><p>In order to list the files in a given volume, we can use the <code>fls</code> command. For this,
we will need to specify the offset of the volume using the <code>-o</code> flag.</p><p>Let&rsquo;s take a look at the first partition at offset <code>2048</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>fls -o <span style=color:#ae81ff>2048</span> disk.img
</span></span></code></pre></div><pre tabindex=0><code class=language-none data-lang=none>d/d 11: lost+found
r/r 12: ldlinux.sys
r/r 13: ldlinux.c32
r/r 15: config-virt
r/r 16: vmlinuz-virt
r/r 17: initramfs-virt
l/l 18: boot
r/r 20: libutil.c32
r/r 19: extlinux.conf
r/r 21: libcom32.c32
r/r 22: mboot.c32
r/r 23: menu.c32
r/r 14: System.map-virt
r/r 24: vesamenu.c32
V/V 25585:      $OrphanFiles
</code></pre><p>This looks like the boot partition of a linux installation.
Let&rsquo;s move on to the next partition at offset <code>206848</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>fls -o <span style=color:#ae81ff>206848</span> disk.img
</span></span></code></pre></div><pre tabindex=0><code class=language-none data-lang=none>d/d 458:        home
d/d 11: lost+found
d/d 12: boot
d/d 13: etc
d/d 79: proc
d/d 80: dev
d/d 81: tmp
d/d 82: lib
d/d 85: var
d/d 94: usr
d/d 104:        bin
d/d 118:        sbin
d/d 464:        media
d/d 468:        mnt
d/d 469:        opt
d/d 470:        root
d/d 471:        run
d/d 473:        srv
d/d 474:        sys
V/V 33049:      $OrphanFiles
</code></pre><p>This looks like the standard linux filesystem hierarchy where we can see the <code>/home</code> and <code>/root</code> directories.
Let&rsquo;s investigate the <code>/root</code> directory. To do so, we will append the inode number associated with the
directory as an argument to <code>fls</code>.</p><p>The inode number of <code>/root</code> is <code>470</code> here.</p><pre tabindex=0><code>d/d 470:        root
</code></pre><p>We&rsquo;ll run the previous command with the inode number.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>fls -o <span style=color:#ae81ff>206848</span> disk.img <span style=color:#ae81ff>470</span>
</span></span></code></pre></div><pre tabindex=0><code class=language-none data-lang=none>r/r 2344:       .ash_history
d/d 3916:       .ssh
</code></pre><p>Here, we can see the <code>.ssh</code> directory and the root user&rsquo;s shell history file. We&rsquo;ll try listing
the <code>.ssh</code> directory. Again, we&rsquo;ll supply the associated inode number, here, <code>3916</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>fls -o <span style=color:#ae81ff>206848</span> disk.img <span style=color:#ae81ff>3916</span>
</span></span></code></pre></div><pre tabindex=0><code>r/r 2345:       id_ed25519
r/r 2346:       id_ed25519.pub
</code></pre><p>Here, we can see a pair of SSH private and public keys. The one ending in <code>.pub</code> being the public key.
Private keys are often used as an alternative to password authentication to SSH into a machine.
We&rsquo;ll dump the content of this file using the <code>icat</code> command. For using this command, we&rsquo;ll need
to specify the offset of the volume and the inode number of the file, <code>2345</code> here.</p><p>We&rsquo;ll redirect the output of the command into a file called <code>key_file</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>icat -o <span style=color:#ae81ff>206848</span> disk.img <span style=color:#ae81ff>2345</span> &gt; key_file
</span></span></code></pre></div><p>We can try using the private key to authenticate since this key is not password protected.
Before running the SSH command, we must set the permissions on the file to read / write only
by us.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>chmod <span style=color:#ae81ff>600</span> key_file
</span></span></code></pre></div><p>Let&rsquo;s use the command that was provided with the challenge.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ssh -i key_file -p <span style=color:#ae81ff>61948</span> ctf-player@saturn.picoctf.net
</span></span></code></pre></div><p>We get a successful login as the user <code>ctf-player</code>. Let&rsquo;s list the files in our
home directory.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ctf-player@challenge:~$ ls
</span></span></code></pre></div><pre tabindex=0><code class=language-none data-lang=none>flag.txt
</code></pre><p>We&rsquo;ll view the contents of the <code>flag.txt</code> file.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ctf-player@challenge:~$ cat flag.txt
</span></span></code></pre></div><pre tabindex=0><code class=language-none data-lang=none>picoCTF{k3y_5l3u7h_af277f77}
</code></pre><h1 id=operation-orchid>Operation Orchid</h1><p>We are provided with a disk image <code>disk.flag.img.gz</code> which we&rsquo;ll decompress with:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>gunzip disk.flag.img.gz
</span></span></code></pre></div><p>Let&rsquo;s look at the partition table using <code>mmls</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mmls disk.flag.img
</span></span></code></pre></div><pre tabindex=0><code class=language-none data-lang=none>DOS Partition Table
Offset Sector: 0
Units are in 512-byte sectors

      Slot      Start        End          Length       Description
000:  Meta      0000000000   0000000000   0000000001   Primary Table (#0)
001:  -------   0000000000   0000002047   0000002048   Unallocated
002:  000:000   0000002048   0000206847   0000204800   Linux (0x83)
003:  000:001   0000206848   0000411647   0000204800   Linux Swap / Solaris x86 (0x82)
004:  000:002   0000411648   0000819199   0000407552   Linux (0x83)
</code></pre><p>Listing the volume at offset <code>2048</code> using <code>fls</code>, we see a boot partition.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>fls -o <span style=color:#ae81ff>2048</span> ./disk.flag.img
</span></span></code></pre></div><pre tabindex=0><code class=language-none data-lang=none>d/d 11: lost+found
r/r 12: ldlinux.sys
r/r 13: ldlinux.c32
r/r 15: config-virt
r/r 16: vmlinuz-virt
r/r 17: initramfs-virt
l/l 18: boot
r/r 20: libutil.c32
r/r 19: extlinux.conf
r/r 21: libcom32.c32
r/r 22: mboot.c32
r/r 23: menu.c32
r/r 14: System.map-virt
r/r 24: vesamenu.c32
V/V 25585:      $OrphanFiles
</code></pre><p>We&rsquo;ll move on to the next Linux partition at offset <code>411648</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>fls -o <span style=color:#ae81ff>411648</span> ./disk.flag.img
</span></span></code></pre></div><pre tabindex=0><code class=language-none data-lang=none>d/d 460:        home
d/d 11: lost+found
d/d 12: boot
d/d 13: etc
d/d 81: proc
d/d 82: dev
d/d 83: tmp
d/d 84: lib
d/d 87: var
d/d 96: usr
d/d 106:        bin
d/d 120:        sbin
d/d 466:        media
d/d 470:        mnt
d/d 471:        opt
d/d 472:        root
d/d 473:        run
d/d 475:        srv
d/d 476:        sys
d/d 2041:       swap
V/V 51001:      $OrphanFiles
</code></pre><p>Let&rsquo;s try listing the home folder of the root user at <code>/root</code>.</p><pre tabindex=0><code class=language-none data-lang=none>d/d 472:        root
</code></pre><p>We&rsquo;ll use its inode number, <code>472</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>fls -o <span style=color:#ae81ff>411648</span> ./disk.flag.img <span style=color:#ae81ff>472</span>
</span></span></code></pre></div><pre tabindex=0><code class=language-none data-lang=none>r/r 1875:       .ash_history
r/r * 1876(realloc):    flag.txt
r/r 1782:       flag.txt.enc
</code></pre><p>We can dump the contents of the <code>flag.txt</code> file using <code>icat</code> like we did
previously.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>icat -o <span style=color:#ae81ff>411648</span> ./disk.flag.img <span style=color:#ae81ff>1876</span>
</span></span></code></pre></div><pre tabindex=0><code class=language-none data-lang=none>           -0.881573            34.311733
</code></pre><p>A set of coordinates? Latitudes and longitudes? Not very helpful.
Let&rsquo;s dump <code>flag.txt.enc</code> to a file we can work on later.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>icat -o <span style=color:#ae81ff>411648</span> ./disk.flag.img <span style=color:#ae81ff>1782</span> &gt; flag.txt.enc
</span></span></code></pre></div><p>Let&rsquo;s investigate the shell history to see what the root user was upto the last time.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>icat -o <span style=color:#ae81ff>411648</span> ./disk.flag.img <span style=color:#ae81ff>1875</span>
</span></span></code></pre></div><pre tabindex=0><code class=language-none data-lang=none>touch flag.txt
nano flag.txt 
apk get nano
apk --help
apk add nano
nano flag.txt 
openssl
openssl aes256 -salt -in flag.txt -out flag.txt.enc -k unbreakablepassword1234567
shred -u flag.txt
ls -al
halt
</code></pre><p>Ah! So they encrypted the original <code>flag.txt</code> with AES256 using the <code>openssl</code> command.
We can see the key that was supplied to the command with the <code>-k</code> flag.</p><p>Now that we know the key, we can decrypt the <code>flag.txt.enc</code> file.</p><p>We&rsquo;ll use the <code>-d</code> flag for decryption, set the input file, the argument to the <code>-in</code> flag,
to <code>flag.txt.enc</code> and omit the <code>-out</code> flag so that it outputs to <code>stdout</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>openssl aes256 -d -salt -in flag.txt.enc -k unbreakablepassword1234567
</span></span></code></pre></div><pre tabindex=0><code class=language-none data-lang=none>*** WARNING : deprecated key derivation used.
Using -iter or -pbkdf2 would be better.
bad decrypt
140377178797312:error:06065064:digital envelope routines:EVP_DecryptFinal_ex:bad decrypt:crypto/evp/evp_enc.c:610:
picoCTF{h4un71ng_p457_17237fce}
</code></pre><p>There we have it, we&rsquo;ve captured the flag.</p></section><footer class=post-tags data-pagefind-meta=tags><a href=https://lavafroth.is-a.dev/tags/ctf class=list-tag>CTF</a>
<a href=https://lavafroth.is-a.dev/tags/forensics class=list-tag>Forensics</a>
<a href=https://lavafroth.is-a.dev/tags/picoctf class=list-tag>PicoCTF</a>
<a href=https://lavafroth.is-a.dev/tags/the-sleuth-kit class=list-tag>The Sleuth Kit</a></footer><nav data-post><a href=https://lavafroth.is-a.dev/post/ringzer0ctf-bash-jail1/><span>←</span><span>Bash Jail 1</span></a>
<a href=https://lavafroth.is-a.dev/post/picoctf-web-challenge-jauth/><span>JAuth</span><span>→</span></a></nav></main><footer class=footer><p>&copy; 2025 <a href=https://lavafroth.is-a.dev/>lavafroth</a></p><p><a href=https://github.com/lavafroth/lavafroth.github.io/issues/new/choose>Report an issue</a></p><p><a href=https://github.com/lavafroth/lavafroth.github.io/discussions/>Discuss</a></p><p><a href=https://lavafroth.is-a.dev/privacy>Privacy</a></p><p><a href=https://creativecommons.org/licenses/by-sa/4.0/legalcode>License</a></p></footer></body></html>